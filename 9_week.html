
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>שבוע 9 - Matplotlib &amp; SciPy &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/rtl.css?v=dc79e408" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '9_week';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="שבוע 8 - Numpy מתקדם" href="8_week.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/tau.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/tau.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    ברוכים הבאים לקורס מחשבים לפיסיקאים
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="0_intro.html">מנהלות</a></li>
<li class="toctree-l1"><a class="reference internal" href="1_week.html">שבוע 1 - היכרות עם פייתון ומחברות ג’ופיטר</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_week.html">שבוע 2 - פונקציות ותנאים</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_week.html">שבוע 3 - רשימות וטווחים</a></li>

<li class="toctree-l1"><a class="reference internal" href="4_week.html">שבוע 4 - לולאות</a></li>



<li class="toctree-l1"><a class="reference internal" href="5_week.html">שבוע 5 - השמות ופונקציות חלק ב</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_week.html">שבוע 6 - מבני נתונים וקבצים</a></li>


<li class="toctree-l1"><a class="reference internal" href="7_week.html">שבוע 7 - Numpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="8_week.html">שבוע 8 - Numpy מתקדם</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">שבוע 9 - Matplotlib &amp; SciPy</a></li>























</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/TauInnov/computers-for-physics/master?urlpath=lab/tree/9_week.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/TauInnov/computers-for-physics/blob/master/9_week.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/TauInnov/computers-for-physics" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/TauInnov/computers-for-physics/issues/new?title=Issue%20on%20page%20%2F9_week.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/9_week.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>שבוע 9 - Matplotlib & SciPy</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">שבוע 9 - Matplotlib &amp; SciPy</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matplotlib">חלק א’ — Matplotlib</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">1. אנטומיית תרשימים</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">שימוש במודל האובייקטי של matplotlib</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sin-x">דוגמה: גרף פשוט של הפונקציה <span class="math notranslate nohighlight">\(\sin(x)\)</span>:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dpi">גודל תרשים, DPI, פריסה ושמירה</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#axs">שימוש ב־<code class="docutils literal notranslate"><span class="pre">axs</span></code> לציורים מרובים</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">סוגי גרפים ב־Matplotlib</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#line-plot">Line plot</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#scatter-plot">Scatter plot</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#histogram">Histogram</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#imshow">Imshow</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#errorbar">Errorbar</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">התאמות מתקדמות</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">דוגמה מסכמת</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">1) יצירת נתונים</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#colormap">2) הכנה ל־Colormap</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#x">3) ציור הלוח העליון + סולם לוגריתמי בציר <span class="math notranslate nohighlight">\(x\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#annotation">4) הוספת Annotation לנקודת חצי־זמן</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-c">5) ציר תאום ליחידות חלופיות (K ↔ °C)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#colorbar">6) הוספת Colorbar</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#y">7) לוח תחתון עם <span class="math notranslate nohighlight">\(y\)</span> לוגריתמי</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">8) הרכבה, הצגה ושמירה</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">9) קריאה להרצה</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scipy">חלק ב’ — SciPy</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numpy">תזכורת קצרה ל-NumPy + קבועים פיזיקליים</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">1) חישוב אנרגיית פוטון מאורך גל</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#k-b-t">2) סקאלת אנרגיה תרמית <span class="math notranslate nohighlight">\(k_B T\)</span> ומתיחות תרמית במתח</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#broadcasting">3) דוגמת Broadcasting: אנרגיה פוטנציאלית כבידתית</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">4) חוק וין: אורך גל שיא של גוף שחור</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-approx-dfrac-1-sqrt-varepsilon-0-mu-0">5) בדיקת־שפיות: <span class="math notranslate nohighlight">\(c \approx \dfrac{1}{\sqrt{\varepsilon_0 \mu_0}}\)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#markdown">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">שאלות רב־ברירה</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">איור (סקיצה)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#odes">2. אינטגרציה וגזירה נומרית + ODEs</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">שאלות רב־ברירה</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">איור (סקיצה)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">3. אופטימיזציה, שורשים, והתאמת עקומות</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">שאלות רב־ברירה</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">איור (סקיצה)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">4. אינטרפולציה והחלקה</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">שאלות רב־ברירה</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">איור (סקיצה)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fft">5. עיבוד אותות ו-FFT</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id29">5. עיבוד אותות ו-FFT</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id30">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id31">שאלות רב־ברירה</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id32">איור (סקיצה)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id33">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id34">6. אלגברה ליניארית מדעית</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id35">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id36">שאלות רב־ברירה</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id37">איור (סקיצה)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id38">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id39">7. סטטיסטיקה בסיסית למדידות</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id40">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id41">שאלות רב־ברירה</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id42">איור (סקיצה)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id43">%% [markdown]</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#capstone">דוגמאות מסכמות (Capstone)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#g-t-l">דוגמה 1 — מטוטלת: הערכת <span class="math notranslate nohighlight">\(g\)</span> מהתלות <span class="math notranslate nohighlight">\(T(L)\)</span></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id44">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id45">שאלות רב־ברירה (דוגמה 1)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id46">איור (סקיצה)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id47">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id48">דוגמה 2 — קליע עם גרר ריבועי: זווית שיגור מיטבית</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id49">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id50">שאלות רב־ברירה (דוגמה 2)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id51">איור (סקיצה)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id52">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#omega-n-zeta">דוגמה 3 — מתנד מרוסן: זיהוי <span class="math notranslate nohighlight">\(\omega_n\)</span> ו־<span class="math notranslate nohighlight">\(\zeta\)</span></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id53">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id54">שאלות רב־ברירה (דוגמה 3)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id55">איור (סקיצה)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id56">%% [markdown]</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id57">נספח קצר — טיפים לשמירת תרשימים</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="matplotlib-scipy">
<h1>שבוע 9 - Matplotlib &amp; SciPy<a class="headerlink" href="#matplotlib-scipy" title="Link to this heading">#</a></h1>
<section id="matplotlib">
<h2>חלק א’ — Matplotlib<a class="headerlink" href="#matplotlib" title="Link to this heading">#</a></h2>
<p>זוהי ספרייה פופולרית להצגת גרפים וויזואליזציות בפייתון.<br />
היא מאפשרת ליצור תרשימים דו־ממדיים כמו גרפים קוויים, עמודות, פיזור (scatter), תרשימי חום (heatmaps) ועוד.<br />
עבור פיזיקאים ומתמטיקאים, היא כלי חיוני להצגת נתונים, תוצאות ניסוי וסימולציות בצורה ברורה.<br />
המודול הנפוץ ביותר לשימוש הוא <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code> שמספק פקודות פשוטות לשרטוט מהיר.</p>
</section>
<section id="id1">
<h2>1. אנטומיית תרשימים<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p><strong>מושגים מרכזיים:</strong></p>
<ul class="simple">
<li><p><strong>Figure</strong> — מכלול התרשים (הדף).</p></li>
<li><p><strong>Axes</strong> — מערכת צירים אחת (או יותר) בתוך ה־Figure.</p></li>
<li><p><strong>Axis</strong> — ציר <span class="math notranslate nohighlight">\(x\)</span> או <span class="math notranslate nohighlight">\(y\)</span> בתוך ה־Axes.</p></li>
</ul>
<p>יש שתי דרכים עיקריות לעבוד:</p>
<ol class="arabic simple">
<li><p><strong>סגנון Pyplot</strong> (מהיר): <code class="docutils literal notranslate"><span class="pre">(...)plt.plot</span></code>, ואז <code class="docutils literal notranslate"><span class="pre">()plt.show</span></code></p></li>
<li><p><strong>מודל אובייקטי (מומלץ לפרויקטים)</strong>: יצירת <code class="docutils literal notranslate"><span class="pre">()fig,</span> <span class="pre">ax</span> <span class="pre">=</span> <span class="pre">plt.subplots</span></code> ואז שימוש ב־<code class="docutils literal notranslate"><span class="pre">(...)ax.plot</span></code> וכן הלאה.</p></li>
</ol>
<p>נוסיף כותרות, תוויות, ונטמיע נוסחאות עם <span class="math notranslate nohighlight">\( \LaTeX \)</span> בכותרת/צירים. ראשית, נייבא את הספרייה ונאתחל פרמטרים</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Core imports used across the notebook</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># For SciPy sections:</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">integrate</span><span class="p">,</span> <span class="n">optimize</span><span class="p">,</span> <span class="n">interpolate</span><span class="p">,</span> <span class="n">fft</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">linalg</span><span class="p">,</span> <span class="n">stats</span><span class="p">,</span> <span class="n">constants</span>

<span class="c1"># Global plotting defaults (feel free to tweak)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
    <span class="s2">&quot;figure.figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">),</span>
    <span class="s2">&quot;figure.dpi&quot;</span><span class="p">:</span> <span class="mi">120</span><span class="p">,</span>
    <span class="s2">&quot;axes.grid&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;font.size&quot;</span><span class="p">:</span> <span class="mi">11</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h3>שימוש במודל האובייקטי של matplotlib<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>בדוגמה זו נשתמש ב־API האובייקטי של matplotlib ליצירת גרף פשוט:</p>
<ul class="simple">
<li><p>נבנה מערך ערכים <span class="math notranslate nohighlight">\(x\)</span> בתחום <span class="math notranslate nohighlight">\([0, 2\pi]\)</span>.</p></li>
<li><p>נחשב את <span class="math notranslate nohighlight">\(y = \sin(x)\)</span>.</p></li>
<li><p>נשרטט את הגרף של פונקציית הסינוס עם כותרת, שמות לצירים ו־Legend.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ה־API האובייקטי (<code class="docutils literal notranslate"><span class="pre">()fig,</span> <span class="pre">ax</span> <span class="pre">=</span> <span class="pre">plt.subplots</span></code>) מאפשר שליטה נוחה על כל מרכיבי התרשים,
ולכן מומלץ לשימוש בפרויקטים מסודרים.</p>
</div>
</section>
<section id="sin-x">
<h3>דוגמה: גרף פשוט של הפונקציה <span class="math notranslate nohighlight">\(\sin(x)\)</span>:<a class="headerlink" href="#sin-x" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>יצירת נתונים</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">np.linspace(0,</span> <span class="pre">2*np.pi,</span> <span class="pre">200)</span></code> יוצר 200 נקודות מ־0 עד <span class="math notranslate nohighlight">\(2\pi\)</span> (רדיונים).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">np.sin(x)</span></code> מחשב את ערכי הסינוס עבור כל נקודה.</p></li>
</ul>
</li>
<li><p><strong>הגדרת תרשים</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">()fig,</span> <span class="pre">ax</span> <span class="pre">=</span> <span class="pre">plt.subplots</span></code> יוצר פיגורה (<code class="docutils literal notranslate"><span class="pre">fig</span></code>) וציר (<code class="docutils literal notranslate"><span class="pre">ax</span></code>) לעבודה.</p></li>
</ul>
</li>
<li><p><strong>ציור הגרף</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ax.plot(x,</span> <span class="pre">y,</span> <span class="pre">label=&quot;sin(x)&quot;)</span></code> מצייר את <span class="math notranslate nohighlight">\(y=\sin(x)\)</span> עם תווית למקרא.</p></li>
</ul>
</li>
<li><p><strong>כותרות ותוויות</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ax.set_title(r&quot;$y=\sin(x)$&quot;)</span></code> מוסיף כותרת עם נוסחת LaTeX.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ax.set_xlabel(r&quot;$x$</span> <span class="pre">(rad)&quot;)</span></code> ו־<code class="docutils literal notranslate"><span class="pre">ax.set_ylabel(r&quot;$y$&quot;)</span></code> מוסיפים שמות לצירים, כולל יחידות ברדיאנים.</p></li>
</ul>
</li>
<li><p><strong>מקרא</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">()ax.legend</span></code> מציג את המקרא עם התווית שהוגדרה.</p></li>
</ul>
</li>
<li><p><strong>פריסה ותצוגה</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">()plt.tight_layout</span></code> דואג שאין חפיפות בין רכיבי התרשים.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">()plt.show</span></code> מציג את התרשים על המסך.</p></li>
</ul>
</li>
</ol>
<p>בקצרה: הקוד מייצר תרשים של הפונקציה <span class="math notranslate nohighlight">\(\sin(x)\)</span> בין <span class="math notranslate nohighlight">\(0\)</span> ל־<span class="math notranslate nohighlight">\(2\pi\)</span>, עם כותרות, יחידות ומקרא.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;sin(x)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$y=\sin(x)$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$x$ (rad)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$y$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/832292be9b4f7bd00a4948123797380d6ecd932b70547662c9242661dd3de01e.png" src="_images/832292be9b4f7bd00a4948123797380d6ecd932b70547662c9242661dd3de01e.png" />
</div>
</div>
</section>
<section id="dpi">
<h3>גודל תרשים, DPI, פריסה ושמירה<a class="headerlink" href="#dpi" title="Link to this heading">#</a></h3>
<p>בתרשים זה נמחיש כיצד לשלוט בפרמטרים חשובים של Figure:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">figsize</span></code> — קובע את גודל התרשים באינצ’ים.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dpi</span></code> — רזולוציית התצוגה (נקודות לאינץ’).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">constrained_layout=True</span></code> — מאפשר התאמה אוטומטית של פריסת האלמנטים (כותרות, תוויות) כך שלא ייחתכו.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(...)fig.savefig</span></code> — שמירת התרשים כקובץ (למשל PDF איכותי להדפסה, או PNG למסך).</p></li>
</ul>
<p>בדוגמה נצייר את פונקציית הקוסינוס, נוסיף כותרת, שמות לצירים ו־Legend, ונראה כיצד ניתן לשמור את הגרף באיכות המתאימה לפרסום.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Figure size, dpi, layout, and saving</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">3.8</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;cos(x)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;גל קוסינוס: $y=\cos(x)$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$x$ (rad)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$y$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>

<span class="c1"># Uncomment to save a publication-quality figure:</span>
<span class="c1"># fig.savefig(&quot;cosine_plot.pdf&quot;)  # vector format (great for print)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8a1a187bc3aee01c8fc994bc68b4b8e090ef2eeb325f3ca25c6ea6e4dae53db4.png" src="_images/8a1a187bc3aee01c8fc994bc68b4b8e090ef2eeb325f3ca25c6ea6e4dae53db4.png" />
</div>
</div>
</section>
<section id="axs">
<h3>שימוש ב־<code class="docutils literal notranslate"><span class="pre">axs</span></code> לציורים מרובים<a class="headerlink" href="#axs" title="Link to this heading">#</a></h3>
<p>כאשר רוצים לצייר <strong>כמה תרשימים שונים באותה פיגורה</strong>, נוח להשתמש ב־<code class="docutils literal notranslate"><span class="pre">plt.subplots(rows,</span> <span class="pre">cols)</span></code> שמחזיר:</p>
<ul class="simple">
<li><p>אובייקט פיגורה (<code class="docutils literal notranslate"><span class="pre">fig</span></code>).</p></li>
<li><p>מערך דו־ממדי של צירים (<code class="docutils literal notranslate"><span class="pre">axs</span></code>) בגודל שנבחר.</p></li>
</ul>
<p>כך, אפשר לגשת לכל ציר לפי המיקום שלו במערך <code class="docutils literal notranslate"><span class="pre">axs[row,</span> <span class="pre">col]</span></code> ולצייר בו גרף עצמאי עם כותרת, תוויות וכו’.<br />
בדרך זו ניתן לארגן מספר גרפים מסודרים בטבלה אחת (grid) ולשלוט בכל אחד מהם בנפרד.</p>
<p>לדוגמה בקוד שלמטה: <code class="docutils literal notranslate"><span class="pre">fig,</span> <span class="pre">axs</span> <span class="pre">=</span> <span class="pre">plt.subplots(2,</span> <span class="pre">3,</span> <span class="pre">...)</span></code> יוצר <strong>רשת של 2 שורות ו־3 עמודות</strong> של תרשימים.<br />
לאחר מכן ניגשים לכל אחד מהם (<code class="docutils literal notranslate"><span class="pre">axs[0,0]</span></code>, <code class="docutils literal notranslate"><span class="pre">axs[0,1]</span></code>, … <code class="docutils literal notranslate"><span class="pre">axs[1,2]</span></code>) ומציירים בו סוג גרף אחר.</p>
</section>
<section id="id3">
<h3>סוגי גרפים ב־Matplotlib<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>בקטע הבא נמחיש כמה סוגי גרפים נפוצים: קו (line), פיזור (scatter), היסטוגרמה (hist), הדמיה עם imshow (כמו heatmap), וגרף עם שגיאות (errorbar).<br />
לכל סוג גרף מתאימה קריאה שונה לפונקציה, בהתאם לאופי הנתונים שרוצים להציג.</p>
<section id="line-plot">
<h4>Line plot<a class="headerlink" href="#line-plot" title="Link to this heading">#</a></h4>
<p>גרף קווים – מיועד להצגת פונקציה רציפה או קו מגמה לאורך טווח.<br />
בדוגמה מוצג קו ישר “אמיתי” לצד נקודות ניסוי עם רעש.<br />
<strong>קריאה לפונקציה:</strong> <code class="docutils literal notranslate"><span class="pre">ax.plot(x,</span> <span class="pre">y,</span> <span class="pre">...)</span></code><br />
הפונקציה מחברת את הנקודות לפי סדרן ומאפשרת לקבוע סגנון קו, צבע ותווית.</p>
</section>
<section id="scatter-plot">
<h4>Scatter plot<a class="headerlink" href="#scatter-plot" title="Link to this heading">#</a></h4>
<p>תרשים פיזור – מתאים להצגת נקודות בודדות ללא חיבור ביניהן בקווים.<br />
שימושי במיוחד להצגת מדידות ניסיוניות או קשר בין שני משתנים.<br />
<strong>קריאה לפונקציה:</strong> <code class="docutils literal notranslate"><span class="pre">ax.scatter(x,</span> <span class="pre">y,</span> <span class="pre">...)</span></code><br />
ניתן לשנות צבע, גודל וסגנון של הנקודות, ואף לקודד מידע נוסף באמצעות צבעים וגדלים שונים.</p>
</section>
<section id="histogram">
<h4>Histogram<a class="headerlink" href="#histogram" title="Link to this heading">#</a></h4>
<p>היסטוגרמה – מציגה את ההתפלגות של מדגם נתונים.<br />
בדוגמה מוצגת התפלגות שנדגמה מהתפלגות נורמלית.<br />
<strong>קריאה לפונקציה:</strong> <code class="docutils literal notranslate"><span class="pre">ax.hist(data,</span> <span class="pre">bins=...,</span> <span class="pre">...)</span></code><br />
אפשר לשלוט במספר התאים (bins), לבקש נורמליזציה (<code class="docutils literal notranslate"><span class="pre">density=True</span></code>), ולשנות צבע או שקיפות.</p>
</section>
<section id="imshow">
<h4>Imshow<a class="headerlink" href="#imshow" title="Link to this heading">#</a></h4>
<p>הצגת מערך דו־ממדי כ”תמונה” או heatmap, כך שכל ערך מוצג בצבע שונה.<br />
בדוגמה מוצג שדה גאוסי דו־ממדי.<br />
<strong>קריאה לפונקציה:</strong> <code class="docutils literal notranslate"><span class="pre">ax.imshow(Z,</span> <span class="pre">extent=[...],</span> <span class="pre">origin='lower',</span> <span class="pre">aspect='auto')</span></code><br />
הפונקציה מציירת מטריצה כגרפיקת פיקסלים. לרוב מוסיפים סרגל צבעים עם <code class="docutils literal notranslate"><span class="pre">fig.colorbar(...)</span></code> כדי להבין את סקאלת הערכים.</p>
</section>
<section id="errorbar">
<h4>Errorbar<a class="headerlink" href="#errorbar" title="Link to this heading">#</a></h4>
<p>גרף עם פסי שגיאה – מיועד להצגת מדידות עם אי־ודאות.<br />
בדוגמה מוצגות נקודות עם פסי שגיאה אקראיים סביבן.<br />
<strong>קריאה לפונקציה:</strong> <code class="docutils literal notranslate"><span class="pre">ax.errorbar(x,</span> <span class="pre">y,</span> <span class="pre">yerr=...,</span> <span class="pre">fmt='o')</span></code><br />
ניתן להציג שגיאות בציר <span class="math notranslate nohighlight">\(y\)</span> (או <span class="math notranslate nohighlight">\(x\)</span>), לקבוע סגנון נקודות/קווים ולהתאים צבעים.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data generation</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">1.0</span>
<span class="n">y_noisy</span> <span class="o">=</span> <span class="n">y_true</span> <span class="o">+</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Line</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_noisy</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;noisy&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Line&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Scatter</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_noisy</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Scatter&quot;</span><span class="p">)</span>

<span class="c1"># Histogram</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Histogram&quot;</span><span class="p">)</span>

<span class="c1"># Imshow (heatmap-like)</span>
<span class="n">grid_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">grid_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">grid_x</span><span class="p">,</span> <span class="n">grid_y</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">grid_x</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">grid_x</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">grid_y</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">grid_y</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span>
                     <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Imshow (Gaussian field)&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="c1"># Errorbar</span>
<span class="n">yerr</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_noisy</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">yerr</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Errorbar&quot;</span><span class="p">)</span>

<span class="c1"># Empty slot for future (e.g., bar or boxplot)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;Use this slot for extra plot&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e7264b3a0bb00a2b360b095683e59c595f40b24a0df938f3bbc64722bd30eb61.png" src="_images/e7264b3a0bb00a2b360b095683e59c595f40b24a0df938f3bbc64722bd30eb61.png" />
</div>
</div>
</section>
</section>
</section>
<section id="id4">
<h2>התאמות מתקדמות<a class="headerlink" href="#id4" title="Link to this heading">#</a></h2>
<p>מעבר ליכולות הבסיסיות של Matplotlib, קיימות פונקציות מתקדמות שמאפשרות להציג נתונים בצורה מדעית מדויקת וברורה יותר. שימוש נכון בהן חשוב במיוחד בפיזיקה, שבה לעיתים קרובות נדרשים להציג תופעות המתפרשות על פני <strong>סדרי גודל רבים</strong> או לשלב <strong>יחידות שונות</strong> על אותו תרשים.</p>
<ul class="simple">
<li><p><strong>סולמות לוגריתמיים</strong>: <code class="docutils literal notranslate"><span class="pre">ax.set_xscale('log')</span></code>, <code class="docutils literal notranslate"><span class="pre">ax.set_yscale('log')</span></code> — מאפשרים להציג נתונים המשתנים באקספוננט או על פני כמה סדרי גודל, כמו דעיכה רדיואקטיבית או ספקטרום תדרים. שימוש נכון בסולם לוגריתמי יכול להפוך עקומה לא ליניארית לקו ישר, ולחשוף קשרים חבויים.</p></li>
<li><p><strong>טיקים ותוויות</strong>: מאפשרים שליטה מלאה באופן הצגת המספרים בצירים (מדעי, אקספוננציאלי או רגיל), וכן הוספת <strong>יחידות פיזיקליות</strong> לכותרות הצירים. התאמות אלו מבטיחות שהגרף יהיה קריא ונכון גם לקהל מדעי.</p></li>
<li><p><strong>מקרא ו־annotations</strong>: הוספת מקרא (legend) חיונית כשיש כמה עקומות באותו גרף. בעזרת <code class="docutils literal notranslate"><span class="pre">ax.annotate</span></code> ניתן גם להדגיש נקודות קריטיות בנתונים (כמו מקסימום, חצי־חיים או תדר תהודה), ולהסביר אותן באמצעות חצים וטקסט.</p></li>
<li><p><strong>ציר תאום</strong>: <code class="docutils literal notranslate"><span class="pre">()ax.twinx</span></code> או <code class="docutils literal notranslate"><span class="pre">()ax.twiny</span></code> מאפשרים להציג שתי סקאלות יחידות שונות באותו תרשים (למשל טמפרטורה ב־K וב־°C, או תדר לעומת אורך גל), מבלי לבלבל את הקורא.</p></li>
<li><p><strong>Colormaps</strong>: שימוש במפות צבעים מדעיות (כמו <code class="docutils literal notranslate"><span class="pre">viridis</span></code> או <code class="docutils literal notranslate"><span class="pre">inferno</span></code>) מאפשר קידוד של פרמטר נוסף באמצעות צבע. זה חשוב במיוחד להצגת סדרות של ניסויים או סימולציות, תוך שמירה על נגישות גם לעיוורי צבעים.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ביחד, התאמות אלו מאפשרות לא רק ליצור גרף יפה יותר, אלא להעביר מסר פיזיקלי ברור ומדויק, ולחסוך לקורא את הצורך בניחושים או חישובים נוספים.</p>
</div>
</section>
<section id="id5">
<h2>דוגמה מסכמת<a class="headerlink" href="#id5" title="Link to this heading">#</a></h2>
<p>נשתמש בעקומות דעיכה אקספוננציאליות כדי להדגים <strong>שימושי Matplotlib מתקדמים</strong>:<br />
סולמות לוגריתמיים, טיקים ותוויות עם יחידות, מקרא ו־annotations, <strong>ציר תאום</strong> ליחידות חלופיות, <strong>Colormap</strong> עם Colorbar, ושמירה לקובץ.</p>
<div class="admonition- admonition">
<p class="admonition-title">פיזיקלית, המודל יכול לייצג מגוון תהליכים דומים:</p>
<ul>
<li><p><strong>קירור ניוטוני</strong>: גוף חם בטמפרטורה <span class="math notranslate nohighlight">\(T_0\)</span> מתקרר אל טמפרטורת סביבה <span class="math notranslate nohighlight">\(T_{\rm amb}\)</span> על פי</p>
<div class="math notranslate nohighlight">
\[
  T(t) = T_{\rm amb} + (T_0 - T_{\rm amb}) e^{-t/\tau}
  \]</div>
</li>
<li><p><strong>פריקת קבל במעגל RC</strong>: המתח דועך לפי <span class="math notranslate nohighlight">\(V(t)=V_0 e^{-t/RC}\)</span>.</p></li>
<li><p><strong>דעיכת רדיואקטיביות</strong>: מספר גרעינים <span class="math notranslate nohighlight">\(N(t)=N_0 e^{-\lambda t}\)</span>.</p></li>
</ul>
<p>כל אלה חולקים את הצורה המתמטית של דעיכה אקספוננציאלית עם קבוע זמן <span class="math notranslate nohighlight">\(\tau\)</span>.</p>
</div>
<p>ראשית, נייבא את הספריות והפונקציות בהן נשתמש:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Core imports for all functions</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="kn">import</span> <span class="n">Normalize</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.cm</span><span class="w"> </span><span class="kn">import</span> <span class="n">ScalarMappable</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">colormaps</span>
</pre></div>
</div>
</div>
</div>
<section id="id6">
<h3>1) יצירת נתונים<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>בקטע מוגדרות שתי פונקציות עזר פשוטות:</p>
<ol class="arabic">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">()make_data</span></code></strong></p>
<ul class="simple">
<li><p>מחזירה את פרמטרי הבעיה:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">T_amb</span></code> — טמפרטורת סביבה (293.15 K ≈ 20°C).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">T0</span></code> — טמפרטורה התחלתית (373.15 K ≈ 100°C).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">taus</span></code> — מערך של קבועי זמן אופייניים [שניות] (0.5, 2, 10, 50).</p></li>
</ul>
</li>
<li><p>בנוסף יוצרת מערך זמנים <code class="docutils literal notranslate"><span class="pre">t</span></code> הנפרס על פני <strong>חמישה סדרי גודל</strong> (מ־0.01 עד 1000 שניות), באמצעות <code class="docutils literal notranslate"><span class="pre">np.logspace</span></code>, כך שנוכל לעבוד בקלות עם סולם לוגריתמי בציר ה־x.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">model_T(t,</span> <span class="pre">tau,</span> <span class="pre">T_amb,</span> <span class="pre">T0)</span></code></strong></p>
<ul>
<li><p>מחשבת את פונקציית הדעיכה האקספוננציאלית:</p>
<div class="math notranslate nohighlight">
\[
     T(t) = T_{\rm amb} + (T_0 - T_{\rm amb}) \, e^{-t/\tau}
     \]</div>
</li>
<li><p>זוהי הצורה הכללית של מודלים כמו קירור ניוטוני, פריקת קבל במעגל RC או דעיכה רדיואקטיבית.</p></li>
<li><p>הפונקציה מקבלת וקטור זמנים <code class="docutils literal notranslate"><span class="pre">t</span></code>, קבוע זמן <code class="docutils literal notranslate"><span class="pre">tau</span></code>, ואת הפרמטרים הפיזיקליים, ומחזירה את הערכים של <span class="math notranslate nohighlight">\(T(t)\)</span>.</p></li>
</ul>
</li>
</ol>
<p>בקצרה: <strong><code class="docutils literal notranslate"><span class="pre">make_data</span></code> מגדירה נתוני התחלה ורשת זמנים לוגריתמית, ו־<code class="docutils literal notranslate"><span class="pre">model_T</span></code> מחזירה את פתרון הדעיכה עבורם.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">make_data</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create parameters and a log-spaced time grid.&quot;&quot;&quot;</span>
    <span class="n">T_amb</span> <span class="o">=</span> <span class="mf">293.15</span>                 <span class="c1"># K (ambient, ~20°C)</span>
    <span class="n">T0</span>    <span class="o">=</span> <span class="mf">373.15</span>                 <span class="c1"># K (initial, ~100°C)</span>
    <span class="n">taus</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">])</span>  <span class="c1"># s (span decades)</span>
    <span class="n">t</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">800</span><span class="p">)</span>          <span class="c1"># log grid for x-scale</span>
    <span class="k">return</span> <span class="n">T_amb</span><span class="p">,</span> <span class="n">T0</span><span class="p">,</span> <span class="n">taus</span><span class="p">,</span> <span class="n">t</span>

<span class="k">def</span><span class="w"> </span><span class="nf">model_T</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">T_amb</span><span class="p">,</span> <span class="n">T0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exponential decay model: T(t)=T_amb + (T0-T_amb)*exp(-t/tau).&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">T_amb</span> <span class="o">+</span> <span class="p">(</span><span class="n">T0</span> <span class="o">-</span> <span class="n">T_amb</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">/</span><span class="n">tau</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="colormap">
<h3>2) הכנה ל־Colormap<a class="headerlink" href="#colormap" title="Link to this heading">#</a></h3>
<p>בקטע מוגדרת הפונקציה <strong><code class="docutils literal notranslate"><span class="pre">prepare_colormap(taus,</span> <span class="pre">cmap_name=&quot;viridis&quot;)</span></code></strong> שמטרתה להכין מפת צבעים לשימוש עקבי בגרפים:</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">Normalize</span></code></strong></p>
<ul>
<li><p>אובייקט מ־Matplotlib שממיר ערכים נומריים (כאן: ערכי <span class="math notranslate nohighlight">\(\tau\)</span>) לסולם <span class="math notranslate nohighlight">\([0,1]\)</span>.</p></li>
<li><p>ההגדרה <code class="docutils literal notranslate"><span class="pre">vmin=np.min(taus),</span> <span class="pre">vmax=np.max(taus)</span></code> מבטיחה שהערך הקטן ביותר של <span class="math notranslate nohighlight">\(\tau\)</span> יתאים לתחילת הסקאלה (0), והגדול ביותר לסופה (1).</p></li>
<li><p>זה מאפשר למפות את כל ערכי <span class="math notranslate nohighlight">\(\tau\)</span> בצורה פרופורציונלית לצבעים.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">colormaps.get_cmap(cmap_name)</span></code></strong></p>
<ul>
<li><p>הפונקציה המומלצת כיום (במקום <code class="docutils literal notranslate"><span class="pre">get_cmap</span></code>, שהוצאה משימוש) להחזרת מפת הצבעים המבוקשת.</p></li>
<li><p>ברירת המחדל <code class="docutils literal notranslate"><span class="pre">&quot;viridis&quot;</span></code> היא אחת מהמפות המומלצות להצגה מדעית, עם מעבר חלק וברור של צבעים.</p></li>
</ul>
</li>
<li><p>הפונקציה מחזירה זוג: <code class="docutils literal notranslate"><span class="pre">(norm,</span> <span class="pre">cmap)</span></code></p>
<ul>
<li><p>ניתן להשתמש ב־<code class="docutils literal notranslate"><span class="pre">cmap(norm(tau))</span></code> כדי לקבל צבע עקבי עבור כל ערך <span class="math notranslate nohighlight">\(\tau\)</span>.</p></li>
</ul>
</li>
</ul>
<p>בקצרה: הפונקציה <strong>מכינה מנגנון שמתרגם ערכי <span class="math notranslate nohighlight">\(\tau\)</span> לצבעים בהתאם למפת צבעים מדעית (כמו viridis)</strong>, וכך כל גרף יהיה עקבי וברור מבחינה ויזואלית.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">prepare_colormap</span><span class="p">(</span><span class="n">taus</span><span class="p">,</span> <span class="n">cmap_name</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a Normalize and Colormap for consistent color coding by tau.&quot;&quot;&quot;</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">taus</span><span class="p">)),</span> <span class="n">vmax</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">taus</span><span class="p">)))</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">colormaps</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap_name</span><span class="p">)</span>  <span class="c1"># new recommended syntax</span>
    <span class="k">return</span> <span class="n">norm</span><span class="p">,</span> <span class="n">cmap</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="x">
<h3>3) ציור הלוח העליון + סולם לוגריתמי בציר <span class="math notranslate nohighlight">\(x\)</span><a class="headerlink" href="#x" title="Link to this heading">#</a></h3>
<p>בקטע מוגדרת הפונקציה <strong><code class="docutils literal notranslate"><span class="pre">(...)plot_top_panel</span></code></strong>, שאחראית לצייר את התרשים העליון עם כל ההגדרות המתקדמות של Matplotlib:</p>
<ol class="arabic simple">
<li><p><strong>לולאת ציור העקומות</strong></p>
<ul class="simple">
<li><p>לכל ערך <span class="math notranslate nohighlight">\(\tau\)</span> מחשבים את <span class="math notranslate nohighlight">\(T(t)\)</span> באמצעות <code class="docutils literal notranslate"><span class="pre">model_T</span></code>.</p></li>
<li><p>מציירים עם <code class="docutils literal notranslate"><span class="pre">(...)ax.plot</span></code> כאשר הצבע נקבע לפי <code class="docutils literal notranslate"><span class="pre">cmap(norm(tau))</span></code>, כלומר ערך <span class="math notranslate nohighlight">\(\tau\)</span> מתורגם לצבע במפה.</p></li>
<li><p>מוסיפים <code class="docutils literal notranslate"><span class="pre">label</span></code> כך שהעקומה תופיע במקרא עם הערך המתאים של <span class="math notranslate nohighlight">\(\tau\)</span>.</p></li>
</ul>
</li>
<li><p><strong>סולם לוגריתמי בציר <span class="math notranslate nohighlight">\(x\)</span></strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ax.set_xscale(&quot;log&quot;)</span></code> הופך את ציר הזמן ללוגריתמי, שימושי להצגת תהליכים על פני סדרי גודל שונים.</p></li>
</ul>
</li>
<li><p><strong>תוויות לצירים עם יחידות</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ax.set_xlabel(r&quot;$t$</span> <span class="pre">(s)&quot;)</span></code> ו־<code class="docutils literal notranslate"><span class="pre">ax.set_ylabel(r&quot;$T$</span> <span class="pre">(K)&quot;)</span></code> מציינים את המשתנה והיחידות.</p></li>
</ul>
</li>
<li><p><strong>טיקים ותוויות מדעיות</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ax.ticklabel_format(axis=&quot;y&quot;,</span> <span class="pre">style=&quot;sci&quot;,</span> <span class="pre">scilimits=(-2,2),</span> <span class="pre">useMathText=True)</span></code> מציג את המספרים בציר <span class="math notranslate nohighlight">\(y\)</span> בסגנון מדעי (כוחי 10), עם תחום שבו זה נכפה.</p></li>
</ul>
</li>
<li><p><strong>התאמות נוספות לטיקים</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(...)ax.tick_params</span></code> קובע סגנון טיקים אחיד (כלפי פנים, גם בצירים עליונים וימניים).</p></li>
</ul>
</li>
<li><p><strong>רשת גרף (grid)</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ax.grid(True,</span> <span class="pre">which=&quot;both&quot;,</span> <span class="pre">linestyle=&quot;-&quot;,</span> <span class="pre">alpha=0.2)</span></code> מוסיף רשת עדינה גם לטיקים משניים, מה שמקל על קריאת ערכים.</p></li>
</ul>
</li>
<li><p><strong>מקרא (legend)</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(...)ax.legend</span></code> יוצר מקרא עם כותרת “Cooling curves”, המציג איזו עקומה מתאימה לאיזה <span class="math notranslate nohighlight">\(\tau\)</span>.</p></li>
</ul>
</li>
<li><p><strong>כותרת לגרף</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(...)ax.set_title</span></code> נותן כותרת ברורה שמסבירה שזהו תרשים להדגמת שימושים מתקדמים ב־Matplotlib.</p></li>
</ul>
</li>
</ol>
<p>בקצרה: הפונקציה מציירת את עקומות הקירור <span class="math notranslate nohighlight">\(T(t)\)</span> עבור ערכי <span class="math notranslate nohighlight">\(\tau\)</span> שונים, ומדגימה <strong>שילוב של סולם לוגריתמי, טיקים מדעיים, מקרא, רשת וכותרות</strong> — כלומר את רוב פיצ’רי הבסיס המתקדמים של Matplotlib.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_top_panel</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">taus</span><span class="p">,</span> <span class="n">T_amb</span><span class="p">,</span> <span class="n">T0</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">cmap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot T(t) curves with log x-scale, scientific ticks, and legend.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">tau</span> <span class="ow">in</span> <span class="n">taus</span><span class="p">:</span>
        <span class="n">T</span> <span class="o">=</span> <span class="n">model_T</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">T_amb</span><span class="p">,</span> <span class="n">T0</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">tau</span><span class="p">)),</span>
                <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s2">&quot;$\tau=</span><span class="si">{</span><span class="n">tau</span><span class="si">:</span><span class="s2">g</span><span class="si">}</span><span class="s2">\,\mathrm</span><span class="se">{{</span><span class="s2">s</span><span class="se">}}</span><span class="s2">$&quot;</span><span class="p">)</span>  <span class="c1"># plot() with label for legend</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>                  <span class="c1"># &lt;- log scale on x</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$t$ (s)&quot;</span><span class="p">)</span>             <span class="c1"># &lt;- axis label with units</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$T$ (K)&quot;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;sci&quot;</span><span class="p">,</span> <span class="n">scilimits</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">useMathText</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># scientific y</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># tidy ticks</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>                            <span class="c1"># grid for both</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Cooling curves&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>                             <span class="c1"># legend</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Matplotlib advanced features on exponential cooling&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="annotation">
<h3>4) הוספת Annotation לנקודת חצי־זמן<a class="headerlink" href="#annotation" title="Link to this heading">#</a></h3>
<p>בקטע מוגדרת הפונקציה <strong><code class="docutils literal notranslate"><span class="pre">(...)add_annotation</span></code></strong>, שמטרתה להדגיש נקודה פיזיקלית חשובה על הגרף באמצעות כלי ה־annotation של Matplotlib:</p>
<ol class="arabic simple">
<li><p><strong>חישוב נקודת חצי־זמן</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(t_{1/2} = \tau \ln 2\)</span> — הזמן שבו הטמפרטורה ירדה בדיוק למחצית הדרך בין <span class="math notranslate nohighlight">\(T_0\)</span> ל־<span class="math notranslate nohighlight">\(T_{\rm amb}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(T_{1/2} = T_{\rm amb} + \tfrac{1}{2}(T_0 - T_{\rm amb})\)</span> — הערך של הטמפרטורה באותו זמן.</p></li>
</ul>
</li>
<li><p><strong>סימון הנקודה בגרף</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(...)ax.plot</span></code> מצייר נקודה אדומה קטנה (<code class="docutils literal notranslate"><span class="pre">&quot;o&quot;</span></code>) במיקום <span class="math notranslate nohighlight">\((t_{1/2}, T_{1/2})\)</span>.</p></li>
</ul>
</li>
<li><p><strong>קו עזר אנכי</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(...)ax.axvline</span></code> מוסיף קו אנכי מקווקו באותו <span class="math notranslate nohighlight">\(t_{1/2}\)</span> כדי להדגיש את הזמן הזה על כל התרשים.</p></li>
</ul>
</li>
<li><p><strong>הוספת הערה (Annotation)</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(...)ax.annotate</span></code> מציב טקסט “half-time” ליד הנקודה, עם חץ המצביע עליה.</p></li>
<li><p>הפרמטרים <code class="docutils literal notranslate"><span class="pre">xy</span></code>, <code class="docutils literal notranslate"><span class="pre">xytext</span></code>, <code class="docutils literal notranslate"><span class="pre">arrowprops</span></code> שולטים על מיקום החץ, מיקום הטקסט, וסגנון החץ.</p></li>
</ul>
</li>
</ol>
<p>בקצרה: הפונקציה מוסיפה <strong>סימון נקודתי, קו עזר וטקסט עם חץ</strong> כדי להמחיש בצורה ברורה את מושג ה־<strong>חצי־זמן</strong> על הגרף.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">add_annotation</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">T_amb</span><span class="p">,</span> <span class="n">T0</span><span class="p">,</span> <span class="n">tau_sel</span><span class="o">=</span><span class="mf">2.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add an annotation for the half-time point t_half = tau*ln(2).&quot;&quot;&quot;</span>
    <span class="n">t_half</span> <span class="o">=</span> <span class="n">tau_sel</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
    <span class="n">T_half</span> <span class="o">=</span> <span class="n">T_amb</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">T0</span> <span class="o">-</span> <span class="n">T_amb</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_half</span><span class="p">,</span> <span class="n">T_half</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;crimson&quot;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>   <span class="c1"># marker at the point</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">t_half</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;crimson&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>  <span class="c1"># helper line</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;half-time&quot;</span><span class="p">,</span>                               <span class="c1"># annotate() with arrow</span>
                <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">t_half</span><span class="p">,</span> <span class="n">T_half</span><span class="p">),</span>
                <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">T_half</span> <span class="o">+</span> <span class="mi">8</span><span class="p">),</span>
                <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="k-c">
<h3>5) ציר תאום ליחידות חלופיות (K ↔ °C)<a class="headerlink" href="#k-c" title="Link to this heading">#</a></h3>
<p>בקטע מוגדרת הפונקציה <strong><code class="docutils literal notranslate"><span class="pre">add_twin_axis_celsius(ax)</span></code></strong>, שמטרתה להוסיף <strong>ציר <span class="math notranslate nohighlight">\(y\)</span> ימני</strong> שבו הערכים מוצגים במעלות צלזיוס (°C), בהתאמה לציר השמאלי שמוצג בקלווין (K).</p>
<ol class="arabic simple">
<li><p><strong>יצירת ציר תאום</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">()ax.twinx</span></code> יוצר ציר חדש שמשתף את אותו ציר <span class="math notranslate nohighlight">\(x\)</span> אך מאפשר תוויות שונות בציר <span class="math notranslate nohighlight">\(y\)</span> הימני.</p></li>
<li><p>מגדירים את התווית שלו כ־”<span class="math notranslate nohighlight">\(T\)</span> (°C)”.</p></li>
</ul>
</li>
<li><p><strong>יישור תחומי הציר</strong></p>
<ul class="simple">
<li><p>קוראים את תחום הערכים של הציר השמאלי (<code class="docutils literal notranslate"><span class="pre">()y0,</span> <span class="pre">y1</span> <span class="pre">=</span> <span class="pre">ax.get_ylim</span></code>).</p></li>
<li><p>מגדירים את הציר הימני כך שיתחיל מ־<code class="docutils literal notranslate"><span class="pre">y0</span> <span class="pre">-</span> <span class="pre">273.15</span></code> ועד <code class="docutils literal notranslate"><span class="pre">y1</span> <span class="pre">-</span> <span class="pre">273.15</span></code>, כלומר הזזה של כל הטווח ממעלות קלווין ל־°C.</p></li>
<li><p>כך מבטיחים ששני הצירים מציגים את אותו גרף, אבל ביחידות שונות.</p></li>
</ul>
</li>
<li><p><strong>סנכרון הטיקים</strong></p>
<ul class="simple">
<li><p>לוקחים את רשימת הטיקים מהציר השמאלי (<code class="docutils literal notranslate"><span class="pre">()ax.get_yticks</span></code>).</p></li>
<li><p>קובעים טיקים בצד ימין באותן נקודות ויזואליות, אך עם ערכים מומרות ל־°C.</p></li>
<li><p>לדוגמה: אם בצד שמאל מופיע <code class="docutils literal notranslate"><span class="pre">300</span> <span class="pre">K</span></code>, בצד ימין יופיע <code class="docutils literal notranslate"><span class="pre">26.9</span> <span class="pre">°C</span></code> בדיוק באותו גובה.</p></li>
</ul>
</li>
<li><p><strong>ניקיון גרפי</strong></p>
<ul class="simple">
<li><p>מכבים את ה־grid בצד הימני (<code class="docutils literal notranslate"><span class="pre">ax2.grid(False)</span></code>), כדי למנוע רשת כפולה.</p></li>
<li><p>קובעים שטיקים פונים פנימה (<code class="docutils literal notranslate"><span class="pre">ax2.tick_params(direction=&quot;in&quot;)</span></code>) כדי להבדיל מציר שמאל.</p></li>
</ul>
</li>
<li><p><strong>החזרת הציר</strong></p>
<ul class="simple">
<li><p>מחזירים את הציר הימני (<code class="docutils literal notranslate"><span class="pre">ax2</span></code>) כדי שניתן יהיה להמשיך לעבוד עליו אם צריך.</p></li>
</ul>
</li>
</ol>
<p>בקצרה: הפונקציה יוצרת <strong>ציר תאום בצד ימין</strong> עם יחידות צלזיוס, מיושר ומסונכרן עם הציר השמאלי בקלווין, כך שהקורא יכול לקרוא את הגרף בשתי מערכות יחידות במקביל.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">add_twin_axis_celsius</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a right y-axis in °C aligned with the left y-axis in K.&quot;&quot;&quot;</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>                          <span class="c1"># create a twin y-axis</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$T$ (°C)&quot;</span><span class="p">)</span>
    
    <span class="c1"># Align y-limits so ticks match line-by-line</span>
    <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y0</span> <span class="o">-</span> <span class="mf">273.15</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="mf">273.15</span><span class="p">)</span>    <span class="c1"># same visual positions</span>
    
    <span class="c1"># Copy left ticks and show converted labels on the right</span>
    <span class="n">left_ticks</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">left_ticks</span> <span class="o">-</span> <span class="mf">273.15</span><span class="p">)</span>       <span class="c1"># place ticks at matching heights</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">v</span><span class="o">-</span><span class="mf">273.15</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">left_ticks</span><span class="p">])</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>                            <span class="c1"># keep grid only on left</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax2</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="colorbar">
<h3>6) הוספת Colorbar<a class="headerlink" href="#colorbar" title="Link to this heading">#</a></h3>
<p>בקטע מוגדרת הפונקציה <strong><code class="docutils literal notranslate"><span class="pre">add_colorbar(fig,</span> <span class="pre">ax,</span> <span class="pre">norm,</span> <span class="pre">cmap)</span></code></strong>, שמטרתה להוסיף <strong>סרגל צבעים (Colorbar)</strong> לגרף — כדי להסביר איך הצבעים משויכים לערכים של קבוע הזמן <span class="math notranslate nohighlight">\(\tau\)</span>.</p>
<ol class="arabic simple">
<li><p><strong>יצירת <code class="docutils literal notranslate"><span class="pre">ScalarMappable</span></code></strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ScalarMappable(norm=norm,</span> <span class="pre">cmap=cmap)</span></code> יוצר אובייקט שמתרגם ערכים נומריים (כאן ערכי <span class="math notranslate nohighlight">\(\tau\)</span>) לצבעים.</p></li>
<li><p>משתמשים באותו <code class="docutils literal notranslate"><span class="pre">norm</span></code> (נורמליזציה לערכים בין המינימום והמקסימום של <span class="math notranslate nohighlight">\(\tau\)</span>) ובאותו <code class="docutils literal notranslate"><span class="pre">cmap</span></code> (מפת הצבעים) שהוגדרו עבור הגרף, כדי להבטיח עקביות בין הצבעים בעקומות לבין הסרגל.</p></li>
</ul>
</li>
<li><p><strong>קביעת מערך דמה</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">([])sm.set_array</span></code> נדרש טכנית כדי ש־Matplotlib ידע שיש “נתונים” לצבוע. כאן מספיק מערך ריק.</p></li>
</ul>
</li>
<li><p><strong>הוספת Colorbar לגרף</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fig.colorbar(sm,</span> <span class="pre">ax=ax,</span> <span class="pre">pad=0.02)</span></code> מצייר סרגל צבעים בצד הגרף הנתון (<code class="docutils literal notranslate"><span class="pre">ax</span></code>).</p></li>
<li><p>הפרמטר <code class="docutils literal notranslate"><span class="pre">pad</span></code> שולט על המרווח בין הסרגל לבין הגרף.</p></li>
</ul>
</li>
<li><p><strong>הוספת תווית לסרגל</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cbar.set_label(r&quot;time</span> <span class="pre">constant</span> <span class="pre">$\tau$</span> <span class="pre">(s)&quot;)</span></code> מוסיף כיתוב ברור לסרגל: “time constant τ (s)”, עם נוסחת <span class="math notranslate nohighlight">\(\tau\)</span> ב־LaTeX.</p></li>
</ul>
</li>
</ol>
<p>בקצרה: הפונקציה יוצרת <strong>סרגל צבעים שמראה איזה ערך <span class="math notranslate nohighlight">\(\tau\)</span> מתאים לכל צבע</strong>, ומציבה אותו ליד התרשים בצורה עקבית וברורה.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">add_colorbar</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">cmap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Attach a colorbar that explains the color coding of τ.&quot;&quot;&quot;</span>
    <span class="n">sm</span> <span class="o">=</span> <span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>  <span class="c1"># create mappable without image</span>
    <span class="n">sm</span><span class="o">.</span><span class="n">set_array</span><span class="p">([])</span>                           <span class="c1"># dummy array to enable colorbar</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>   <span class="c1"># colorbar attached to this axes</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;time constant $\tau$ (s)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="y">
<h3>7) לוח תחתון עם <span class="math notranslate nohighlight">\(y\)</span> לוגריתמי<a class="headerlink" href="#y" title="Link to this heading">#</a></h3>
<p>בקטע מוגדרת הפונקציה <strong><code class="docutils literal notranslate"><span class="pre">(...)plot_bottom_loglog</span></code></strong>, שמטרתה לצייר את ההפרש<br />
<span class="math notranslate nohighlight">\(\Delta T(t) = T(t) - T_{\rm amb}\)</span> על <strong>צירים לוגריתמיים</strong> (גם <span class="math notranslate nohighlight">\(x\)</span>, גם <span class="math notranslate nohighlight">\(y\)</span>) כדי להדגים את השימוש ב־<code class="docutils literal notranslate"><span class="pre">set_yscale('log')</span></code>.</p>
<ol class="arabic simple">
<li><p><strong>ציור עקומות <span class="math notranslate nohighlight">\(\Delta T\)</span></strong></p>
<ul class="simple">
<li><p>עבור כל ערך <span class="math notranslate nohighlight">\(\tau\)</span> מחשבים את ההפרש <span class="math notranslate nohighlight">\(\Delta T(t)\)</span> ע”י קריאה ל־<code class="docutils literal notranslate"><span class="pre">model_T</span></code>.</p></li>
<li><p>מציירים עם <code class="docutils literal notranslate"><span class="pre">(...)ax_logy.plot</span></code>, הצבעים מוגדרים לפי <code class="docutils literal notranslate"><span class="pre">cmap(norm(tau))</span></code> כך שכל <span class="math notranslate nohighlight">\(\tau\)</span> מקבל צבע ייחודי עקבי.</p></li>
</ul>
</li>
<li><p><strong>הגדרת סולמות לוגריתמיים</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ax_logy.set_xscale(&quot;log&quot;)</span></code> הופך את ציר <span class="math notranslate nohighlight">\(x\)</span> (הזמן) ללוגריתמי, כדי להציג סדרי גודל רבים בצורה ברורה.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ax_logy.set_yscale(&quot;log&quot;)</span></code> הופך את ציר <span class="math notranslate nohighlight">\(y\)</span> (ההפרש <span class="math notranslate nohighlight">\(\Delta T\)</span>) ללוגריתמי.</p></li>
<li><p>שילוב של שניהם יוצר תרשים <strong>log–log</strong>, שבו דעיכה אקספוננציאלית מתקבלת כקו ישר כאשר מוצג <span class="math notranslate nohighlight">\(\log(\Delta T)\)</span> מול <span class="math notranslate nohighlight">\(t\)</span>.</p></li>
</ul>
</li>
<li><p><strong>תוויות עם יחידות</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(...)ax_logy.set_xlabel</span></code> ו־<code class="docutils literal notranslate"><span class="pre">(...)ax_logy.set_ylabel</span></code> מבהירים את המשתנים והיחידות (שניות ו־קלווין).</p></li>
</ul>
</li>
<li><p><strong>רשת גרף</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ax_logy.grid(True,</span> <span class="pre">which=&quot;both&quot;,</span> <span class="pre">...)</span></code> מוסיפה רשת גם לטיקים הראשיים וגם למשניים, כדי להקל על קריאת ערכים בלוגריתם.</p></li>
</ul>
</li>
<li><p><strong>התאמת טיקים</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(...)ax_logy.tick_params</span></code> מכוונת את הטיקים כלפי פנים (<code class="docutils literal notranslate"><span class="pre">direction=&quot;in&quot;</span></code>) ומפעילה טיקים גם בצירים העליונים והימניים.</p></li>
</ul>
</li>
<li><p><strong>כותרת</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(...)ax_logy.set_title</span></code> מציינת במפורש שמדובר בצירים log–log, ומדגישה את השימוש ב־<code class="docutils literal notranslate"><span class="pre">set_yscale('log')</span></code>.</p></li>
</ul>
</li>
</ol>
<p>בקצרה: הפונקציה מציירת את <span class="math notranslate nohighlight">\(\Delta T\)</span> על תרשים <strong>לוגריתמי כפול</strong> (log–log), ומדגימה בצורה ברורה את <strong>השימוש ב־Matplotlib לקביעת סולמות לוגריתמיים בצירים</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_bottom_loglog</span><span class="p">(</span><span class="n">ax_logy</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">taus</span><span class="p">,</span> <span class="n">T_amb</span><span class="p">,</span> <span class="n">T0</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">cmap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot ΔT on log-log scales to demonstrate set_yscale(&#39;log&#39;).&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">tau</span> <span class="ow">in</span> <span class="n">taus</span><span class="p">:</span>
        <span class="n">dT</span> <span class="o">=</span> <span class="n">model_T</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">T_amb</span><span class="p">,</span> <span class="n">T0</span><span class="p">)</span> <span class="o">-</span> <span class="n">T_amb</span>
        <span class="n">ax_logy</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dT</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">tau</span><span class="p">)))</span>        <span class="c1"># plot ΔT curves</span>
    
    <span class="n">ax_logy</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>                             <span class="c1"># log x</span>
    <span class="n">ax_logy</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>                             <span class="c1"># log y</span>
    <span class="n">ax_logy</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$t$ (s)&quot;</span><span class="p">)</span>
    <span class="n">ax_logy</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\Delta T$ (K)&quot;</span><span class="p">)</span>
    <span class="n">ax_logy</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>  <span class="c1"># grid</span>
    <span class="n">ax_logy</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax_logy</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;ΔT on log–log axes (using set_yscale(&#39;log&#39;))&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id7">
<h3>8) הרכבה, הצגה ושמירה<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<p>בקטע מוגדרת הפונקציה <strong><code class="docutils literal notranslate"><span class="pre">run_matplotlib_advanced_demo(savepath=None)</span></code></strong>, שהיא פונקציית־על שמחברת את כל החלקים הקודמים לכדי דוגמה אחת מלאה.<br />
המטרה היא להציג בצורה מרוכזת את כל השימושים המתקדמים ב־Matplotlib, עם אפשרות לשמור את התוצאה לקובץ.</p>
<ol class="arabic simple">
<li><p><strong>יצירת נתונים ומפת צבעים</strong></p>
<ul class="simple">
<li><p>קריאה ל־<code class="docutils literal notranslate"><span class="pre">()make_data</span></code> מייצרת את הפרמטרים (טמפרטורות, קבועי זמן ורשת זמן).</p></li>
<li><p>קריאה ל־<code class="docutils literal notranslate"><span class="pre">(...)prepare_colormap</span></code> מגדירה את מנגנון מיפוי הצבעים לפי <span class="math notranslate nohighlight">\(\tau\)</span>.</p></li>
</ul>
</li>
<li><p><strong>יצירת פיגורה עם שני תרשימים (subplots)</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">plt.subplots(2,</span> <span class="pre">1,</span> <span class="pre">...)</span></code> מחזירה פיגורה (<code class="docutils literal notranslate"><span class="pre">fig</span></code>) ושני צירים:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">ax</span></code> — לוח עליון.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ax_logy</span></code> — לוח תחתון.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">constrained_layout=True</span></code> דואג לפריסה מסודרת ללא חפיפות.</p></li>
</ul>
</li>
<li><p><strong>ציור הלוח העליון</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(...)plot_top_panel</span></code> מצייר את <span class="math notranslate nohighlight">\(T(t)\)</span> עם כל ההגדרות המתקדמות (סולם לוגריתמי, מקרא, טיקים מדעיים).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(...)add_annotation</span></code> מוסיף חץ וטקסט לנקודת חצי־הזמן.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(...)add_twin_axis_celsius</span></code> יוצר ציר ימני עם יחידות °C מסונכרנות עם קלווין.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(...)add_colorbar</span></code> מוסיף סרגל צבעים שמסביר את הקידוד לפי <span class="math notranslate nohighlight">\(\tau\)</span>.</p></li>
</ul>
</li>
<li><p><strong>ציור הלוח התחתון</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(...)plot_bottom_loglog</span></code> מציג את <span class="math notranslate nohighlight">\(\Delta T(t)\)</span> על צירי log–log (גם <span class="math notranslate nohighlight">\(x\)</span>, גם <span class="math notranslate nohighlight">\(y\)</span> לוגריתמיים).</p></li>
</ul>
</li>
<li><p><strong>שמירה אופציונלית</strong></p>
<ul class="simple">
<li><p>אם המשתמש מספק נתיב <code class="docutils literal notranslate"><span class="pre">savepath</span></code>, התמונה נשמרת לקובץ ע”י <code class="docutils literal notranslate"><span class="pre">(...)fig.savefig</span></code>.</p></li>
<li><p>ניתן לשמור בפורמט וקטורי (PDF/SVG) או רסטר (PNG), לפי הסיומת.</p></li>
</ul>
</li>
<li><p><strong>הצגה על המסך</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">()plt.show</span></code> מציגה את הפיגורה עם שני התרשימים.</p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %%</span>
<span class="k">def</span><span class="w"> </span><span class="nf">run_matplotlib_advanced</span><span class="p">(</span><span class="n">savepath</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build the figure, call all plot helpers, and optionally save to file.&quot;&quot;&quot;</span>
    <span class="c1"># Data &amp; color mapping</span>
    <span class="n">T_amb</span><span class="p">,</span> <span class="n">T0</span><span class="p">,</span> <span class="n">taus</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">make_data</span><span class="p">()</span>
    <span class="n">norm</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">prepare_colormap</span><span class="p">(</span><span class="n">taus</span><span class="p">,</span> <span class="s2">&quot;viridis&quot;</span><span class="p">)</span>
    
    <span class="c1"># Figure with two axes</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">ax_logy</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">8.4</span><span class="p">,</span> <span class="mf">7.2</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Top panel: advanced customizations</span>
    <span class="n">plot_top_panel</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">taus</span><span class="p">,</span> <span class="n">T_amb</span><span class="p">,</span> <span class="n">T0</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">cmap</span><span class="p">)</span>
    <span class="n">add_annotation</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">T_amb</span><span class="p">,</span> <span class="n">T0</span><span class="p">,</span> <span class="n">tau_sel</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
    <span class="n">add_twin_axis_celsius</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">add_colorbar</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">cmap</span><span class="p">)</span>
    
    <span class="c1"># Bottom panel: log–log ΔT</span>
    <span class="n">plot_bottom_loglog</span><span class="p">(</span><span class="n">ax_logy</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">taus</span><span class="p">,</span> <span class="n">T_amb</span><span class="p">,</span> <span class="n">T0</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">cmap</span><span class="p">)</span>
    
    <span class="c1"># Optional save (vector if .pdf/.svg; raster if .png)</span>
    <span class="k">if</span> <span class="n">savepath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savepath</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id8">
<h2>9) קריאה להרצה<a class="headerlink" href="#id8" title="Link to this heading">#</a></h2>
<p>לסיום, נקרא לפונקציה הראשית <code class="docutils literal notranslate"><span class="pre">()run_matplotlib_advanced</span></code>את הדמו ולהציג את התוצאה. ניתן להעביר <code class="docutils literal notranslate"><span class="pre">savepath=&quot;advanced_matplotlib.pdf&quot;</span></code> לשמירה.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">run_matplotlib_advanced</span><span class="p">()</span>  <span class="c1"># or run_matplotlib_advanced(&quot;advanced_matplotlib_demo.pdf&quot;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3d5aca5c2efb781035a6e5f88d48f3ed8412be90542a776f23bc67586a476e8b.png" src="_images/3d5aca5c2efb781035a6e5f88d48f3ed8412be90542a776f23bc67586a476e8b.png" />
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div id="nlDWTDBylvyS" data-shufflequestions="False" data-shuffleanswers="True" data-preserveresponses="false" data-numquestions="1000000" data-maxwidth="600" style="border-radius: 10px; text-align: left"><style>
#nlDWTDBylvyS {
   --jq-multiple-choice-bg: #6f78ffff;
   --jq-mc-button-bg: #fafafa;
   --jq-mc-button-border: #e0e0e0e0;
   --jq-mc-button-inset-shadow: #555555;
   --jq-many-choice-bg: #f75c03ff;
   --jq-numeric-bg: #392061ff;
   --jq-numeric-input-bg: #c0c0c0;
   --jq-numeric-input-label: #101010;
   --jq-numeric-input-shadow: #999999;
   --jq-string-bg: #4c1a57;
   --jq-incorrect-color: #c80202;
   --jq-correct-color: #009113;
   --jq-text-color: #fafafa;
}

.Quiz {
    max-width: 600px;
    margin-top: 15px;
    margin-left: auto;
    margin-right: auto;
/*    margin-bottom: 15px;*/
/*    padding-bottom: 4px;*/
    padding-top: 4px;
    line-height: 1.1;
    font-size: 16pt;
    border-radius: inherit;
}

.QuizCode {
    font-size: 14pt;
    margin-top: 10px;
    margin-left: 20px;
    margin-right: 20px;
}

.QuizCode>pre {
    padding: 4px;
}

.Quiz code {
    background-color: lightgray;
    color: black;
}

.Quiz .QuizCode code {
    background-color: inherit;
    color: inherit;
}


.Quiz .MCButton code {
    background-color: inherit;
    color: inherit;
}

.MCButton .QuizCode {
    text-align: left;
}




.Answer {
    border-radius: inherit;
    display: grid;
    grid-gap: 10px;
    grid-template-columns: 1fr 1fr;
    margin: 10px 0;
}

@media only screen and (max-width:480px) {
    .Answer {
        grid-template-columns: 1fr;
    }

}

.Feedback {
    font-size: 16pt;
    text-align: center;
/*    min-height: 2em;*/
}

.Input {
    align: left;
    font-size: 20pt;
}

.Input-text {
    display: block;
    margin: 10px;
    color: inherit;
    width: unset;
    min-width: 140px;
    max-width: 93%;
    field-sizing: content;
    background-color: var(--jq-numeric-input-bg);
    color: var(--jq-text-color);
    padding: 5px;
    padding-left: 10px;
    font-family: inherit;
    font-size: 20px;
    font-weight: inherit;
    line-height: 20pt;
    border: none;
    border-radius: 0.2rem;
    transition: box-shadow 0.1s);
}

.Input-text:focus {
    /*outline: none;*/
    background-color: var(--jq-numeric-input-bg);
    box-shadow: 0.6rem 0.8rem 1.4rem -0.5rem var(--jq-numeric-input-shadow);
}

.MCButton {
    background: var(--jq-mc-button-bg);
    border: 1px solid var(--jq-mc-button-border);
    border-radius: inherit;
    color: #333333;
    padding: 10px;
    font-size: 16px;
    cursor: pointer;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
}

.MCButton p {
    color: inherit;
}

.MultipleChoiceQn {
    padding: 10px;
    background: var(--jq-multiple-choice-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.ManyChoiceQn {
    padding: 10px;
    background: var(--jq-many-choice-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.NumericQn {
    background: var(--jq-numeric-bg);
    border-radius: inherit;
    color: var(--jq-text-color);
    padding: 10px;
}

.NumericQn p {
    color: inherit;
}

.StringQn {
    background: var(--jq-string-bg);
    border-radius: inherit;
    color: var(--jq-text-color);
    padding: 10px;
}

.StringQn p {
    color: inherit;
}


.InpLabel {
    color: var(--jq-numeric-input-label);
    float: left;
    font-size: 15pt;
    line-height: 34px;
    margin-right: 10px;
}

.incorrect {
    color: var(--jq-incorrect-color);
}

.correct {
    color: var(--jq-correct-color);
}

.correctButton {
    /*
    background: var(--jq-correct-color);
   */
    animation: correct-anim 0.6s ease;
    animation-fill-mode: forwards;
    box-shadow: inset 0 0 5px var(--jq-mc-button-inset-shadow);
    color: var(--jq-text-color);
    /*outline: none;*/
}

.incorrectButton {
    animation: incorrect-anim 0.8s ease;
    animation-fill-mode: forwards;
    box-shadow: inset 0 0 5px var(--jq-mc-button-inset-shadow);
    color: var(--jq-text-color);
    /*outline: none;*/
}

@keyframes incorrect-anim {
    100% {
        background-color: var(--jq-incorrect-color);
    }
}

@keyframes correct-anim {
    100% {
        background-color: var(--jq-correct-color);
    }
}
</style></div><script type="application/javascript">var questionsnlDWTDBylvyS=[{"question": "\u05d0\u05dd \u05d1\u05e8\u05e6\u05d5\u05e0\u05e0\u05d5 \u05dc\u05d4\u05e6\u05d9\u05d2 \u05e0\u05ea\u05d5\u05e0\u05d9\u05dd \u05e2\u05dc \u05e4\u05e0\u05d9 \u05e9\u05dc\u05d5\u05e9\u05d4 \u05e1\u05d3\u05e8\u05d9 \u05d2\u05d5\u05d3\u05dc \u05d1\u05e6\u05d9\u05e8 x, \u05d4\u05d1\u05d7\u05d9\u05e8\u05d4 \u05d4\u05d8\u05d5\u05d1\u05d4 \u05d4\u05d9\u05d0:", "type": "many_choice", "answers": [{"answer": "<code>ax.set_xscale('linear')</code>", "correct": false, "feedback": "\u05dc\u05d0 \u05e0\u05db\u05d5\u05df \u2014 \u05e1\u05d5\u05dc\u05dd \u05dc\u05d9\u05e0\u05d9\u05d0\u05e8\u05d9 \u05dc\u05d0 \u05de\u05ea\u05d0\u05d9\u05dd \u05dc\u05e4\u05e8\u05d9\u05e1\u05d4 \u05e2\u05dc \u05e4\u05e0\u05d9 \u05e1\u05d3\u05e8\u05d9 \u05d2\u05d5\u05d3\u05dc \u05e8\u05d1\u05d9\u05dd."}, {"answer": "<code>ax.set_xscale('log')</code>", "correct": true, "feedback": "\u05e0\u05db\u05d5\u05df! \u05e1\u05d5\u05dc\u05dd \u05dc\u05d5\u05d2\u05e8\u05d9\u05ea\u05de\u05d9 \u05d1\u05e6\u05d9\u05e8 x \u05de\u05e6\u05d9\u05d2 \u05d4\u05d9\u05d8\u05d1 \u05e0\u05ea\u05d5\u05e0\u05d9\u05dd \u05e2\u05dc \u05e4\u05e0\u05d9 \u05db\u05de\u05d4 \u05e1\u05d3\u05e8\u05d9 \u05d2\u05d5\u05d3\u05dc."}, {"answer": "<code>ax.set_yscale('log')</code>", "correct": false, "feedback": "\u05d6\u05d4 \u05de\u05e9\u05e0\u05d4 \u05d0\u05ea \u05e1\u05d5\u05dc\u05dd \u05e6\u05d9\u05e8 \u05d4-y, \u05dc\u05d0 \u05d0\u05ea \u05e6\u05d9\u05e8 \u05d4-x."}, {"answer": "\u05dc\u05d4\u05e9\u05d0\u05d9\u05e8 \u05d1\u05e8\u05d9\u05e8\u05ea \u05de\u05d7\u05d3\u05dc", "correct": false, "feedback": "\u05d1\u05e8\u05d9\u05e8\u05ea \u05d4\u05de\u05d7\u05d3\u05dc \u05d4\u05d9\u05d0 \u05e1\u05d5\u05dc\u05dd \u05dc\u05d9\u05e0\u05d9\u05d0\u05e8\u05d9, \u05e9\u05d0\u05d9\u05e0\u05d5 \u05de\u05ea\u05d0\u05d9\u05dd \u05db\u05d0\u05df."}]}, {"question": "\u05de\u05d4 \u05d9\u05d5\u05e6\u05e8 \u05d0\u05d5\u05d1\u05d9\u05d9\u05e7\u05d8 \u05e6\u05d9\u05e8\u05d9\u05dd \u05d7\u05d3\u05e9 \u05d1\u05e9\u05d9\u05d8\u05d4 \u05d4\u05de\u05d5\u05de\u05dc\u05e6\u05ea?", "type": "many_choice", "answers": [{"answer": "<code>fig = plt.figure()</code>", "correct": false, "feedback": "\u05d6\u05d4 \u05d9\u05d5\u05e6\u05e8 Figure \u05d1\u05dc\u05d1\u05d3, \u05dc\u05dc\u05d0 Axes \u05d1\u05e8\u05d9\u05e8\u05ea \u05de\u05d7\u05d3\u05dc."}, {"answer": "<code>ax = plt.axes()</code>", "correct": false, "feedback": "\u05d0\u05de\u05e0\u05dd \u05d9\u05d5\u05e6\u05e8 Axes, \u05d0\u05da \u05d4\u05e9\u05d9\u05d8\u05d4 \u05d4\u05de\u05d5\u05de\u05dc\u05e6\u05ea \u05d5\u05d4\u05e0\u05e4\u05d5\u05e6\u05d4 \u05d4\u05d9\u05d0 <code>plt.subplots()</code>."}, {"answer": "<code>fig, ax = plt.subplots()</code>", "correct": true, "feedback": "\u05e0\u05db\u05d5\u05df! \u05d6\u05d5 \u05d4\u05d3\u05e8\u05da \u05d4\u05de\u05d5\u05de\u05dc\u05e6\u05ea: \u05de\u05e7\u05d1\u05dc\u05d9\u05dd \u05d2\u05dd Figure \u05d5\u05d2\u05dd Axes \u05de\u05d5\u05db\u05e0\u05d9\u05dd \u05dc\u05e9\u05d9\u05de\u05d5\u05e9."}, {"answer": "<code>plt.plot(...)</code>", "correct": false, "feedback": "\u05d6\u05d5 \u05e7\u05e8\u05d9\u05d0\u05d4 \u05d1\u05e1\u05d2\u05e0\u05d5\u05df pyplot; \u05dc\u05d0 \u05d9\u05d5\u05e6\u05e8\u05ea \u05d1\u05de\u05e4\u05d5\u05e8\u05e9 \u05d0\u05d5\u05d1\u05d9\u05d9\u05e7\u05d8\u05d9 Figure \u05d5-Axes \u05dc\u05e2\u05d1\u05d5\u05d3\u05d4 \u05de\u05d1\u05d5\u05e1\u05e1\u05ea-\u05d0\u05d5\u05d1\u05d9\u05d9\u05e7\u05d8\u05d9\u05dd."}]}, {"question": "\u05dc\u05d4\u05e6\u05d2\u05ea \u05e9\u05d3\u05d4 \u05d3\u05d5\u05be\u05de\u05de\u05d3\u05d9 (\u05db\u05de\u05d5 \u05d8\u05de\u05e4\u05e8\u05d8\u05d5\u05e8\u05d4 \u05e2\u05dc \u05e8\u05e9\u05ea), \u05de\u05d4 \u05de\u05ea\u05d0\u05d9\u05dd?", "type": "many_choice", "answers": [{"answer": "<code>plot</code>", "correct": false, "feedback": "plot \u05de\u05ea\u05d0\u05d9\u05dd \u05dc\u05e2\u05e7\u05d5\u05de\u05d5\u05ea/\u05e7\u05d5\u05d5\u05d9\u05dd, \u05dc\u05d0 \u05dc\u05e9\u05d3\u05d5\u05ea \u05d3\u05d5\u05be\u05de\u05de\u05d3\u05d9\u05d9\u05dd."}, {"answer": "<code>scatter</code>", "correct": false, "feedback": "scatter \u05de\u05e6\u05d9\u05d2 \u05e0\u05e7\u05d5\u05d3\u05d5\u05ea \u05d1\u05d3\u05d9\u05d3\u05d5\u05ea; \u05dc\u05e9\u05d3\u05d4 \u05e8\u05e6\u05d9\u05e3 \u05e2\u05d3\u05d9\u05e4\u05d4 \u05d4\u05d3\u05de\u05d9\u05d4 \u05e8\u05e1\u05d8\u05e8\u05d9\u05ea."}, {"answer": "<code>hist</code>", "correct": false, "feedback": "hist \u05de\u05e6\u05d9\u05d2 \u05d4\u05ea\u05e4\u05dc\u05d2\u05d5\u05ea \u05d7\u05d3\u05be\u05de\u05de\u05d3\u05d9\u05ea (\u05d4\u05d9\u05e1\u05d8\u05d5\u05d2\u05e8\u05de\u05d4), \u05dc\u05d0 \u05de\u05e4\u05d4 \u05d3\u05d5\u05be\u05de\u05de\u05d3\u05d9\u05ea."}, {"answer": "<code>imshow</code>", "correct": true, "feedback": "\u05e0\u05db\u05d5\u05df! imshow (\u05d0\u05d5 matshow) \u05de\u05ea\u05d0\u05d9\u05de\u05d9\u05dd \u05dc\u05d4\u05e6\u05d2\u05ea \u05e9\u05d3\u05d5\u05ea/\u05de\u05e4\u05d5\u05ea \u05d7\u05d5\u05dd \u05d3\u05d5\u05be\u05de\u05de\u05d3\u05d9\u05d5\u05ea."}]}];

if (typeof Question === 'undefined') {
// Make a random ID
function makeid(length) {
    var result = [];
    var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
    var charactersLength = characters.length;
    for (var i = 0; i < length; i++) {
        result.push(characters.charAt(Math.floor(Math.random() * charactersLength)));
    }
    return result.join('');
}
// Convert LaTeX delimiters and markdown links to HTML
function jaxify(string) {
    let mystring = string;
    let count = 0, count2 = 0;
    let loc = mystring.search(/([^\\]|^)(\$)/);
    let loc2 = mystring.search(/([^\\]|^)(\$\$)/);
    while (loc >= 0 || loc2 >= 0) {
        if (loc2 >= 0) {
            mystring = mystring.replace(/([^\\]|^)(\$\$)/, count2 % 2 ? '$1\\]' : '$1\\[');
            count2++;
        } else {
            mystring = mystring.replace(/([^\\]|^)(\$)/, count % 2 ? '$1\\)' : '$1\\(');
            count++;
        }
        loc = mystring.search(/([^\\]|^)(\$)/);
        loc2 = mystring.search(/([^\\]|^)(\$\$)/);
    }
    // Replace markdown links
    mystring = mystring.replace(/<http(.*?)>/g, '<a href="http$1" target="_blank" class="Link">http$1</a>');
    mystring = mystring.replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2" target="_blank" class="Link">$1</a>');
    return mystring;
}

// Base class for question types
class Question {
    static registry = {};
    static register(type, cls) {
        Question.registry[type] = cls;
    }
    static create(qa, id, index, options, rootDiv) {
        const Cls = Question.registry[qa.type];
        if (!Cls) {
            console.error(`No question class registered for type "${qa.type}"`);
            return;
        }
        const q = new Cls(qa, id, index, options, rootDiv);
        q.render();
    }

    constructor(qa, id, index, options, rootDiv) {
        this.qa = qa;
        this.id = id;
        this.index = index;
        this.options = options;
        this.rootDiv = rootDiv;
        // wrapper
        this.wrapper = document.createElement('div');
        this.wrapper.id = `quizWrap${id}`;
        this.wrapper.className = 'Quiz';
        this.wrapper.dataset.qnum = index;
        this.wrapper.style.maxWidth = `${options.maxWidth}px`;
        rootDiv.appendChild(this.wrapper);
        // question container
        this.outerqDiv = document.createElement('div');
        this.outerqDiv.id = `OuterquizQn${id}${index}`;
        this.wrapper.appendChild(this.outerqDiv);
        // question text
        this.qDiv = document.createElement('div');
        this.qDiv.id = `quizQn${id}${index}`;
        if (qa.question) {
            this.qDiv.innerHTML = jaxify(qa.question);
            this.outerqDiv.appendChild(this.qDiv);
        }
        // code block
        if (qa.code) {
            const codeDiv = document.createElement('div');
            codeDiv.id = `code${id}${index}`;
            codeDiv.className = 'QuizCode';
            const pre = document.createElement('pre');
            const codeEl = document.createElement('code');
            codeEl.innerHTML = qa.code;
            pre.appendChild(codeEl);
            codeDiv.appendChild(pre);
            this.outerqDiv.appendChild(codeDiv);
        }
        // answer container
        this.aDiv = document.createElement('div');
        this.aDiv.id = `quizAns${id}${index}`;
        this.aDiv.className = 'Answer';
        this.wrapper.appendChild(this.aDiv);
        // feedback container (append after answers)
        this.fbDiv = document.createElement('div');
        this.fbDiv.id = `fb${id}`;
        this.fbDiv.className = 'Feedback';
        this.fbDiv.dataset.answeredcorrect = 0;
    }

    render() {
        throw new Error('render() not implemented');
    }

    preserveResponse(val) {
        if (!this.options.preserveResponses) return;
        const resp = document.getElementById(`responses${this.rootDiv.id}`);
        if (!resp) return;
        const arr = JSON.parse(resp.dataset.responses);
        arr[this.index] = val;
        resp.dataset.responses = JSON.stringify(arr);
        printResponses(resp);
    }

    typeset(container) {
        if (typeof MathJax !== 'undefined') {
            const v = MathJax.version;
            if (v[0] === '2') {
                MathJax.Hub.Queue(['Typeset', MathJax.Hub]);
            } else {
                MathJax.typeset([container]);
            }
        }
    }
}

// Choose a random subset of an array. Can also be used to shuffle the array
function getRandomSubarray(arr, size) {
    var shuffled = arr.slice(0), i = arr.length, temp, index;
    while (i--) {
        index = Math.floor((i + 1) * Math.random());
        temp = shuffled[index];
        shuffled[index] = shuffled[i];
        shuffled[i] = temp;
    }
    return shuffled.slice(0, size);
}

function printResponses(responsesContainer) {
    var responses=JSON.parse(responsesContainer.dataset.responses);
    var stringResponses='<B>IMPORTANT!</B>To preserve this answer sequence for submission, when you have finalized your answers: <ol> <li> Copy the text in this cell below "Answer String"</li> <li> Double click on the cell directly below the Answer String, labeled "Replace Me"</li> <li> Select the whole "Replace Me" text</li> <li> Paste in your answer string and press shift-Enter.</li><li>Save the notebook using the save icon or File->Save Notebook menu item</li></ul><br><br><br><b>Answer String:</b><br> ';
    console.log(responses);
    responses.forEach((response, index) => {
        if (response) {
            console.log(index + ': ' + response);
            stringResponses+= index + ': ' + response +"<BR>";
        }
    });
    responsesContainer.innerHTML=stringResponses;
}
/* Callback function to determine whether a selected multiple-choice
   button corresponded to a correct answer and to provide feedback
   based on the answer */
function check_mc() {
    var id = this.id.split('-')[0];
    //var response = this.id.split('-')[1];
    //console.log(response);
    //console.log("In check_mc(), id="+id);
    //console.log(event.srcElement.id)           
    //console.log(event.srcElement.dataset.correct)   
    //console.log(event.srcElement.dataset.feedback)

    var label = event.srcElement;
    //console.log(label, label.nodeName);
    var depth = 0;
    while ((label.nodeName != "LABEL") && (depth < 20)) {
        label = label.parentElement;
        console.log(depth, label);
        depth++;
    }



    var answers = label.parentElement.children;
    //console.log(answers);

    // Split behavior based on multiple choice vs many choice:
    var fb = document.getElementById("fb" + id);



    /* Multiple choice (1 answer). Allow for 0 correct
       answers as an edge case */
    if (fb.dataset.numcorrect <= 1) {
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            responses[qnum]= response;
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses

        for (var i = 0; i < answers.length; i++) {
            var child = answers[i];
            //console.log(child);
            child.className = "MCButton";
        }



        if (label.dataset.correct == "true") {
            // console.log("Correct action");
            if ("feedback" in label.dataset) {
                fb.innerHTML = jaxify(label.dataset.feedback);
            } else {
                fb.innerHTML = "Correct!";
            }
            label.classList.add("correctButton");

            fb.className = "Feedback";
            fb.classList.add("correct");

        } else {
            if ("feedback" in label.dataset) {
                fb.innerHTML = jaxify(label.dataset.feedback);
            } else {
                fb.innerHTML = "Incorrect -- try again.";
            }
            //console.log("Error action");
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
    }
    else { /* Many choice (more than 1 correct answer) */
        var reset = false;
        var feedback;
         if (label.dataset.correct == "true") {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Correct!";
            }
            if (label.dataset.answered <= 0) {
                if (fb.dataset.answeredcorrect < 0) {
                    fb.dataset.answeredcorrect = 1;
                    reset = true;
                } else {
                    fb.dataset.answeredcorrect++;
                }
                if (reset) {
                    for (var i = 0; i < answers.length; i++) {
                        var child = answers[i];
                        child.className = "MCButton";
                        child.dataset.answered = 0;
                    }
                }
                label.classList.add("correctButton");
                label.dataset.answered = 1;
                fb.className = "Feedback";
                fb.classList.add("correct");

            }
        } else {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Incorrect -- try again.";
            }
            if (fb.dataset.answeredcorrect > 0) {
                fb.dataset.answeredcorrect = -1;
                reset = true;
            } else {
                fb.dataset.answeredcorrect--;
            }

            if (reset) {
                for (var i = 0; i < answers.length; i++) {
                    var child = answers[i];
                    child.className = "MCButton";
                    child.dataset.answered = 0;
                }
            }
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            if (label.dataset.correct == "true") {
                if (typeof(responses[qnum]) == "object"){
                    if (!responses[qnum].includes(response))
                        responses[qnum].push(response);
                } else{
                    responses[qnum]= [ response ];
                }
            } else {
                responses[qnum]= response;
            }
            console.log(responses);
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End save responses stuff



        var numcorrect = fb.dataset.numcorrect;
        var answeredcorrect = fb.dataset.answeredcorrect;
        if (answeredcorrect >= 0) {
            fb.innerHTML = feedback + " [" + answeredcorrect + "/" + numcorrect + "]";
        } else {
            fb.innerHTML = feedback + " [" + 0 + "/" + numcorrect + "]";
        }


    }

    if (typeof MathJax != 'undefined') {
        var version = MathJax.version;
        console.log('MathJax version', version);
        if (version[0] == "2") {
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        } else if (version[0] == "3") {
            MathJax.typeset([fb]);
        }
    } else {
        console.log('MathJax not detected');
    }

}


/* Function to produce the HTML buttons for a multiple choice/
   many choice question  and to update the CSS tags based on
   the question type */
function make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id) {

    var shuffled;
    if (shuffle_answers == true) {
        //console.log(shuffle_answers+" read as true");
        shuffled = getRandomSubarray(qa.answers, qa.answers.length);
    } else {
        //console.log(shuffle_answers+" read as false");
        shuffled = qa.answers;
    }


    var num_correct = 0;

    shuffled.forEach((item, index, ans_array) => {
        //console.log(answer);

        // Make input element
        var inp = document.createElement("input");
        inp.type = "radio";
        inp.id = "quizo" + id + index;
        inp.style = "display:none;";
        aDiv.append(inp);

        //Make label for input element
        var lab = document.createElement("label");
        lab.className = "MCButton";
        lab.id = id + '-' + index;
        lab.onclick = check_mc;
        var aSpan = document.createElement('span');
        aSpan.classsName = "";
        //qDiv.id="quizQn"+id+index;
        if ("answer" in item) {
            aSpan.innerHTML = jaxify(item.answer);
            //aSpan.innerHTML=item.answer;
        }
        lab.append(aSpan);

        // Create div for code inside question
        var codeSpan;
        if ("code" in item) {
            codeSpan = document.createElement('span');
            codeSpan.id = "code" + id + index;
            codeSpan.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeSpan.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = item.code;
            lab.append(codeSpan);
            //console.log(codeSpan);
        }

        //lab.textContent=item.answer;

        // Set the data attributes for the answer
        lab.setAttribute('data-correct', item.correct);
        if (item.correct) {
            num_correct++;
        }
        if ("feedback" in item) {
            lab.setAttribute('data-feedback', item.feedback);
        }
        lab.setAttribute('data-answered', 0);

        aDiv.append(lab);

    });

    if (num_correct > 1) {
        outerqDiv.className = "ManyChoiceQn";
    } else {
        outerqDiv.className = "MultipleChoiceQn";
    }

    return num_correct;

}
// Object-oriented wrapper for MC/MANY choice
class MCQuestion extends Question {
    constructor(qa, id, idx, opts, rootDiv) { super(qa, id, idx, opts, rootDiv); }
    render() {
        //console.log("options.shuffleAnswers " + this.options.shuffleAnswers);
        const numCorrect = make_mc(
            this.qa,
            this.options.shuffleAnswers,
            this.outerqDiv,
            this.qDiv,
            this.aDiv,
            this.id
        );
        if ('answer_cols' in this.qa) {
            this.aDiv.style.gridTemplateColumns =
                'repeat(' + this.qa.answer_cols + ', 1fr)';
        }
        this.fbDiv.dataset.numcorrect = numCorrect;
        this.wrapper.appendChild(this.fbDiv);
    }
}
Question.register('multiple_choice', MCQuestion);
Question.register('many_choice', MCQuestion);
function check_numeric(ths, event) {

    if (event.keyCode === 13) {
        ths.blur();

        var id = ths.id.split('-')[0];

        var submission = ths.value;
        if (submission.indexOf('/') != -1) {
            var sub_parts = submission.split('/');
            //console.log(sub_parts);
            submission = sub_parts[0] / sub_parts[1];
        }
        //console.log("Reader entered", submission);

        if ("precision" in ths.dataset) {
            var precision = ths.dataset.precision;
            submission = Number(Number(submission).toPrecision(precision));
        }


        //console.log("In check_numeric(), id="+id);
        //console.log(event.srcElement.id)           
        //console.log(event.srcElement.dataset.feedback)

        var fb = document.getElementById("fb" + id);
        fb.style.display = "none";
        fb.innerHTML = "Incorrect -- try again.";

        var answers = JSON.parse(ths.dataset.answers);
        //console.log(answers);

        var defaultFB = "Incorrect. Try again.";
        var correct;
        var done = false;
        answers.every(answer => {
            //console.log(answer.type);

            correct = false;
            // if (answer.type=="value"){
            if ('value' in answer) {
                var value;
                if ("precision" in ths.dataset) {
                    value = answer.value.toPrecision(ths.dataset.precision);
                } else {
                    value = answer.value;
                }
                if (submission == value) {
                    if ("feedback" in answer) {
                        fb.innerHTML = jaxify(answer.feedback);
                    } else {
                        fb.innerHTML = jaxify("Correct");
                    }
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }

                // } else if (answer.type=="range") {
            } else if ('range' in answer) {
                console.log(answer.range);
                console.log(submission, submission >=answer.range[0], submission < answer.range[1])
                if ((submission >= answer.range[0]) && (submission < answer.range[1])) {
                    fb.innerHTML = jaxify(answer.feedback);
                    correct = answer.correct;
                    console.log(answer.correct);
                    done = true;
                }
            } else if (answer.type == "default") {
                if ("feedback" in answer) {
                    defaultFB = answer.feedback;
                } 
            }
            if (done) {
                return false; // Break out of loop if this has been marked correct
            } else {
                return true; // Keep looking for case that includes this as a correct answer
            }
        });
        console.log("done:", done);

        if ((!done) && (defaultFB != "")) {
            fb.innerHTML = jaxify(defaultFB);
            //console.log("Default feedback", defaultFB);
        }

        fb.style.display = "block";
        if (correct) {
            ths.className = "Input-text";
            ths.classList.add("correctButton");
            fb.className = "Feedback";
            fb.classList.add("correct");
        } else {
            ths.className = "Input-text";
            ths.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }

        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            console.log(submission);
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            //console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            if (submission == ths.value){
                responses[qnum]= submission;
            } else {
                responses[qnum]= ths.value + "(" + submission +")";
            }
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses

        if (typeof MathJax != 'undefined') {
            var version = MathJax.version;
            console.log('MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([fb]);
            }
        } else {
            console.log('MathJax not detected');
        }
        // After correct answer, if next JupyterQuiz question exists and has a text input, scroll by current question height
        if (correct) {
            // find the current question wrapper
            var wrapper = ths.closest('.Quiz');
            if (wrapper) {
                var nextWrapper = wrapper.nextElementSibling;
                if (nextWrapper && nextWrapper.classList.contains('Quiz')) {
                    var nextInput = nextWrapper.querySelector('input.Input-text');
                    if (nextInput) {
                        var height = wrapper.getBoundingClientRect().height;
                        console.log(height);
                        nextInput.focus();
                    }
                }
            }
        }
        return false;
    }

}
// Object-oriented wrapper for numeric questions
class NumericQuestion extends Question {
    constructor(qa, id, idx, opts, rootDiv) {
        super(qa, id, idx, opts, rootDiv);
    }
    render() {
        make_numeric(this.qa, this.outerqDiv, this.qDiv, this.aDiv, this.id);
        this.wrapper.appendChild(this.fbDiv);
    }
}
Question.register('numeric', NumericQuestion);

function isValid(el, charC) {
    //console.log("Input char: ", charC);
    if (charC == 46) {
        if (el.value.indexOf('.') === -1) {
            return true;
        } else if (el.value.indexOf('/') != -1) {
            var parts = el.value.split('/');
            if (parts[1].indexOf('.') === -1) {
                return true;
            }
        }
        else {
            return false;
        }
    } else if (charC == 47) {
        if (el.value.indexOf('/') === -1) {
            if ((el.value != "") && (el.value != ".")) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else if (charC == 45) {
        var edex = el.value.indexOf('e');
        if (edex == -1) {
            edex = el.value.indexOf('E');
        }

        if (el.value == "") {
            return true;
        } else if (edex == (el.value.length - 1)) { // If just after e or E
            return true;
        } else {
            return false;
        }
    } else if (charC == 101) { // "e"
        if ((el.value.indexOf('e') === -1) && (el.value.indexOf('E') === -1) && (el.value.indexOf('/') == -1)) {
            // Prev symbol must be digit or decimal point:
            if (el.value.slice(-1).search(/\d/) >= 0) {
                return true;
            } else if (el.value.slice(-1).search(/\./) >= 0) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else {
        if (charC > 31 && (charC < 48 || charC > 57))
            return false;
    }
    return true;
}

function numeric_keypress(evnt) {
    var charC = (evnt.which) ? evnt.which : evnt.keyCode;

    if (charC == 13) {
        check_numeric(this, evnt);
    } else {
        return isValid(this, charC);
    }
}





function make_numeric(qa, outerqDiv, qDiv, aDiv, id) {



    //console.log(answer);


    outerqDiv.className = "NumericQn";
    aDiv.style.display = 'block';

    var lab = document.createElement("label");
    lab.className = "InpLabel";
    lab.innerHTML = "Type numeric answer here:";
    aDiv.append(lab);

    var inp = document.createElement("input");
    inp.type = "text";
    //inp.id="input-"+id;
    inp.id = id + "-0";
    inp.className = "Input-text";
    inp.setAttribute('data-answers', JSON.stringify(qa.answers));
    if ("precision" in qa) {
        inp.setAttribute('data-precision', qa.precision);
    }
    aDiv.append(inp);
    //console.log(inp);

    //inp.addEventListener("keypress", check_numeric);
    //inp.addEventListener("keypress", numeric_keypress);
    /*
    inp.addEventListener("keypress", function(event) {
        return numeric_keypress(this, event);
    }
                        );
                        */
    //inp.onkeypress="return numeric_keypress(this, event)";
    inp.onkeypress = numeric_keypress;
    inp.onpaste = event => false;

    inp.addEventListener("focus", function (event) {
        this.value = "";
        return false;
    }
    );


}
// Override show_questions to use object-oriented Question API
function show_questions(json, container) {
    // Accept container element or element ID
    if (typeof container === 'string') {
        container = document.getElementById(container);
    }
    if (!container) {
        console.error('show_questions: invalid container', container);
        return;
    }

    const shuffleQuestions = container.dataset.shufflequestions === 'True';
    const shuffleAnswers = container.dataset.shuffleanswers === 'True';
    const preserveResponses = container.dataset.preserveresponses === 'true';
    const maxWidth = parseInt(container.dataset.maxwidth, 10) || 0;
    let numQuestions = parseInt(container.dataset.numquestions, 10) || json.length;
    if (numQuestions > json.length) numQuestions = json.length;

    let questions = json;
    if (shuffleQuestions || numQuestions < json.length) {
        questions = getRandomSubarray(json, numQuestions);
    }

    questions.forEach((qa, index) => {
        const id = makeid(8);
        const options = {
            shuffleAnswers: shuffleAnswers,
            preserveResponses: preserveResponses,
            maxWidth: maxWidth
        };
        Question.create(qa, id, index, options, container);
    });

    if (preserveResponses) {
        const respDiv = document.createElement('div');
        respDiv.id = 'responses' + container.id;
        respDiv.className = 'JCResponses';
        respDiv.dataset.responses = JSON.stringify([]);
        respDiv.innerHTML = '<b>Select your answers and then follow the directions that will appear here.</b>';
        container.appendChild(respDiv);
    }

    // Trigger MathJax typesetting if available
    if (typeof MathJax != 'undefined') {
        console.log("MathJax version", MathJax.version);
        var version = MathJax.version;
        setTimeout(function(){
            var version = MathJax.version;
            console.log('After sleep, MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                if (MathJax.hasOwnProperty('typeset') ) {
                    MathJax.typeset([container]);
                } else {
                    console.log('WARNING: Trying to force load MathJax 3');
                    window.MathJax = {
                        tex: {
                            inlineMath: [['$', '$'], ['\\(', '\\)']]
                        },
                        svg: {
                            fontCache: 'global'
                        }
                    };

                    (function () {
                        var script = document.createElement('script');
                        script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js';
                        script.async = true;
                        document.head.appendChild(script);
                    })();
                }
            }
        }, 500);
if (typeof version == 'undefined') {
        } else
        {
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                if (MathJax.hasOwnProperty('typeset') ) {
                    MathJax.typeset([container]);
                } else {
                    console.log('WARNING: Trying to force load MathJax 3');
                    window.MathJax = {
                        tex: {
                            inlineMath: [['$', '$'], ['\\(', '\\)']]
                        },
                        svg: {
                            fontCache: 'global'
                        }
                    };

                    (function () {
                        var script = document.createElement('script');
                        script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js';
                        script.async = true;
                        document.head.appendChild(script);
                    })();
                }
            } else {
                console.log("MathJax not found");
            }
        }
    }
    // if (typeof MathJax !== 'undefined') {
    //     const v = MathJax.version;
    //     if (v[0] === '2') {
    //         MathJax.Hub.Queue(['Typeset', MathJax.Hub]);
    //     } else if (v[0] === '3') {
    //         MathJax.typeset([container]);
    //     }
    // }

    // Prevent link clicks from bubbling up
    Array.from(container.getElementsByClassName('Link')).forEach(link => {
        link.addEventListener('click', e => e.stopPropagation());
    });
}
function levenshteinDistance(a, b) {
    if (a.length === 0) return b.length;
    if (b.length === 0) return a.length;

    const matrix = Array(b.length + 1).fill(null).map(() => Array(a.length + 1).fill(null));

    for (let i = 0; i <= a.length; i++) {
        matrix[0][i] = i;
    }

    for (let j = 0; j <= b.length; j++) {
        matrix[j][0] = j;
    }

    for (let j = 1; j <= b.length; j++) {
        for (let i = 1; i <= a.length; i++) {
            const cost = a[i - 1] === b[j - 1] ? 0 : 1;
            matrix[j][i] = Math.min(
                matrix[j - 1][i] + 1, // Deletion
                matrix[j][i - 1] + 1, // Insertion
                matrix[j - 1][i - 1] + cost // Substitution
            );
        }
    }
    return matrix[b.length][a.length];
}
// Object-oriented wrapper for string input questions
class StringQuestion extends Question {
    constructor(qa, id, idx, opts, rootDiv) {
        super(qa, id, idx, opts, rootDiv);
    }
    render() {
        make_string(this.qa, this.outerqDiv, this.qDiv, this.aDiv, this.id);
        this.wrapper.appendChild(this.fbDiv);
    }
}
Question.register('string', StringQuestion);

function check_string(ths, event) {
    if (event.keyCode === 13) {
        ths.blur();

        var id = ths.id.split('-')[0];
        var submission = ths.value.trim();
        var fb = document.getElementById("fb" + id);
        fb.style.display = "none";
        fb.innerHTML = "Incorrect -- try again.";

        var answers = JSON.parse(ths.dataset.answers);
        var defaultFB = "Incorrect. Try again.";
        var correct;
        var done = false;

        // Handle default answer pattern: filter out and capture default feedback
        var filteredAnswers = [];
        answers.forEach(answer => {
            if (answer.type === "default") {
                defaultFB = answer.feedback;
            } else {
                filteredAnswers.push(answer);
            }
        });
        answers = filteredAnswers;

        answers.every(answer => {
            correct = false;

            let match = false;
            if (answer.match_case) {
                match = submission === answer.answer;
            } else {
                match = submission.toLowerCase() === answer.answer.toLowerCase();
            }
            console.log(submission);
            console.log(answer.answer);
            console.log(match);

            if (match) {
                if ("feedback" in answer) {
                    fb.innerHTML = jaxify(answer.feedback);
                } else {
                    fb.innerHTML = jaxify("Correct");
                }
                correct = answer.correct;
                done = true;
            } else if (answer.fuzzy_threshold) {
                var max_length = Math.max(submission.length, answer.answer.length);
                var ratio;
                if (answer.match_case) {
                    ratio = 1- (levenshteinDistance(submission, answer.answer) / max_length);
                } else {
                    ratio = 1- (levenshteinDistance(submission.toLowerCase(),
                                                    answer.answer.toLowerCase()) / max_length);
                }
                if (ratio >= answer.fuzzy_threshold) {
                    if ("feedback" in answer) {
                        fb.innerHTML = jaxify("(Fuzzy) " + answer.feedback);
                    } else {
                        fb.innerHTML = jaxify("Correct");
                    }
                    correct = answer.correct;
                    done = true;
                }

            }

            if (done) {
                return false;
            } else {
                return true;
            }
        });

        if ((!done) && (defaultFB != "")) {
            fb.innerHTML = jaxify(defaultFB);
        }

        fb.style.display = "block";
        if (correct) {
            ths.className = "Input-text";
            ths.classList.add("correctButton");
            fb.className = "Feedback";
            fb.classList.add("correct");
        } else {
            ths.className = "Input-text";
            ths.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }

        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            var qnum = document.getElementById("quizWrap" + id).dataset.qnum;
            var responses = JSON.parse(responsesContainer.dataset.responses);
            responses[qnum] = submission;
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }

        if (typeof MathJax != 'undefined') {
            var version = MathJax.version;
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([fb]);
            }
        } else {
            console.log('MathJax not detected');
        }
        // After correct answer, if next JupyterQuiz question exists and has a text input, scroll by current question height
        if (correct) {
            var wrapper = ths.closest('.Quiz');
            if (wrapper) {
                var nextWrapper = wrapper.nextElementSibling;
                if (nextWrapper && nextWrapper.classList.contains('Quiz')) {
                    var nextInput = nextWrapper.querySelector('input.Input-text');
                    if (nextInput) {
                        var height = wrapper.getBoundingClientRect().height;
                        nextInput.focus();
                    }
                }
            }
        }
        return false;
    }
}

function string_keypress(evnt) {
    var charC = (evnt.which) ? evnt.which : evnt.keyCode;

    if (charC == 13) {
        check_string(this, evnt);
    } 
}


function make_string(qa, outerqDiv, qDiv, aDiv, id) {
    outerqDiv.className = "StringQn";
    aDiv.style.display = 'block';

    var lab = document.createElement("label");
    lab.className = "InpLabel";
    lab.innerHTML = "Type your answer here:";
    aDiv.append(lab);

    var inp = document.createElement("input");
    inp.type = "text";
    inp.id = id + "-0";
    inp.className = "Input-text";
    inp.setAttribute('data-answers', JSON.stringify(qa.answers));
    // Apply optional input width (approx. number of characters, in em units)
    if (qa.input_width != null) {
        inp.style['min-width'] = qa.input_width + 'em';
    }
    aDiv.append(inp);

    inp.onkeypress = string_keypress;
    inp.onpaste = event => false;

    inp.addEventListener("focus", function (event) {
        this.value = "";
        return false;
    });
}
/*
 * Handle asynchrony issues when re-running quizzes in Jupyter notebooks.
 * Ensures show_questions is called after the container div is in the DOM.
 */
function try_show() {
  if (document.getElementById("nlDWTDBylvyS")) {
    show_questions(questionsnlDWTDBylvyS, nlDWTDBylvyS);
  } else {
    setTimeout(try_show, 200);
  }
};
// Invoke immediately
{
  try_show();
}
}
</script></div>
</div>
</section>
<section id="scipy">
<h2>חלק ב’ — SciPy<a class="headerlink" href="#scipy" title="Link to this heading">#</a></h2>
<p>זוהי ספרייה מדעית (Scientific Python) שנבנתה על בסיס NumPy.<br />
היא מספקת אוסף רחב של פונקציות מתקדמות לחישובים מתמטיים ונומריים:</p>
<ul class="simple">
<li><p>אינטגרציה וחישוב נגזרות</p></li>
<li><p>פתרון משוואות דיפרנציאליות</p></li>
<li><p>אופטימיזציה וחיפוש מינימום/מקסימום</p></li>
<li><p>אלגברה לינארית מתקדמת (כמו SVD, פירוק LU, QR)</p></li>
<li><p>עיבוד אותות ותמונות</p></li>
</ul>
<p>SciPy נחשבת לאחת מהספריות המרכזיות בעולם המדעי בפייתון, והיא משלימה את NumPy בכך שהיא מוסיפה פונקציות יישומיות רבות.</p>
<section id="numpy">
<h3>תזכורת קצרה ל-NumPy + קבועים פיזיקליים<a class="headerlink" href="#numpy" title="Link to this heading">#</a></h3>
<p><strong>SciPy</strong> מוסיפה לאקוסיסטם של NumPy כלים נומריים מתקדמים: אינטגרציה, פתרון ODEs, אופטימיזציה, אינטרפולציה, FFT, עיבוד אותות, אלגברה ליניארית, סטטיסטיקה ועוד.<br />
<strong>קבועים פיזיקליים</strong> זמינים ב־<code class="docutils literal notranslate"><span class="pre">scipy.constants</span></code>: למשל <span class="math notranslate nohighlight">\(c, h, k_B, G\)</span> וכד’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %%</span>
<span class="c1"># Constants and quick NumPy recap — EXPANDED</span>
<span class="c1"># (Safe to run even if previous cells didn&#39;t import constants)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">constants</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">physical_constants</span>  <span class="c1"># for named constants like Wien&#39;s b</span>

<span class="c1"># --- Core physical constants (SI units) ---</span>
<span class="n">c</span>   <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">c</span>               <span class="c1"># speed of light (m/s)</span>
<span class="n">h</span>   <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">h</span>               <span class="c1"># Planck constant (J·s)</span>
<span class="n">hbar</span><span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">hbar</span>            <span class="c1"># reduced Planck constant (J·s)</span>
<span class="n">kB</span>  <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">Boltzmann</span>       <span class="c1"># Boltzmann constant (J/K)</span>
<span class="n">e</span>   <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">e</span>               <span class="c1"># elementary charge (C)</span>
<span class="n">eV</span>  <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">electron_volt</span>   <span class="c1"># 1 eV in Joule (J)</span>
<span class="n">NA</span>  <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">N_A</span>             <span class="c1"># Avogadro number (1/mol)</span>
<span class="n">R</span>   <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">R</span>               <span class="c1"># molar gas constant (J/(mol·K))</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">Stefan_Boltzmann</span>  <span class="c1"># Stefan–Boltzmann constant (W/(m^2·K^4))</span>
<span class="n">epsilon0</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">epsilon_0</span>  <span class="c1"># vacuum permittivity (F/m)</span>
<span class="n">mu0</span>     <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">mu_0</span>        <span class="c1"># vacuum permeability (N/A^2)</span>
<span class="n">G</span>   <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">G</span>               <span class="c1"># gravitational constant (m^3/(kg·s^2))</span>
<span class="n">g0</span>  <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">g</span>               <span class="c1"># standard gravity (m/s^2)</span>

<span class="c1"># Wien&#39;s wavelength-displacement constant b ≈ 2.897771955e-3 m·K (via CODATA)</span>
<span class="n">b_wien</span> <span class="o">=</span> <span class="n">physical_constants</span><span class="p">[</span><span class="s2">&quot;Wien wavelength displacement law constant&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># --- Pretty printing helper (engineering/scientific) ---</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fmt</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Format a number in scientific notation with a unit.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">val</span><span class="si">:</span><span class="s2">.6e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">unit</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Some constants:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  c       =&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s2">&quot;m/s&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  h       =&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="s2">&quot;J·s&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ħ       =&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="p">(</span><span class="n">hbar</span><span class="p">,</span> <span class="s2">&quot;J·s&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  k_B     =&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="p">(</span><span class="n">kB</span><span class="p">,</span> <span class="s2">&quot;J/K&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  e       =&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  1 eV    =&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="p">(</span><span class="n">eV</span><span class="p">,</span> <span class="s2">&quot;J&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  N_A     =&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="p">(</span><span class="n">NA</span><span class="p">,</span> <span class="s2">&quot;1/mol&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  R       =&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="s2">&quot;J/(mol·K)&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  σ       =&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="s2">&quot;W/(m^2·K^4)&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ε0      =&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="p">(</span><span class="n">epsilon0</span><span class="p">,</span> <span class="s2">&quot;F/m&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  μ0      =&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="p">(</span><span class="n">mu0</span><span class="p">,</span> <span class="s2">&quot;N/A^2&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  G       =&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="s2">&quot;m^3/(kg·s^2)&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  g0      =&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="p">(</span><span class="n">g0</span><span class="p">,</span> <span class="s2">&quot;m/s^2&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  b_Wien  =&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="p">(</span><span class="n">b_wien</span><span class="p">,</span> <span class="s2">&quot;m·K&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Some constants:
  c       = 2.997925e+08 m/s
  h       = 6.626070e-34 J·s
  ħ       = 1.054572e-34 J·s
  k_B     = 1.380649e-23 J/K
  e       = 1.602177e-19 C
  1 eV    = 1.602177e-19 J
  N_A     = 6.022141e+23 1/mol
  R       = 8.314463e+00 J/(mol·K)
  σ       = 5.670374e-08 W/(m^2·K^4)
  ε0      = 8.854188e-12 F/m
  μ0      = 1.256637e-06 N/A^2
  G       = 6.674300e-11 m^3/(kg·s^2)
  g0      = 9.806650e+00 m/s^2
  b_Wien  = 2.897772e-03 m·K
</pre></div>
</div>
</div>
</div>
<p>נדגים שימוש באמצעות מספר דוגמאות broadcasting ווקטוריזציה:</p>
<section id="id9">
<h4>1) חישוב אנרגיית פוטון מאורך גל<a class="headerlink" href="#id9" title="Link to this heading">#</a></h4>
<p>אנרגיית פוטון ניתנת על־ידי <span class="math notranslate nohighlight">\(E=\dfrac{hc}{\lambda}\)</span>. בדוגמה יצרנו וקטור של אורכי גל אופייניים בתחום הנראה (ננומטר), המרנו למטרים, וחישבנו את <span class="math notranslate nohighlight">\(E\)</span> לכל ערך — בבת אחת — באמצעות וקטוריזציה של NumPy (כלומר בלי לולאות מפורשות). לבסוף המרות יחידות: מג’ול ל־eV בעזרת <span class="math notranslate nohighlight">\(1\ \mathrm{eV}\)</span> במונחי ג’ול מתוך <code class="docutils literal notranslate"><span class="pre">scipy.constants</span></code>. כך מקבלים אינטואיציה: ככל שהאורך גל קצר יותר (<span class="math notranslate nohighlight">\(\lambda\)</span> קטן), האנרגיה גדולה יותר.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1) Photon energy from wavelength: E = h*c/λ (vectorized over λ)</span>
<span class="n">wavelength_nm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">700</span><span class="p">])</span>           <span class="c1"># nm</span>
<span class="n">wavelength_m</span>  <span class="o">=</span> <span class="n">wavelength_nm</span> <span class="o">*</span> <span class="mf">1e-9</span>                      <span class="c1"># convert to meters</span>
<span class="n">E_J</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">c</span> <span class="o">/</span> <span class="n">wavelength_m</span>                                <span class="c1"># Joule</span>
<span class="n">E_eV</span> <span class="o">=</span> <span class="n">E_J</span> <span class="o">/</span> <span class="n">eV</span>                                           <span class="c1"># electron-volt</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Photon energy for visible wavelengths:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">lam</span><span class="p">,</span> <span class="n">Ej</span><span class="p">,</span> <span class="n">Ev</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">wavelength_nm</span><span class="p">,</span> <span class="n">E_J</span><span class="p">,</span> <span class="n">E_eV</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  λ = </span><span class="si">{</span><span class="n">lam</span><span class="si">:</span><span class="s2">&gt;3.0f</span><span class="si">}</span><span class="s2"> nm  -&gt;  E = </span><span class="si">{</span><span class="n">Ej</span><span class="si">:</span><span class="s2">8.3e</span><span class="si">}</span><span class="s2"> J  = </span><span class="si">{</span><span class="n">Ev</span><span class="si">:</span><span class="s2">7.3f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Photon energy for visible wavelengths:
  λ = 400 nm  -&gt;  E = 4.966e-19 J  =   3.100 eV
  λ = 500 nm  -&gt;  E = 3.973e-19 J  =   2.480 eV
  λ = 600 nm  -&gt;  E = 3.311e-19 J  =   2.066 eV
  λ = 700 nm  -&gt;  E = 2.838e-19 J  =   1.771 eV
</pre></div>
</div>
</div>
</div>
</section>
<section id="k-b-t">
<h4>2) סקאלת אנרגיה תרמית <span class="math notranslate nohighlight">\(k_B T\)</span> ומתיחות תרמית במתח<a class="headerlink" href="#k-b-t" title="Link to this heading">#</a></h4>
<p>בדוגמה זו חישבנו עבור מספר טמפרטורות אופייניות את <span class="math notranslate nohighlight">\(k_B T\)</span> — סדר־גודל האנרגיות החום־תרמיות במערכת. המרה ל־eV מקלה על ההשוואה לפיזיקה של אלקטרונים ומוליכים למחצה. בנוסף חישבנו את ה״מתח התרמי״ <span class="math notranslate nohighlight">\(V_T=\dfrac{k_B T}{e}\)</span>, קנה־מידה חשוב באלקטרוניקה (כ־<span class="math notranslate nohighlight">\(25\)</span>–<span class="math notranslate nohighlight">\(26\)</span> mV בטמפרטורת חדר). שוב, הכל נעשה על מערך של <span class="math notranslate nohighlight">\(T\)</span>ים בבת אחת (וקטוריזציה).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 2) Thermal energy scale: k_B T and thermal voltage (k_B T / e) at a few temperatures</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">77</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>                        <span class="c1"># K (LN2, room, hot, very hot)</span>
<span class="n">kT_J</span> <span class="o">=</span> <span class="n">kB</span> <span class="o">*</span> <span class="n">T</span>
<span class="n">kT_eV</span> <span class="o">=</span> <span class="n">kT_J</span> <span class="o">/</span> <span class="n">eV</span>
<span class="n">thermal_voltage</span> <span class="o">=</span> <span class="n">kT_J</span> <span class="o">/</span> <span class="n">e</span>                                <span class="c1"># Volts</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Thermal scales (vectorized over T):&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">Ti</span><span class="p">,</span> <span class="n">kTJ</span><span class="p">,</span> <span class="n">kTe</span><span class="p">,</span> <span class="n">Vt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">kT_J</span><span class="p">,</span> <span class="n">kT_eV</span><span class="p">,</span> <span class="n">thermal_voltage</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  T = </span><span class="si">{</span><span class="n">Ti</span><span class="si">:</span><span class="s2">&gt;4.0f</span><span class="si">}</span><span class="s2"> K  -&gt;  k_B T = </span><span class="si">{</span><span class="n">kTJ</span><span class="si">:</span><span class="s2">.3e</span><span class="si">}</span><span class="s2"> J = </span><span class="si">{</span><span class="n">kTe</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> eV,  k_B T / e = </span><span class="si">{</span><span class="n">Vt</span><span class="o">*</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> mV&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Thermal scales (vectorized over T):
  T =   77 K  -&gt;  k_B T = 1.063e-21 J = 0.0066 eV,  k_B T / e = 6.64 mV
  T =  300 K  -&gt;  k_B T = 4.142e-21 J = 0.0259 eV,  k_B T / e = 25.85 mV
  T =  600 K  -&gt;  k_B T = 8.284e-21 J = 0.0517 eV,  k_B T / e = 51.70 mV
  T = 1000 K  -&gt;  k_B T = 1.381e-20 J = 0.0862 eV,  k_B T / e = 86.17 mV
</pre></div>
</div>
</div>
</div>
</section>
<section id="broadcasting">
<h4>3) דוגמת Broadcasting: אנרגיה פוטנציאלית כבידתית<a class="headerlink" href="#broadcasting" title="Link to this heading">#</a></h4>
<p>רצינו את האנרגיה <span class="math notranslate nohighlight">\(U=mgh\)</span> לכל צירוף של כמה מסות וכמה גבהים. שימוש ב־<strong>Broadcasting</strong> מאפשר לחשב מטריצה <span class="math notranslate nohighlight">\(U\)</span> במכה אחת: ממד המסות כעמודות והגבהים כשורות (או להפך) באמצעות הוספת מימד חדש (<code class="docutils literal notranslate"><span class="pre">masses[:,</span> <span class="pre">None]</span></code> ו־<code class="docutils literal notranslate"><span class="pre">heights[None,</span> <span class="pre">:]</span></code>). זו פרקטיקה חשובה לעבודה יעילה עם טבלאות/סריגים בלי לולאות.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 3) Broadcasting example: Gravitational potential energy U = m * g0 * h</span>
<span class="c1">#    masses shape (3,), heights shape (4,) -&gt; U shape (3,4) via broadcasting</span>
<span class="n">masses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">])</span>                        <span class="c1"># kg</span>
<span class="n">heights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">])</span>                 <span class="c1"># m</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">masses</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">g0</span> <span class="o">*</span> <span class="n">heights</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>               <span class="c1"># J, shape (3,4)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Gravitational potential energy matrix U[mass, height] = m * g0 * h (J):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gravitational potential energy matrix U[mass, height] = m * g0 * h (J):
[[  0.980665   1.96133    3.92266   19.6133  ]
 [  4.903325   9.80665   19.6133    98.0665  ]
 [ 24.516625  49.03325   98.0665   490.3325  ]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="id10">
<h4>4) חוק וין: אורך גל שיא של גוף שחור<a class="headerlink" href="#id10" title="Link to this heading">#</a></h4>
<p>חוק וין קובע <span class="math notranslate nohighlight">\( \lambda_{\max} = \dfrac{b}{T} \)</span> עם קבוע <span class="math notranslate nohighlight">\(b\)</span> שנשלף מ־<code class="docutils literal notranslate"><span class="pre">physical_constants</span></code>. חישבנו את <span class="math notranslate nohighlight">\(\lambda_{\max}\)</span> עבור כמה טמפרטורות (חדר, נורה להט, שמש) והמרנו לננומטר לקבלת תחושת סדרי גודל. הדוגמה מראה כיצד לשלב קבועים סטנדרטיים עם חישובים וקטוריים — ובמקביל לחזק אינטואיציה: ככל שטמפרטורה גבוהה יותר, שיא הקרינה מוסת לכיוון אורכי גל קצרים יותר.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 4) Blackbody peak wavelength via Wien&#39;s law: λ_max = b / T (vectorized)</span>
<span class="n">T_bb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">300</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">5800</span><span class="p">])</span>                  <span class="c1"># K (room, hot, incandescent-ish, Sun ~5800 K)</span>
<span class="n">lambda_max_m</span> <span class="o">=</span> <span class="n">b_wien</span> <span class="o">/</span> <span class="n">T_bb</span>
<span class="n">lambda_max_nm</span> <span class="o">=</span> <span class="n">lambda_max_m</span> <span class="o">*</span> <span class="mf">1e9</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Blackbody peak wavelength (Wien&#39;s law):&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">Ti</span><span class="p">,</span> <span class="n">lam_m</span><span class="p">,</span> <span class="n">lam_nm</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">T_bb</span><span class="p">,</span> <span class="n">lambda_max_m</span><span class="p">,</span> <span class="n">lambda_max_nm</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  T = </span><span class="si">{</span><span class="n">Ti</span><span class="si">:</span><span class="s2">&gt;4.0f</span><span class="si">}</span><span class="s2"> K  -&gt;  λ_max ≈ </span><span class="si">{</span><span class="n">lam_m</span><span class="si">:</span><span class="s2">.3e</span><span class="si">}</span><span class="s2"> m  (~</span><span class="si">{</span><span class="n">lam_nm</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> nm)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Blackbody peak wavelength (Wien&#39;s law):
  T =  300 K  -&gt;  λ_max ≈ 9.659e-06 m  (~9659 nm)
  T = 1000 K  -&gt;  λ_max ≈ 2.898e-06 m  (~2898 nm)
  T = 3000 K  -&gt;  λ_max ≈ 9.659e-07 m  (~966 nm)
  T = 5800 K  -&gt;  λ_max ≈ 4.996e-07 m  (~500 nm)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="c-approx-dfrac-1-sqrt-varepsilon-0-mu-0">
<h3>5) בדיקת־שפיות: <span class="math notranslate nohighlight">\(c \approx \dfrac{1}{\sqrt{\varepsilon_0 \mu_0}}\)</span><a class="headerlink" href="#c-approx-dfrac-1-sqrt-varepsilon-0-mu-0" title="Link to this heading">#</a></h3>
<p>ב־EMT ידוע שבוואקום <span class="math notranslate nohighlight">\(c = \dfrac{1}{\sqrt{\varepsilon_0 \mu_0}}\)</span>. בדוגמה חישבנו את הצד הימני מקבועים פיזיקליים והשווינו למהירות האור <code class="docutils literal notranslate"><span class="pre">constants.c</span></code>. חישוב <strong>שגיאה יחסית</strong> קטן מאשש עקביות יחידות וערכים, ומהווה בדיקת־שפיות שימושית כשעובדים עם קבועים ממקורות שונים.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 5) Quick sanity check: c ≈ 1/sqrt(ε0 * μ0)</span>
<span class="n">c_from_eps_mu</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">epsilon0</span> <span class="o">*</span> <span class="n">mu0</span><span class="p">)</span>
<span class="n">rel_err</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">c_from_eps_mu</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span> <span class="o">/</span> <span class="n">c</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sanity check: c vs 1/sqrt(ε0 μ0)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  c_from_eps_mu = </span><span class="si">{</span><span class="n">c_from_eps_mu</span><span class="si">:</span><span class="s2">.6e</span><span class="si">}</span><span class="s2"> m/s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  relative error = </span><span class="si">{</span><span class="n">rel_err</span><span class="si">:</span><span class="s2">.3e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sanity check: c vs 1/sqrt(ε0 μ0)
  c_from_eps_mu = 2.997925e+08 m/s
  relative error = 5.967e-13
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div id="qNyzeKFahKbS" data-shufflequestions="False" data-shuffleanswers="True" data-preserveresponses="false" data-numquestions="1000000" data-maxwidth="600" style="border-radius: 10px; text-align: left"><style>
#qNyzeKFahKbS {
   --jq-multiple-choice-bg: #6f78ffff;
   --jq-mc-button-bg: #fafafa;
   --jq-mc-button-border: #e0e0e0e0;
   --jq-mc-button-inset-shadow: #555555;
   --jq-many-choice-bg: #f75c03ff;
   --jq-numeric-bg: #392061ff;
   --jq-numeric-input-bg: #c0c0c0;
   --jq-numeric-input-label: #101010;
   --jq-numeric-input-shadow: #999999;
   --jq-string-bg: #4c1a57;
   --jq-incorrect-color: #c80202;
   --jq-correct-color: #009113;
   --jq-text-color: #fafafa;
}

.Quiz {
    max-width: 600px;
    margin-top: 15px;
    margin-left: auto;
    margin-right: auto;
/*    margin-bottom: 15px;*/
/*    padding-bottom: 4px;*/
    padding-top: 4px;
    line-height: 1.1;
    font-size: 16pt;
    border-radius: inherit;
}

.QuizCode {
    font-size: 14pt;
    margin-top: 10px;
    margin-left: 20px;
    margin-right: 20px;
}

.QuizCode>pre {
    padding: 4px;
}

.Quiz code {
    background-color: lightgray;
    color: black;
}

.Quiz .QuizCode code {
    background-color: inherit;
    color: inherit;
}


.Quiz .MCButton code {
    background-color: inherit;
    color: inherit;
}

.MCButton .QuizCode {
    text-align: left;
}




.Answer {
    border-radius: inherit;
    display: grid;
    grid-gap: 10px;
    grid-template-columns: 1fr 1fr;
    margin: 10px 0;
}

@media only screen and (max-width:480px) {
    .Answer {
        grid-template-columns: 1fr;
    }

}

.Feedback {
    font-size: 16pt;
    text-align: center;
/*    min-height: 2em;*/
}

.Input {
    align: left;
    font-size: 20pt;
}

.Input-text {
    display: block;
    margin: 10px;
    color: inherit;
    width: unset;
    min-width: 140px;
    max-width: 93%;
    field-sizing: content;
    background-color: var(--jq-numeric-input-bg);
    color: var(--jq-text-color);
    padding: 5px;
    padding-left: 10px;
    font-family: inherit;
    font-size: 20px;
    font-weight: inherit;
    line-height: 20pt;
    border: none;
    border-radius: 0.2rem;
    transition: box-shadow 0.1s);
}

.Input-text:focus {
    /*outline: none;*/
    background-color: var(--jq-numeric-input-bg);
    box-shadow: 0.6rem 0.8rem 1.4rem -0.5rem var(--jq-numeric-input-shadow);
}

.MCButton {
    background: var(--jq-mc-button-bg);
    border: 1px solid var(--jq-mc-button-border);
    border-radius: inherit;
    color: #333333;
    padding: 10px;
    font-size: 16px;
    cursor: pointer;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
}

.MCButton p {
    color: inherit;
}

.MultipleChoiceQn {
    padding: 10px;
    background: var(--jq-multiple-choice-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.ManyChoiceQn {
    padding: 10px;
    background: var(--jq-many-choice-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.NumericQn {
    background: var(--jq-numeric-bg);
    border-radius: inherit;
    color: var(--jq-text-color);
    padding: 10px;
}

.NumericQn p {
    color: inherit;
}

.StringQn {
    background: var(--jq-string-bg);
    border-radius: inherit;
    color: var(--jq-text-color);
    padding: 10px;
}

.StringQn p {
    color: inherit;
}


.InpLabel {
    color: var(--jq-numeric-input-label);
    float: left;
    font-size: 15pt;
    line-height: 34px;
    margin-right: 10px;
}

.incorrect {
    color: var(--jq-incorrect-color);
}

.correct {
    color: var(--jq-correct-color);
}

.correctButton {
    /*
    background: var(--jq-correct-color);
   */
    animation: correct-anim 0.6s ease;
    animation-fill-mode: forwards;
    box-shadow: inset 0 0 5px var(--jq-mc-button-inset-shadow);
    color: var(--jq-text-color);
    /*outline: none;*/
}

.incorrectButton {
    animation: incorrect-anim 0.8s ease;
    animation-fill-mode: forwards;
    box-shadow: inset 0 0 5px var(--jq-mc-button-inset-shadow);
    color: var(--jq-text-color);
    /*outline: none;*/
}

@keyframes incorrect-anim {
    100% {
        background-color: var(--jq-incorrect-color);
    }
}

@keyframes correct-anim {
    100% {
        background-color: var(--jq-correct-color);
    }
}
</style></div><script type="application/javascript">var questionsqNyzeKFahKbS=[{"question": "\u05e0\u05ea\u05d5\u05df \u05d4\u05e7\u05d5\u05d3:<br><br>c = constants.c  # \u05de\u05d4\u05d9\u05e8\u05d5\u05ea \u05d4\u05d0\u05d5\u05e8 (m/s)<br>h = constants.h  # \u05e7\u05d1\u05d5\u05e2 \u05e4\u05dc\u05d0\u05e0\u05e7 (J\u00b7s)<br>kB = constants.Boltzmann # \u05e7\u05d1\u05d5\u05e2 \u05d1\u05d5\u05dc\u05e6\u05de\u05df (J/K)<br><br>\u05de\u05d4 \u05e0\u05db\u05d5\u05df \u05dc\u05d2\u05d1\u05d9 \u05d4\u05e9\u05d9\u05de\u05d5\u05e9 \u05d1-scIpy.constants?", "type": "many_choice", "answers": [{"answer": "\u05de\u05d0\u05e4\u05e9\u05e8 \u05d2\u05d9\u05e9\u05d4 \u05d9\u05e9\u05d9\u05e8\u05d4 \u05dc\u05e7\u05d1\u05d5\u05e2\u05d9\u05dd \u05e4\u05d9\u05d6\u05d9\u05e7\u05dc\u05d9\u05d9\u05dd \u05de\u05d5\u05db\u05e8\u05d9\u05dd \u05d1\u05d9\u05d7\u05d9\u05d3\u05d5\u05ea SI", "correct": true, "feedback": "\u05e0\u05db\u05d5\u05df! scipy.constants \u05db\u05d5\u05dc\u05dc \u05e7\u05d1\u05d5\u05e2\u05d9\u05dd \u05e4\u05d9\u05d6\u05d9\u05e7\u05dc\u05d9\u05d9\u05dd \u05de\u05e7\u05d5\u05d1\u05dc\u05d9\u05dd \u05db\u05de\u05d5 c, h, kB \u05d1\u05d9\u05d7\u05d9\u05d3\u05d5\u05ea \u05e1\u05d8\u05e0\u05d3\u05e8\u05d8\u05d9\u05d5\u05ea."}, {"answer": "\u05e0\u05d3\u05e8\u05e9 \u05dc\u05d4\u05de\u05d9\u05e8 \u05ea\u05de\u05d9\u05d3 \u05d0\u05ea \u05d4\u05e7\u05d1\u05d5\u05e2\u05d9\u05dd \u05dc\u05d9\u05d7\u05d9\u05d3\u05d5\u05ea \u05dc\u05d0\u05beSI (\u05db\u05de\u05d5 eV)", "correct": false, "feedback": "\u05dc\u05d0 \u05e0\u05db\u05d5\u05df \u2014 \u05d4\u05e7\u05d1\u05d5\u05e2\u05d9\u05dd \u05de\u05d5\u05d2\u05d3\u05e8\u05d9\u05dd \u05d1\u05d9\u05d7\u05d9\u05d3\u05d5\u05ea SI \u05db\u05d1\u05e8\u05d9\u05e8\u05ea \u05de\u05d7\u05d3\u05dc. \u05d4\u05de\u05e8\u05d4 \u05e0\u05d3\u05e8\u05e9\u05ea \u05e8\u05e7 \u05d0\u05dd \u05e8\u05d5\u05e6\u05d9\u05dd \u05d9\u05d7\u05d9\u05d3\u05d5\u05ea \u05d0\u05d7\u05e8\u05d5\u05ea."}, {"answer": "\u05d4\u05e7\u05d1\u05d5\u05e2\u05d9\u05dd \u05de\u05d9\u05d5\u05e6\u05e8\u05d9\u05dd \u05d0\u05e7\u05e8\u05d0\u05d9\u05ea \u05d1\u05db\u05dc \u05e8\u05d9\u05e6\u05d4 \u05d5\u05dc\u05db\u05df \u05d0\u05d9\u05e0\u05dd \u05de\u05ea\u05d0\u05d9\u05de\u05d9\u05dd \u05dc\u05e9\u05d9\u05de\u05d5\u05e9 \u05de\u05d3\u05e2\u05d9", "correct": false, "feedback": "\u05de\u05de\u05e9 \u05dc\u05d0 \u2014 \u05d4\u05e7\u05d1\u05d5\u05e2\u05d9\u05dd \u05e2\u05e8\u05db\u05d9\u05dd \u05e7\u05d1\u05d5\u05e2\u05d9\u05dd \u05dc\u05e4\u05d9 CODATA, \u05dc\u05d0 \u05d0\u05e7\u05e8\u05d0\u05d9\u05d9\u05dd."}, {"answer": "\u05d4\u05d2\u05d9\u05e9\u05d4 \u05dc\u05e7\u05d1\u05d5\u05e2\u05d9\u05dd \u05de\u05ea\u05d1\u05e6\u05e2\u05ea \u05d3\u05e8\u05da numpy \u05d5\u05dc\u05d0 \u05d3\u05e8\u05da scipy", "correct": false, "feedback": "\u05dc\u05d0 \u05e0\u05db\u05d5\u05df \u2014 numpy \u05dc\u05d0 \u05de\u05e1\u05e4\u05e7 \u05e7\u05d1\u05d5\u05e2\u05d9\u05dd \u05e4\u05d9\u05d6\u05d9\u05e7\u05dc\u05d9\u05d9\u05dd, \u05e8\u05e7 scipy.constants \u05e2\u05d5\u05e9\u05d4 \u05d6\u05d0\u05ea."}]}];

if (typeof Question === 'undefined') {
// Make a random ID
function makeid(length) {
    var result = [];
    var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
    var charactersLength = characters.length;
    for (var i = 0; i < length; i++) {
        result.push(characters.charAt(Math.floor(Math.random() * charactersLength)));
    }
    return result.join('');
}
// Convert LaTeX delimiters and markdown links to HTML
function jaxify(string) {
    let mystring = string;
    let count = 0, count2 = 0;
    let loc = mystring.search(/([^\\]|^)(\$)/);
    let loc2 = mystring.search(/([^\\]|^)(\$\$)/);
    while (loc >= 0 || loc2 >= 0) {
        if (loc2 >= 0) {
            mystring = mystring.replace(/([^\\]|^)(\$\$)/, count2 % 2 ? '$1\\]' : '$1\\[');
            count2++;
        } else {
            mystring = mystring.replace(/([^\\]|^)(\$)/, count % 2 ? '$1\\)' : '$1\\(');
            count++;
        }
        loc = mystring.search(/([^\\]|^)(\$)/);
        loc2 = mystring.search(/([^\\]|^)(\$\$)/);
    }
    // Replace markdown links
    mystring = mystring.replace(/<http(.*?)>/g, '<a href="http$1" target="_blank" class="Link">http$1</a>');
    mystring = mystring.replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2" target="_blank" class="Link">$1</a>');
    return mystring;
}

// Base class for question types
class Question {
    static registry = {};
    static register(type, cls) {
        Question.registry[type] = cls;
    }
    static create(qa, id, index, options, rootDiv) {
        const Cls = Question.registry[qa.type];
        if (!Cls) {
            console.error(`No question class registered for type "${qa.type}"`);
            return;
        }
        const q = new Cls(qa, id, index, options, rootDiv);
        q.render();
    }

    constructor(qa, id, index, options, rootDiv) {
        this.qa = qa;
        this.id = id;
        this.index = index;
        this.options = options;
        this.rootDiv = rootDiv;
        // wrapper
        this.wrapper = document.createElement('div');
        this.wrapper.id = `quizWrap${id}`;
        this.wrapper.className = 'Quiz';
        this.wrapper.dataset.qnum = index;
        this.wrapper.style.maxWidth = `${options.maxWidth}px`;
        rootDiv.appendChild(this.wrapper);
        // question container
        this.outerqDiv = document.createElement('div');
        this.outerqDiv.id = `OuterquizQn${id}${index}`;
        this.wrapper.appendChild(this.outerqDiv);
        // question text
        this.qDiv = document.createElement('div');
        this.qDiv.id = `quizQn${id}${index}`;
        if (qa.question) {
            this.qDiv.innerHTML = jaxify(qa.question);
            this.outerqDiv.appendChild(this.qDiv);
        }
        // code block
        if (qa.code) {
            const codeDiv = document.createElement('div');
            codeDiv.id = `code${id}${index}`;
            codeDiv.className = 'QuizCode';
            const pre = document.createElement('pre');
            const codeEl = document.createElement('code');
            codeEl.innerHTML = qa.code;
            pre.appendChild(codeEl);
            codeDiv.appendChild(pre);
            this.outerqDiv.appendChild(codeDiv);
        }
        // answer container
        this.aDiv = document.createElement('div');
        this.aDiv.id = `quizAns${id}${index}`;
        this.aDiv.className = 'Answer';
        this.wrapper.appendChild(this.aDiv);
        // feedback container (append after answers)
        this.fbDiv = document.createElement('div');
        this.fbDiv.id = `fb${id}`;
        this.fbDiv.className = 'Feedback';
        this.fbDiv.dataset.answeredcorrect = 0;
    }

    render() {
        throw new Error('render() not implemented');
    }

    preserveResponse(val) {
        if (!this.options.preserveResponses) return;
        const resp = document.getElementById(`responses${this.rootDiv.id}`);
        if (!resp) return;
        const arr = JSON.parse(resp.dataset.responses);
        arr[this.index] = val;
        resp.dataset.responses = JSON.stringify(arr);
        printResponses(resp);
    }

    typeset(container) {
        if (typeof MathJax !== 'undefined') {
            const v = MathJax.version;
            if (v[0] === '2') {
                MathJax.Hub.Queue(['Typeset', MathJax.Hub]);
            } else {
                MathJax.typeset([container]);
            }
        }
    }
}

// Choose a random subset of an array. Can also be used to shuffle the array
function getRandomSubarray(arr, size) {
    var shuffled = arr.slice(0), i = arr.length, temp, index;
    while (i--) {
        index = Math.floor((i + 1) * Math.random());
        temp = shuffled[index];
        shuffled[index] = shuffled[i];
        shuffled[i] = temp;
    }
    return shuffled.slice(0, size);
}

function printResponses(responsesContainer) {
    var responses=JSON.parse(responsesContainer.dataset.responses);
    var stringResponses='<B>IMPORTANT!</B>To preserve this answer sequence for submission, when you have finalized your answers: <ol> <li> Copy the text in this cell below "Answer String"</li> <li> Double click on the cell directly below the Answer String, labeled "Replace Me"</li> <li> Select the whole "Replace Me" text</li> <li> Paste in your answer string and press shift-Enter.</li><li>Save the notebook using the save icon or File->Save Notebook menu item</li></ul><br><br><br><b>Answer String:</b><br> ';
    console.log(responses);
    responses.forEach((response, index) => {
        if (response) {
            console.log(index + ': ' + response);
            stringResponses+= index + ': ' + response +"<BR>";
        }
    });
    responsesContainer.innerHTML=stringResponses;
}
/* Callback function to determine whether a selected multiple-choice
   button corresponded to a correct answer and to provide feedback
   based on the answer */
function check_mc() {
    var id = this.id.split('-')[0];
    //var response = this.id.split('-')[1];
    //console.log(response);
    //console.log("In check_mc(), id="+id);
    //console.log(event.srcElement.id)           
    //console.log(event.srcElement.dataset.correct)   
    //console.log(event.srcElement.dataset.feedback)

    var label = event.srcElement;
    //console.log(label, label.nodeName);
    var depth = 0;
    while ((label.nodeName != "LABEL") && (depth < 20)) {
        label = label.parentElement;
        console.log(depth, label);
        depth++;
    }



    var answers = label.parentElement.children;
    //console.log(answers);

    // Split behavior based on multiple choice vs many choice:
    var fb = document.getElementById("fb" + id);



    /* Multiple choice (1 answer). Allow for 0 correct
       answers as an edge case */
    if (fb.dataset.numcorrect <= 1) {
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            responses[qnum]= response;
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses

        for (var i = 0; i < answers.length; i++) {
            var child = answers[i];
            //console.log(child);
            child.className = "MCButton";
        }



        if (label.dataset.correct == "true") {
            // console.log("Correct action");
            if ("feedback" in label.dataset) {
                fb.innerHTML = jaxify(label.dataset.feedback);
            } else {
                fb.innerHTML = "Correct!";
            }
            label.classList.add("correctButton");

            fb.className = "Feedback";
            fb.classList.add("correct");

        } else {
            if ("feedback" in label.dataset) {
                fb.innerHTML = jaxify(label.dataset.feedback);
            } else {
                fb.innerHTML = "Incorrect -- try again.";
            }
            //console.log("Error action");
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
    }
    else { /* Many choice (more than 1 correct answer) */
        var reset = false;
        var feedback;
         if (label.dataset.correct == "true") {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Correct!";
            }
            if (label.dataset.answered <= 0) {
                if (fb.dataset.answeredcorrect < 0) {
                    fb.dataset.answeredcorrect = 1;
                    reset = true;
                } else {
                    fb.dataset.answeredcorrect++;
                }
                if (reset) {
                    for (var i = 0; i < answers.length; i++) {
                        var child = answers[i];
                        child.className = "MCButton";
                        child.dataset.answered = 0;
                    }
                }
                label.classList.add("correctButton");
                label.dataset.answered = 1;
                fb.className = "Feedback";
                fb.classList.add("correct");

            }
        } else {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Incorrect -- try again.";
            }
            if (fb.dataset.answeredcorrect > 0) {
                fb.dataset.answeredcorrect = -1;
                reset = true;
            } else {
                fb.dataset.answeredcorrect--;
            }

            if (reset) {
                for (var i = 0; i < answers.length; i++) {
                    var child = answers[i];
                    child.className = "MCButton";
                    child.dataset.answered = 0;
                }
            }
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            if (label.dataset.correct == "true") {
                if (typeof(responses[qnum]) == "object"){
                    if (!responses[qnum].includes(response))
                        responses[qnum].push(response);
                } else{
                    responses[qnum]= [ response ];
                }
            } else {
                responses[qnum]= response;
            }
            console.log(responses);
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End save responses stuff



        var numcorrect = fb.dataset.numcorrect;
        var answeredcorrect = fb.dataset.answeredcorrect;
        if (answeredcorrect >= 0) {
            fb.innerHTML = feedback + " [" + answeredcorrect + "/" + numcorrect + "]";
        } else {
            fb.innerHTML = feedback + " [" + 0 + "/" + numcorrect + "]";
        }


    }

    if (typeof MathJax != 'undefined') {
        var version = MathJax.version;
        console.log('MathJax version', version);
        if (version[0] == "2") {
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        } else if (version[0] == "3") {
            MathJax.typeset([fb]);
        }
    } else {
        console.log('MathJax not detected');
    }

}


/* Function to produce the HTML buttons for a multiple choice/
   many choice question  and to update the CSS tags based on
   the question type */
function make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id) {

    var shuffled;
    if (shuffle_answers == true) {
        //console.log(shuffle_answers+" read as true");
        shuffled = getRandomSubarray(qa.answers, qa.answers.length);
    } else {
        //console.log(shuffle_answers+" read as false");
        shuffled = qa.answers;
    }


    var num_correct = 0;

    shuffled.forEach((item, index, ans_array) => {
        //console.log(answer);

        // Make input element
        var inp = document.createElement("input");
        inp.type = "radio";
        inp.id = "quizo" + id + index;
        inp.style = "display:none;";
        aDiv.append(inp);

        //Make label for input element
        var lab = document.createElement("label");
        lab.className = "MCButton";
        lab.id = id + '-' + index;
        lab.onclick = check_mc;
        var aSpan = document.createElement('span');
        aSpan.classsName = "";
        //qDiv.id="quizQn"+id+index;
        if ("answer" in item) {
            aSpan.innerHTML = jaxify(item.answer);
            //aSpan.innerHTML=item.answer;
        }
        lab.append(aSpan);

        // Create div for code inside question
        var codeSpan;
        if ("code" in item) {
            codeSpan = document.createElement('span');
            codeSpan.id = "code" + id + index;
            codeSpan.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeSpan.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = item.code;
            lab.append(codeSpan);
            //console.log(codeSpan);
        }

        //lab.textContent=item.answer;

        // Set the data attributes for the answer
        lab.setAttribute('data-correct', item.correct);
        if (item.correct) {
            num_correct++;
        }
        if ("feedback" in item) {
            lab.setAttribute('data-feedback', item.feedback);
        }
        lab.setAttribute('data-answered', 0);

        aDiv.append(lab);

    });

    if (num_correct > 1) {
        outerqDiv.className = "ManyChoiceQn";
    } else {
        outerqDiv.className = "MultipleChoiceQn";
    }

    return num_correct;

}
// Object-oriented wrapper for MC/MANY choice
class MCQuestion extends Question {
    constructor(qa, id, idx, opts, rootDiv) { super(qa, id, idx, opts, rootDiv); }
    render() {
        //console.log("options.shuffleAnswers " + this.options.shuffleAnswers);
        const numCorrect = make_mc(
            this.qa,
            this.options.shuffleAnswers,
            this.outerqDiv,
            this.qDiv,
            this.aDiv,
            this.id
        );
        if ('answer_cols' in this.qa) {
            this.aDiv.style.gridTemplateColumns =
                'repeat(' + this.qa.answer_cols + ', 1fr)';
        }
        this.fbDiv.dataset.numcorrect = numCorrect;
        this.wrapper.appendChild(this.fbDiv);
    }
}
Question.register('multiple_choice', MCQuestion);
Question.register('many_choice', MCQuestion);
function check_numeric(ths, event) {

    if (event.keyCode === 13) {
        ths.blur();

        var id = ths.id.split('-')[0];

        var submission = ths.value;
        if (submission.indexOf('/') != -1) {
            var sub_parts = submission.split('/');
            //console.log(sub_parts);
            submission = sub_parts[0] / sub_parts[1];
        }
        //console.log("Reader entered", submission);

        if ("precision" in ths.dataset) {
            var precision = ths.dataset.precision;
            submission = Number(Number(submission).toPrecision(precision));
        }


        //console.log("In check_numeric(), id="+id);
        //console.log(event.srcElement.id)           
        //console.log(event.srcElement.dataset.feedback)

        var fb = document.getElementById("fb" + id);
        fb.style.display = "none";
        fb.innerHTML = "Incorrect -- try again.";

        var answers = JSON.parse(ths.dataset.answers);
        //console.log(answers);

        var defaultFB = "Incorrect. Try again.";
        var correct;
        var done = false;
        answers.every(answer => {
            //console.log(answer.type);

            correct = false;
            // if (answer.type=="value"){
            if ('value' in answer) {
                var value;
                if ("precision" in ths.dataset) {
                    value = answer.value.toPrecision(ths.dataset.precision);
                } else {
                    value = answer.value;
                }
                if (submission == value) {
                    if ("feedback" in answer) {
                        fb.innerHTML = jaxify(answer.feedback);
                    } else {
                        fb.innerHTML = jaxify("Correct");
                    }
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }

                // } else if (answer.type=="range") {
            } else if ('range' in answer) {
                console.log(answer.range);
                console.log(submission, submission >=answer.range[0], submission < answer.range[1])
                if ((submission >= answer.range[0]) && (submission < answer.range[1])) {
                    fb.innerHTML = jaxify(answer.feedback);
                    correct = answer.correct;
                    console.log(answer.correct);
                    done = true;
                }
            } else if (answer.type == "default") {
                if ("feedback" in answer) {
                    defaultFB = answer.feedback;
                } 
            }
            if (done) {
                return false; // Break out of loop if this has been marked correct
            } else {
                return true; // Keep looking for case that includes this as a correct answer
            }
        });
        console.log("done:", done);

        if ((!done) && (defaultFB != "")) {
            fb.innerHTML = jaxify(defaultFB);
            //console.log("Default feedback", defaultFB);
        }

        fb.style.display = "block";
        if (correct) {
            ths.className = "Input-text";
            ths.classList.add("correctButton");
            fb.className = "Feedback";
            fb.classList.add("correct");
        } else {
            ths.className = "Input-text";
            ths.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }

        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            console.log(submission);
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            //console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            if (submission == ths.value){
                responses[qnum]= submission;
            } else {
                responses[qnum]= ths.value + "(" + submission +")";
            }
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses

        if (typeof MathJax != 'undefined') {
            var version = MathJax.version;
            console.log('MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([fb]);
            }
        } else {
            console.log('MathJax not detected');
        }
        // After correct answer, if next JupyterQuiz question exists and has a text input, scroll by current question height
        if (correct) {
            // find the current question wrapper
            var wrapper = ths.closest('.Quiz');
            if (wrapper) {
                var nextWrapper = wrapper.nextElementSibling;
                if (nextWrapper && nextWrapper.classList.contains('Quiz')) {
                    var nextInput = nextWrapper.querySelector('input.Input-text');
                    if (nextInput) {
                        var height = wrapper.getBoundingClientRect().height;
                        console.log(height);
                        nextInput.focus();
                    }
                }
            }
        }
        return false;
    }

}
// Object-oriented wrapper for numeric questions
class NumericQuestion extends Question {
    constructor(qa, id, idx, opts, rootDiv) {
        super(qa, id, idx, opts, rootDiv);
    }
    render() {
        make_numeric(this.qa, this.outerqDiv, this.qDiv, this.aDiv, this.id);
        this.wrapper.appendChild(this.fbDiv);
    }
}
Question.register('numeric', NumericQuestion);

function isValid(el, charC) {
    //console.log("Input char: ", charC);
    if (charC == 46) {
        if (el.value.indexOf('.') === -1) {
            return true;
        } else if (el.value.indexOf('/') != -1) {
            var parts = el.value.split('/');
            if (parts[1].indexOf('.') === -1) {
                return true;
            }
        }
        else {
            return false;
        }
    } else if (charC == 47) {
        if (el.value.indexOf('/') === -1) {
            if ((el.value != "") && (el.value != ".")) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else if (charC == 45) {
        var edex = el.value.indexOf('e');
        if (edex == -1) {
            edex = el.value.indexOf('E');
        }

        if (el.value == "") {
            return true;
        } else if (edex == (el.value.length - 1)) { // If just after e or E
            return true;
        } else {
            return false;
        }
    } else if (charC == 101) { // "e"
        if ((el.value.indexOf('e') === -1) && (el.value.indexOf('E') === -1) && (el.value.indexOf('/') == -1)) {
            // Prev symbol must be digit or decimal point:
            if (el.value.slice(-1).search(/\d/) >= 0) {
                return true;
            } else if (el.value.slice(-1).search(/\./) >= 0) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else {
        if (charC > 31 && (charC < 48 || charC > 57))
            return false;
    }
    return true;
}

function numeric_keypress(evnt) {
    var charC = (evnt.which) ? evnt.which : evnt.keyCode;

    if (charC == 13) {
        check_numeric(this, evnt);
    } else {
        return isValid(this, charC);
    }
}





function make_numeric(qa, outerqDiv, qDiv, aDiv, id) {



    //console.log(answer);


    outerqDiv.className = "NumericQn";
    aDiv.style.display = 'block';

    var lab = document.createElement("label");
    lab.className = "InpLabel";
    lab.innerHTML = "Type numeric answer here:";
    aDiv.append(lab);

    var inp = document.createElement("input");
    inp.type = "text";
    //inp.id="input-"+id;
    inp.id = id + "-0";
    inp.className = "Input-text";
    inp.setAttribute('data-answers', JSON.stringify(qa.answers));
    if ("precision" in qa) {
        inp.setAttribute('data-precision', qa.precision);
    }
    aDiv.append(inp);
    //console.log(inp);

    //inp.addEventListener("keypress", check_numeric);
    //inp.addEventListener("keypress", numeric_keypress);
    /*
    inp.addEventListener("keypress", function(event) {
        return numeric_keypress(this, event);
    }
                        );
                        */
    //inp.onkeypress="return numeric_keypress(this, event)";
    inp.onkeypress = numeric_keypress;
    inp.onpaste = event => false;

    inp.addEventListener("focus", function (event) {
        this.value = "";
        return false;
    }
    );


}
// Override show_questions to use object-oriented Question API
function show_questions(json, container) {
    // Accept container element or element ID
    if (typeof container === 'string') {
        container = document.getElementById(container);
    }
    if (!container) {
        console.error('show_questions: invalid container', container);
        return;
    }

    const shuffleQuestions = container.dataset.shufflequestions === 'True';
    const shuffleAnswers = container.dataset.shuffleanswers === 'True';
    const preserveResponses = container.dataset.preserveresponses === 'true';
    const maxWidth = parseInt(container.dataset.maxwidth, 10) || 0;
    let numQuestions = parseInt(container.dataset.numquestions, 10) || json.length;
    if (numQuestions > json.length) numQuestions = json.length;

    let questions = json;
    if (shuffleQuestions || numQuestions < json.length) {
        questions = getRandomSubarray(json, numQuestions);
    }

    questions.forEach((qa, index) => {
        const id = makeid(8);
        const options = {
            shuffleAnswers: shuffleAnswers,
            preserveResponses: preserveResponses,
            maxWidth: maxWidth
        };
        Question.create(qa, id, index, options, container);
    });

    if (preserveResponses) {
        const respDiv = document.createElement('div');
        respDiv.id = 'responses' + container.id;
        respDiv.className = 'JCResponses';
        respDiv.dataset.responses = JSON.stringify([]);
        respDiv.innerHTML = '<b>Select your answers and then follow the directions that will appear here.</b>';
        container.appendChild(respDiv);
    }

    // Trigger MathJax typesetting if available
    if (typeof MathJax != 'undefined') {
        console.log("MathJax version", MathJax.version);
        var version = MathJax.version;
        setTimeout(function(){
            var version = MathJax.version;
            console.log('After sleep, MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                if (MathJax.hasOwnProperty('typeset') ) {
                    MathJax.typeset([container]);
                } else {
                    console.log('WARNING: Trying to force load MathJax 3');
                    window.MathJax = {
                        tex: {
                            inlineMath: [['$', '$'], ['\\(', '\\)']]
                        },
                        svg: {
                            fontCache: 'global'
                        }
                    };

                    (function () {
                        var script = document.createElement('script');
                        script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js';
                        script.async = true;
                        document.head.appendChild(script);
                    })();
                }
            }
        }, 500);
if (typeof version == 'undefined') {
        } else
        {
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                if (MathJax.hasOwnProperty('typeset') ) {
                    MathJax.typeset([container]);
                } else {
                    console.log('WARNING: Trying to force load MathJax 3');
                    window.MathJax = {
                        tex: {
                            inlineMath: [['$', '$'], ['\\(', '\\)']]
                        },
                        svg: {
                            fontCache: 'global'
                        }
                    };

                    (function () {
                        var script = document.createElement('script');
                        script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js';
                        script.async = true;
                        document.head.appendChild(script);
                    })();
                }
            } else {
                console.log("MathJax not found");
            }
        }
    }
    // if (typeof MathJax !== 'undefined') {
    //     const v = MathJax.version;
    //     if (v[0] === '2') {
    //         MathJax.Hub.Queue(['Typeset', MathJax.Hub]);
    //     } else if (v[0] === '3') {
    //         MathJax.typeset([container]);
    //     }
    // }

    // Prevent link clicks from bubbling up
    Array.from(container.getElementsByClassName('Link')).forEach(link => {
        link.addEventListener('click', e => e.stopPropagation());
    });
}
function levenshteinDistance(a, b) {
    if (a.length === 0) return b.length;
    if (b.length === 0) return a.length;

    const matrix = Array(b.length + 1).fill(null).map(() => Array(a.length + 1).fill(null));

    for (let i = 0; i <= a.length; i++) {
        matrix[0][i] = i;
    }

    for (let j = 0; j <= b.length; j++) {
        matrix[j][0] = j;
    }

    for (let j = 1; j <= b.length; j++) {
        for (let i = 1; i <= a.length; i++) {
            const cost = a[i - 1] === b[j - 1] ? 0 : 1;
            matrix[j][i] = Math.min(
                matrix[j - 1][i] + 1, // Deletion
                matrix[j][i - 1] + 1, // Insertion
                matrix[j - 1][i - 1] + cost // Substitution
            );
        }
    }
    return matrix[b.length][a.length];
}
// Object-oriented wrapper for string input questions
class StringQuestion extends Question {
    constructor(qa, id, idx, opts, rootDiv) {
        super(qa, id, idx, opts, rootDiv);
    }
    render() {
        make_string(this.qa, this.outerqDiv, this.qDiv, this.aDiv, this.id);
        this.wrapper.appendChild(this.fbDiv);
    }
}
Question.register('string', StringQuestion);

function check_string(ths, event) {
    if (event.keyCode === 13) {
        ths.blur();

        var id = ths.id.split('-')[0];
        var submission = ths.value.trim();
        var fb = document.getElementById("fb" + id);
        fb.style.display = "none";
        fb.innerHTML = "Incorrect -- try again.";

        var answers = JSON.parse(ths.dataset.answers);
        var defaultFB = "Incorrect. Try again.";
        var correct;
        var done = false;

        // Handle default answer pattern: filter out and capture default feedback
        var filteredAnswers = [];
        answers.forEach(answer => {
            if (answer.type === "default") {
                defaultFB = answer.feedback;
            } else {
                filteredAnswers.push(answer);
            }
        });
        answers = filteredAnswers;

        answers.every(answer => {
            correct = false;

            let match = false;
            if (answer.match_case) {
                match = submission === answer.answer;
            } else {
                match = submission.toLowerCase() === answer.answer.toLowerCase();
            }
            console.log(submission);
            console.log(answer.answer);
            console.log(match);

            if (match) {
                if ("feedback" in answer) {
                    fb.innerHTML = jaxify(answer.feedback);
                } else {
                    fb.innerHTML = jaxify("Correct");
                }
                correct = answer.correct;
                done = true;
            } else if (answer.fuzzy_threshold) {
                var max_length = Math.max(submission.length, answer.answer.length);
                var ratio;
                if (answer.match_case) {
                    ratio = 1- (levenshteinDistance(submission, answer.answer) / max_length);
                } else {
                    ratio = 1- (levenshteinDistance(submission.toLowerCase(),
                                                    answer.answer.toLowerCase()) / max_length);
                }
                if (ratio >= answer.fuzzy_threshold) {
                    if ("feedback" in answer) {
                        fb.innerHTML = jaxify("(Fuzzy) " + answer.feedback);
                    } else {
                        fb.innerHTML = jaxify("Correct");
                    }
                    correct = answer.correct;
                    done = true;
                }

            }

            if (done) {
                return false;
            } else {
                return true;
            }
        });

        if ((!done) && (defaultFB != "")) {
            fb.innerHTML = jaxify(defaultFB);
        }

        fb.style.display = "block";
        if (correct) {
            ths.className = "Input-text";
            ths.classList.add("correctButton");
            fb.className = "Feedback";
            fb.classList.add("correct");
        } else {
            ths.className = "Input-text";
            ths.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }

        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            var qnum = document.getElementById("quizWrap" + id).dataset.qnum;
            var responses = JSON.parse(responsesContainer.dataset.responses);
            responses[qnum] = submission;
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }

        if (typeof MathJax != 'undefined') {
            var version = MathJax.version;
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([fb]);
            }
        } else {
            console.log('MathJax not detected');
        }
        // After correct answer, if next JupyterQuiz question exists and has a text input, scroll by current question height
        if (correct) {
            var wrapper = ths.closest('.Quiz');
            if (wrapper) {
                var nextWrapper = wrapper.nextElementSibling;
                if (nextWrapper && nextWrapper.classList.contains('Quiz')) {
                    var nextInput = nextWrapper.querySelector('input.Input-text');
                    if (nextInput) {
                        var height = wrapper.getBoundingClientRect().height;
                        nextInput.focus();
                    }
                }
            }
        }
        return false;
    }
}

function string_keypress(evnt) {
    var charC = (evnt.which) ? evnt.which : evnt.keyCode;

    if (charC == 13) {
        check_string(this, evnt);
    } 
}


function make_string(qa, outerqDiv, qDiv, aDiv, id) {
    outerqDiv.className = "StringQn";
    aDiv.style.display = 'block';

    var lab = document.createElement("label");
    lab.className = "InpLabel";
    lab.innerHTML = "Type your answer here:";
    aDiv.append(lab);

    var inp = document.createElement("input");
    inp.type = "text";
    inp.id = id + "-0";
    inp.className = "Input-text";
    inp.setAttribute('data-answers', JSON.stringify(qa.answers));
    // Apply optional input width (approx. number of characters, in em units)
    if (qa.input_width != null) {
        inp.style['min-width'] = qa.input_width + 'em';
    }
    aDiv.append(inp);

    inp.onkeypress = string_keypress;
    inp.onpaste = event => false;

    inp.addEventListener("focus", function (event) {
        this.value = "";
        return false;
    });
}
/*
 * Handle asynchrony issues when re-running quizzes in Jupyter notebooks.
 * Ensures show_questions is called after the container div is in the DOM.
 */
function try_show() {
  if (document.getElementById("qNyzeKFahKbS")) {
    show_questions(questionsqNyzeKFahKbS, qNyzeKFahKbS);
  } else {
    setTimeout(try_show, 200);
  }
};
// Invoke immediately
{
  try_show();
}
}
</script></div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="markdown">
<h1>%% [markdown]<a class="headerlink" href="#markdown" title="Link to this heading">#</a></h1>
<section id="id11">
<h2>שאלות רב־ברירה<a class="headerlink" href="#id11" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>היכן נמצא <span class="math notranslate nohighlight">\(k_B\)</span>?<br />
A. <code class="docutils literal notranslate"><span class="pre">numpy.constants.kB</span></code><br />
B. <code class="docutils literal notranslate"><span class="pre">scipy.constants.Boltzmann</span></code><br />
C. <code class="docutils literal notranslate"><span class="pre">scipy.constants.k</span></code><br />
D. <code class="docutils literal notranslate"><span class="pre">math.constants.kB</span></code></p></li>
<li><p>מהי וקטוריזציה?<br />
A. חישוב רק עבור וקטורים מאורך 3<br />
B. שימוש ב־for כפול בלולאה<br />
C. ביצוע פעולות על מערכים שלמים ללא לולאות פייתון<br />
D. שימוש ב־<code class="docutils literal notranslate"><span class="pre">vector</span></code> ממודול <code class="docutils literal notranslate"><span class="pre">collections</span></code></p></li>
</ol>
</section>
<section id="id12">
<h2>איור (סקיצה)<a class="headerlink" href="#id12" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>תרשים סכמטי של זרימת נתונים: מדידה → NumPy (עיבוד) → SciPy (ניתוח) → Matplotlib (הצגה).</p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id13">
<h1>%% [markdown]<a class="headerlink" href="#id13" title="Link to this heading">#</a></h1>
<section id="odes">
<h2>2. אינטגרציה וגזירה נומרית + ODEs<a class="headerlink" href="#odes" title="Link to this heading">#</a></h2>
<p><strong>אינטגרציה חד־ממדית:</strong> <code class="docutils literal notranslate"><span class="pre">integrate.quad</span></code> עבור <span class="math notranslate nohighlight">\(\int_a^b f(x)\,dx\)</span>.<br />
<strong>טרפזים/מצטבר:</strong> <code class="docutils literal notranslate"><span class="pre">numpy.trapz</span></code>, <code class="docutils literal notranslate"><span class="pre">scipy.integrate.cumtrapz</span></code> כדגמים פשוטים.<br />
<strong>משוואות דיפרנציאליות רגילות (ODE):</strong><br />
נפתור בעיה כללית <span class="math notranslate nohighlight">\( \dot{\mathbf{y}} = f(t,\mathbf{y}) \)</span> עם <code class="docutils literal notranslate"><span class="pre">solve_ivp</span></code>, ונראה דוגמת מתנד הרמוני <span class="math notranslate nohighlight">\( \ddot{x} + \omega^2 x = 0 \)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %%</span>
<span class="c1"># Numeric integration: quad vs trapz</span>
<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Gaussian</span>

<span class="n">I_quad</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>  <span class="c1"># integral from 0 to infinity</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">I_trapz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span> <span class="n">xs</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;quad integral ~&quot;</span><span class="p">,</span> <span class="n">I_quad</span><span class="p">,</span> <span class="s2">&quot;estimated error ~&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;trapz integral ~&quot;</span><span class="p">,</span> <span class="n">I_trapz</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>quad integral ~ 0.8862269254527579 estimated error ~ 7.10131839047246e-09
trapz integral ~ 0.8862269117883661
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_24100/2073085679.py:7: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  I_trapz = np.trapz(f(xs), xs)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %%</span>
<span class="c1"># ODE: simple harmonic oscillator x&#39;&#39; + w^2 x = 0</span>
<span class="n">w</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>  <span class="c1"># rad/s</span>

<span class="k">def</span><span class="w"> </span><span class="nf">sho</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="c1"># y = [x, v]</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">y</span>
    <span class="n">dxdt</span> <span class="o">=</span> <span class="n">v</span>
    <span class="n">dvdt</span> <span class="o">=</span> <span class="o">-</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">dxdt</span><span class="p">,</span> <span class="n">dvdt</span><span class="p">]</span>

<span class="n">t_span</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>        <span class="c1"># seconds</span>
<span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>          <span class="c1"># initial displacement 1, zero velocity</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">solve_ivp</span><span class="p">(</span><span class="n">sho</span><span class="p">,</span> <span class="n">t_span</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">dense_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_step</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">t_span</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">sol</span><span class="p">(</span><span class="n">t</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;מתנד הרמוני: $x&#39;&#39;+\omega^2 x=0$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;t (s)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;x (m)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ed597a76b0c31553a00141d663df49ad20c206005d9d5d09ba217145709c6695.png" src="_images/ed597a76b0c31553a00141d663df49ad20c206005d9d5d09ba217145709c6695.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id14">
<h1>%% [markdown]<a class="headerlink" href="#id14" title="Link to this heading">#</a></h1>
<section id="id15">
<h2>שאלות רב־ברירה<a class="headerlink" href="#id15" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>איזו פונקציה תחשב <span class="math notranslate nohighlight">\(\int_0^\infty e^{-x^2}\,dx\)</span> בדיוק נומרי טוב?<br />
A. <code class="docutils literal notranslate"><span class="pre">np.sum</span></code><br />
B. <code class="docutils literal notranslate"><span class="pre">integrate.quad</span></code><br />
C. <code class="docutils literal notranslate"><span class="pre">np.mean</span></code><br />
D. <code class="docutils literal notranslate"><span class="pre">fft.rfft</span></code></p></li>
<li><p>עבור <span class="math notranslate nohighlight">\(x''+\omega^2 x=0\)</span>, מה נשתמש בו ל־ODE?<br />
A. <code class="docutils literal notranslate"><span class="pre">optimize.minimize</span></code><br />
B. <code class="docutils literal notranslate"><span class="pre">interpolate.interp1d</span></code><br />
C. <code class="docutils literal notranslate"><span class="pre">integrate.solve_ivp</span></code><br />
D. <code class="docutils literal notranslate"><span class="pre">stats.linregress</span></code></p></li>
</ol>
</section>
<section id="id16">
<h2>איור (סקיצה)<a class="headerlink" href="#id16" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>שרטטו סכמת וקטור מצב <span class="math notranslate nohighlight">\(\mathbf{y}=[x,v]\)</span> והקשר בין נגזרות לזמן.</p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id17">
<h1>%% [markdown]<a class="headerlink" href="#id17" title="Link to this heading">#</a></h1>
<section id="id18">
<h2>3. אופטימיזציה, שורשים, והתאמת עקומות<a class="headerlink" href="#id18" title="Link to this heading">#</a></h2>
<p><strong>שורשים:</strong> <code class="docutils literal notranslate"><span class="pre">optimize.root_scalar</span></code> לאיתור <span class="math notranslate nohighlight">\(x\)</span> כך ש־<span class="math notranslate nohighlight">\(f(x)=0\)</span>.<br />
<strong>מינימום:</strong> <code class="docutils literal notranslate"><span class="pre">minimize_scalar</span></code> (חד־ממדי), <code class="docutils literal notranslate"><span class="pre">minimize</span></code> (רב־ממדי).<br />
<strong>התאמת עקומות ניסוי:</strong> <code class="docutils literal notranslate"><span class="pre">optimize.curve_fit</span></code> — התאמה לא־ליניארית לנתונים <span class="math notranslate nohighlight">\((x,y)\)</span> והפקת טבלת covariance להערכת אי־ודאות.</p>
<p>נציג התאמה לקו <span class="math notranslate nohighlight">\(y=ax+b\)</span> ונדגים הוצאת שגיאות על <span class="math notranslate nohighlight">\(a,b\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %%</span>
<span class="c1"># Root finding example: solve x*cos(x) = 0 near x ~ pi/2</span>
<span class="n">g</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">root_scalar</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">bracket</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;root near (0.1,2.0):&quot;</span><span class="p">,</span> <span class="n">root</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>

<span class="c1"># Curve fitting example: y = a*x + b</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">a_true</span><span class="p">,</span> <span class="n">b_true</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">a_true</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">b_true</span> <span class="o">+</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">linear_model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">b</span>

<span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">curve_fit</span><span class="p">(</span><span class="n">linear_model</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">a_hat</span><span class="p">,</span> <span class="n">b_hat</span> <span class="o">=</span> <span class="n">popt</span>
<span class="n">perr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">pcov</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimated a=</span><span class="si">{</span><span class="n">a_hat</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> ± </span><span class="si">{</span><span class="n">perr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, b=</span><span class="si">{</span><span class="n">b_hat</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> ± </span><span class="si">{</span><span class="n">perr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">linear_model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;fit&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Linear fit with curve_fit&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>root near (0.1,2.0): 1.5707963267948963
Estimated a=2.139 ± 0.050, b=0.459 ± 0.288
</pre></div>
</div>
<img alt="_images/c2ac4aedd0b753493e4a7fdae33f79e5e331923fda0fd0c62f2181fa536e0a30.png" src="_images/c2ac4aedd0b753493e4a7fdae33f79e5e331923fda0fd0c62f2181fa536e0a30.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id19">
<h1>%% [markdown]<a class="headerlink" href="#id19" title="Link to this heading">#</a></h1>
<section id="id20">
<h2>שאלות רב־ברירה<a class="headerlink" href="#id20" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>מה מחזירה <code class="docutils literal notranslate"><span class="pre">curve_fit</span></code> בנוסף לפרמטרים?<br />
A. מטריצת ג’ייקוביאן<br />
B. טבלת covariance של הפרמטרים<br />
C. גרף שיוריים<br />
D. שום דבר נוסף</p></li>
<li><p>למציאת <span class="math notranslate nohighlight">\(x\)</span> כך ש־<span class="math notranslate nohighlight">\(f(x)=0\)</span> במרווח ידוע, נעדיף:<br />
A. <code class="docutils literal notranslate"><span class="pre">root_scalar</span></code> עם <code class="docutils literal notranslate"><span class="pre">bracket=(a,b)</span></code><br />
B. <code class="docutils literal notranslate"><span class="pre">minimize</span></code><br />
C. <code class="docutils literal notranslate"><span class="pre">interp1d</span></code><br />
D. <code class="docutils literal notranslate"><span class="pre">rfft</span></code></p></li>
</ol>
</section>
<section id="id21">
<h2>איור (סקיצה)<a class="headerlink" href="#id21" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>סכימה של שיוריים <span class="math notranslate nohighlight">\(r_i=y_i - \hat{y}_i\)</span> והמשמעות שלהם בבדיקת איכות התאמה.</p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id22">
<h1>%% [markdown]<a class="headerlink" href="#id22" title="Link to this heading">#</a></h1>
<section id="id23">
<h2>4. אינטרפולציה והחלקה<a class="headerlink" href="#id23" title="Link to this heading">#</a></h2>
<p><strong>אינטרפולציה חד־ממדית:</strong> <code class="docutils literal notranslate"><span class="pre">interpolate.interp1d(x,</span> <span class="pre">y,</span> <span class="pre">kind='linear'|'cubic'|...)</span></code> — קירוב ערכים בין נקודות מדידה.<br />
<strong>Spline</strong>: <code class="docutils literal notranslate"><span class="pre">UnivariateSpline</span></code> מאפשר החלקה (smoothing) באמצעות פרמטר <span class="math notranslate nohighlight">\(s\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %%</span>
<span class="c1"># Interpolation demo</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">f_lin</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">)</span>
<span class="n">f_cub</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;cubic&quot;</span><span class="p">)</span>

<span class="n">xf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;samples&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xf</span><span class="p">,</span> <span class="n">f_lin</span><span class="p">(</span><span class="n">xf</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xf</span><span class="p">,</span> <span class="n">f_cub</span><span class="p">(</span><span class="n">xf</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;cubic&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Interpolation: linear vs cubic&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/78fd09773dde268d85f23cdf0caa1c83a192d85daae00c2e71931f40df9fdd1c.png" src="_images/78fd09773dde268d85f23cdf0caa1c83a192d85daae00c2e71931f40df9fdd1c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %%</span>
<span class="c1"># Spline smoothing demo</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.4</span><span class="o">*</span><span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

<span class="n">spline</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">UnivariateSpline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>  <span class="c1"># smoothing parameter</span>
<span class="n">xf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;noisy samples&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xf</span><span class="p">,</span> <span class="n">spline</span><span class="p">(</span><span class="n">xf</span><span class="p">),</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;smoothed spline&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Smoothing with UnivariateSpline&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dabb686ac3c5dff7a464a1131ef3ac0c91e150373c4526647579c93b8b2fce8e.png" src="_images/dabb686ac3c5dff7a464a1131ef3ac0c91e150373c4526647579c93b8b2fce8e.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id24">
<h1>%% [markdown]<a class="headerlink" href="#id24" title="Link to this heading">#</a></h1>
<section id="id25">
<h2>שאלות רב־ברירה<a class="headerlink" href="#id25" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>איזה פרמטר ב־<code class="docutils literal notranslate"><span class="pre">UnivariateSpline</span></code> שולט על החלקה?<br />
A. <code class="docutils literal notranslate"><span class="pre">k</span></code><br />
B. <code class="docutils literal notranslate"><span class="pre">s</span></code><br />
C. <code class="docutils literal notranslate"><span class="pre">kind</span></code><br />
D. <code class="docutils literal notranslate"><span class="pre">bounds_error</span></code></p></li>
<li><p>באינטרפולציה קובית, <code class="docutils literal notranslate"><span class="pre">kind=</span></code> צריך להיות:<br />
A. <code class="docutils literal notranslate"><span class="pre">&quot;cubic&quot;</span></code><br />
B. <code class="docutils literal notranslate"><span class="pre">&quot;quadratic&quot;</span></code><br />
C. <code class="docutils literal notranslate"><span class="pre">&quot;spline&quot;</span></code><br />
D. <code class="docutils literal notranslate"><span class="pre">&quot;poly3&quot;</span></code></p></li>
</ol>
</section>
<section id="id26">
<h2>איור (סקיצה)<a class="headerlink" href="#id26" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>סכימה של דגימות בדידות, אינטרפולציה ליניארית לעומת קובית, והחלקת spline.</p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id27">
<h1>%% [markdown]<a class="headerlink" href="#id27" title="Link to this heading">#</a></h1>
<section id="fft">
<h2>5. עיבוד אותות ו-FFT<a class="headerlink" href="#fft" title="Link to this heading">#</a></h2>
<p><strong>FFT חד־צדדי:</strong> <code class="docutils literal notranslate"><span class="pre">fft.rfft</span></code> לאותים ממשיים; תדירויות ב־<code class="docutils literal notranslate"><span class="pre">fft.rfftfreq(N,</span> <span class="pre">d=1/fs)</span></code>.<br />
<strong>נייקוויסט:</strong> <span class="math notranslate nohighlight">\(f_N = \tfrac{f_s}{2}\)</span>.<br />
<strong>החלקה בסיסית:</strong> <code class="docutils literal notranslate"><span class="pre">signal.savgol_filter</span></code>.<br />
<strong>איתור פסגות:</strong> <code class="docutils literal notranslate"><span class="pre">signal.find_peaks</span></code>.</p>
<p>ננתח אות סינוס מרובע תדרים ועם רעש, נזהה פסגות תדר.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id28">
<h1>%% [markdown]<a class="headerlink" href="#id28" title="Link to this heading">#</a></h1>
<section id="id29">
<h2>5. עיבוד אותות ו-FFT<a class="headerlink" href="#id29" title="Link to this heading">#</a></h2>
<p><strong>FFT חד־צדדי:</strong> <code class="docutils literal notranslate"><span class="pre">fft.rfft</span></code> לאותים ממשיים; תדירויות ב־<code class="docutils literal notranslate"><span class="pre">fft.rfftfreq(N,</span> <span class="pre">d=1/fs)</span></code>.<br />
<strong>נייקוויסט:</strong> <span class="math notranslate nohighlight">\(f_N = \tfrac{f_s}{2}\)</span>.<br />
<strong>החלקה בסיסית:</strong> <code class="docutils literal notranslate"><span class="pre">signal.savgol_filter</span></code>.<br />
<strong>איתור פסגות:</strong> <code class="docutils literal notranslate"><span class="pre">signal.find_peaks</span></code>.</p>
<p>ננתח אות סינוס מרובע תדרים ועם רעש, נזהה פסגות תדר.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %%</span>
<span class="c1"># Signal + FFT + peak finding</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mf">500.0</span>  <span class="c1"># Hz</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">2.0</span>     <span class="c1"># seconds</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sig</span> <span class="o">=</span> <span class="mf">0.7</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">50</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">120</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.2</span><span class="o">*</span><span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

<span class="c1"># FFT</span>
<span class="n">yf</span> <span class="o">=</span> <span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>
<span class="n">ff</span> <span class="o">=</span> <span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
<span class="n">amp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">yf</span><span class="p">)</span><span class="o">/</span><span class="n">t</span><span class="o">.</span><span class="n">size</span>

<span class="c1"># Smooth time signal (optional)</span>
<span class="n">sig_smooth</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">savgol_filter</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">window_length</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span> <span class="n">polyorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Peak detection on spectrum</span>
<span class="n">peaks</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">(</span><span class="n">amp</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">amp</span><span class="p">)</span><span class="o">*</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">fig1</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;signal&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sig_smooth</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;smoothed&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Time signal&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;t (s)&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">fig2</span><span class="p">,</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ff</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;spectrum&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ff</span><span class="p">[</span><span class="n">peaks</span><span class="p">],</span> <span class="n">amp</span><span class="p">[</span><span class="n">peaks</span><span class="p">],</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;peaks&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;f (Hz)&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Amplitude&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Amplitude spectrum&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0449d256031b1aab2f55e45d9417120d9e81a796be5a29ea3f371a6f57fe148c.png" src="_images/0449d256031b1aab2f55e45d9417120d9e81a796be5a29ea3f371a6f57fe148c.png" />
<img alt="_images/21f503228d85cdc51062a070bf9895ce3242016fc5eff376762d80cd6727f4a9.png" src="_images/21f503228d85cdc51062a070bf9895ce3242016fc5eff376762d80cd6727f4a9.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id30">
<h1>%% [markdown]<a class="headerlink" href="#id30" title="Link to this heading">#</a></h1>
<section id="id31">
<h2>שאלות רב־ברירה<a class="headerlink" href="#id31" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>תדירות נייקוויסט היא:<br />
A. <span class="math notranslate nohighlight">\(f_s\)</span><br />
B. <span class="math notranslate nohighlight">\(2f_s\)</span><br />
C. <span class="math notranslate nohighlight">\(f_s/2\)</span><br />
D. <span class="math notranslate nohighlight">\(1/f_s\)</span></p></li>
<li><p>איזו פונקציה מתאימה לאיתור פסגות בספקטרום?<br />
A. <code class="docutils literal notranslate"><span class="pre">fft.rfft</span></code><br />
B. <code class="docutils literal notranslate"><span class="pre">signal.find_peaks</span></code><br />
C. <code class="docutils literal notranslate"><span class="pre">integrate.quad</span></code><br />
D. <code class="docutils literal notranslate"><span class="pre">stats.linregress</span></code></p></li>
</ol>
</section>
<section id="id32">
<h2>איור (סקיצה)<a class="headerlink" href="#id32" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>גרף סכמטי של דגימה בזמן וייצוגה בתחום התדר (FFT).</p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id33">
<h1>%% [markdown]<a class="headerlink" href="#id33" title="Link to this heading">#</a></h1>
<section id="id34">
<h2>6. אלגברה ליניארית מדעית<a class="headerlink" href="#id34" title="Link to this heading">#</a></h2>
<p>נפתור <span class="math notranslate nohighlight">\(A\mathbf{x}=\mathbf{b}\)</span>, ונחשב ערכים עצמיים/וקטורים עצמיים:</p>
<ul class="simple">
<li><p>פתרון מערכת: <code class="docutils literal notranslate"><span class="pre">linalg.solve(A,</span> <span class="pre">b)</span></code></p></li>
<li><p>ערכים עצמיים: <code class="docutils literal notranslate"><span class="pre">linalg.eig(A)</span></code> (כללי), <code class="docutils literal notranslate"><span class="pre">linalg.eigh(A)</span></code> (סימטרי/הרמי)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %%</span>
<span class="c1"># Linear system + eigenvalues/eigenvectors</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">9.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="n">w</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>     <span class="c1"># eigenvalues &amp; eigenvectors</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Solution x:&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Eigenvalues:&quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="c1"># V columns are eigenvectors</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solution x: [2. 3.]
Eigenvalues: [3.61803399+0.j 1.38196601+0.j]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id35">
<h1>%% [markdown]<a class="headerlink" href="#id35" title="Link to this heading">#</a></h1>
<section id="id36">
<h2>שאלות רב־ברירה<a class="headerlink" href="#id36" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>עבור מטריצה סימטרית ממשית, נעדיף:<br />
A. <code class="docutils literal notranslate"><span class="pre">eig</span></code><br />
B. <code class="docutils literal notranslate"><span class="pre">eigh</span></code><br />
C. <code class="docutils literal notranslate"><span class="pre">svd</span></code><br />
D. <code class="docutils literal notranslate"><span class="pre">solve</span></code></p></li>
<li><p>פתרון <span class="math notranslate nohighlight">\(A\mathbf{x}=\mathbf{b}\)</span> נעשה עם:<br />
A. <code class="docutils literal notranslate"><span class="pre">linalg.solve</span></code><br />
B. <code class="docutils literal notranslate"><span class="pre">optimize.minimize</span></code><br />
C. <code class="docutils literal notranslate"><span class="pre">fft.rfft</span></code><br />
D. <code class="docutils literal notranslate"><span class="pre">stats.ttest_ind</span></code></p></li>
</ol>
</section>
<section id="id37">
<h2>איור (סקיצה)<a class="headerlink" href="#id37" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>המחשת כיווני וקטורים עצמיים והמתיחות לאורך כיוונים אלו.</p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id38">
<h1>%% [markdown]<a class="headerlink" href="#id38" title="Link to this heading">#</a></h1>
<section id="id39">
<h2>7. סטטיסטיקה בסיסית למדידות<a class="headerlink" href="#id39" title="Link to this heading">#</a></h2>
<p>נדגים שימוש בתפלגות נורמלית, אומדן פרמטרים, והתאמת התפלגות לנתונים:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">stats.norm</span></code> עבור PDF/CDF ודגימה אקראית.</p></li>
<li><p>אומדן <span class="math notranslate nohighlight">\(\mu,\sigma\)</span> מנתונים, והשוואה לרגרסיה/התאמה.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %%</span>
<span class="c1"># Basic stats with normal distribution</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="n">mu_hat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
<span class="n">sigma_hat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># PDF vs histogram</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">mu_hat</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">sigma_hat</span><span class="p">,</span> <span class="n">mu_hat</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">sigma_hat</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">pdf</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">mu_hat</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma_hat</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s2">&quot;Normal($\mu$=</span><span class="si">{</span><span class="n">mu_hat</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, $\sigma$=</span><span class="si">{</span><span class="n">sigma_hat</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Histogram vs Normal PDF&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/baccf7963bf8b350dda69dfaca0043d401abb75116f160ebc475fc1ee77a24d8.png" src="_images/baccf7963bf8b350dda69dfaca0043d401abb75116f160ebc475fc1ee77a24d8.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id40">
<h1>%% [markdown]<a class="headerlink" href="#id40" title="Link to this heading">#</a></h1>
<section id="id41">
<h2>שאלות רב־ברירה<a class="headerlink" href="#id41" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>מה ההבדל בין <code class="docutils literal notranslate"><span class="pre">np.std(...,</span> <span class="pre">ddof=0)</span></code> ו-<code class="docutils literal notranslate"><span class="pre">ddof=1</span></code>?<br />
A. אין הבדל<br />
B. <code class="docutils literal notranslate"><span class="pre">ddof=1</span></code> נותן אומדן חסר־הטיה לסטיית תקן במדגם<br />
C. <code class="docutils literal notranslate"><span class="pre">ddof=0</span></code> גדול יותר תמיד<br />
D. שניהם מחזירים שונות ולא סטיית תקן</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stats.norm.pdf(x,</span> <span class="pre">loc,</span> <span class="pre">scale)</span></code> מחזירה:<br />
A. פונקציית התפלגות מצטברת<br />
B. צפיפות הסתברות נקודתית<br />
C. דגימות אקראיות<br />
D. סטיית תקן</p></li>
</ol>
</section>
<section id="id42">
<h2>איור (סקיצה)<a class="headerlink" href="#id42" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>המחשה של <span class="math notranslate nohighlight">\(68\)</span>–<span class="math notranslate nohighlight">\(95\)</span>–<span class="math notranslate nohighlight">\(99.7\%\)</span> סביב <span class="math notranslate nohighlight">\(\mu \pm \sigma, 2\sigma, 3\sigma\)</span>.</p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id43">
<h1>%% [markdown]<a class="headerlink" href="#id43" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="capstone">
<h1>דוגמאות מסכמות (Capstone)<a class="headerlink" href="#capstone" title="Link to this heading">#</a></h1>
<section id="g-t-l">
<h2>דוגמה 1 — מטוטלת: הערכת <span class="math notranslate nohighlight">\(g\)</span> מהתלות <span class="math notranslate nohighlight">\(T(L)\)</span><a class="headerlink" href="#g-t-l" title="Link to this heading">#</a></h2>
<p><strong>רקע:</strong> עבור זוויות קטנות, תקופת מטוטלת מאורך <span class="math notranslate nohighlight">\(L\)</span> היא בקירוב <span class="math notranslate nohighlight">\( T(L) \approx 2\pi\sqrt{\tfrac{L}{g}} \)</span>.<br />
<strong>מטרה:</strong> בהתבסס על מדידות <span class="math notranslate nohighlight">\((L_i, T_i)\)</span> עם אי־ודאות, נאמוד את <span class="math notranslate nohighlight">\(g\)</span> בעזרת התאמה לא־ליניארית, נציג פסי שגיאה, ונבחן שיוריים.</p>
<p>שלבים:</p>
<ol class="arabic simple">
<li><p>יצירת/טעינת נתוני ניסוי עם רעש.</p></li>
<li><p>התאמה עם <code class="docutils literal notranslate"><span class="pre">curve_fit</span></code> למודל <span class="math notranslate nohighlight">\(T(L)=a\sqrt{L}\)</span> כאשר <span class="math notranslate nohighlight">\(a\approx 2\pi/\sqrt{g}\)</span> או ישירות פרמטר <span class="math notranslate nohighlight">\(g\)</span>.</p></li>
<li><p>פסי שגיאה, שיוריים, וטווחי ביטחון.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %%</span>
<span class="c1"># Pendulum: estimate g from T(L)</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">g_true</span> <span class="o">=</span> <span class="mf">9.81</span>

<span class="c1"># Synthetic measurements</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>          <span class="c1"># meters</span>
<span class="n">T_true</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">L</span><span class="o">/</span><span class="n">g_true</span><span class="p">)</span>
<span class="n">sigma_T</span> <span class="o">=</span> <span class="mf">0.02</span> <span class="o">+</span> <span class="mf">0.01</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>       <span class="c1"># simple nonuniform uncertainty</span>
<span class="n">T_meas</span> <span class="o">=</span> <span class="n">T_true</span> <span class="o">+</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma_T</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">T_model</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">L</span><span class="o">/</span><span class="n">g</span><span class="p">)</span>

<span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">curve_fit</span><span class="p">(</span><span class="n">T_model</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">T_meas</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma_T</span><span class="p">,</span> <span class="n">absolute_sigma</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="p">[</span><span class="mf">9.5</span><span class="p">])</span>
<span class="n">g_hat</span> <span class="o">=</span> <span class="n">popt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">g_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">pcov</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Residuals</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">T_meas</span> <span class="o">-</span> <span class="n">T_model</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">g_hat</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">T_meas</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">sigma_T</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;measurements&quot;</span><span class="p">)</span>
<span class="n">L_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">L</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_f</span><span class="p">,</span> <span class="n">T_model</span><span class="p">(</span><span class="n">L_f</span><span class="p">,</span> <span class="n">g_hat</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s2">&quot;fit: $g=</span><span class="si">{</span><span class="n">g_hat</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">\pm</span><span class="si">{</span><span class="n">g_err</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">\ \mathrm</span><span class="se">{{</span><span class="s2">m/s^2</span><span class="se">}}</span><span class="s2">$&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;L (m)&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;T (s)&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Pendulum period vs length&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="s2">&quot;o-&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;L (m)&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Residual (s)&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Residuals&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/960ad7210ecdbda1cabe61a8d8dfdaaaabb362cd15c1b49eacd40b536102b1a6.png" src="_images/960ad7210ecdbda1cabe61a8d8dfdaaaabb362cd15c1b49eacd40b536102b1a6.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id44">
<h1>%% [markdown]<a class="headerlink" href="#id44" title="Link to this heading">#</a></h1>
<section id="id45">
<h2>שאלות רב־ברירה (דוגמה 1)<a class="headerlink" href="#id45" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>אם <span class="math notranslate nohighlight">\(T=a\sqrt{L}\)</span>, אז <span class="math notranslate nohighlight">\(a\)</span> קשור ל־<span class="math notranslate nohighlight">\(g\)</span> כך ש:<br />
A. <span class="math notranslate nohighlight">\(a = \dfrac{1}{2\pi}\sqrt{g}\)</span><br />
B. <span class="math notranslate nohighlight">\(a = 2\pi\sqrt{g}\)</span><br />
C. <span class="math notranslate nohighlight">\(a = \dfrac{2\pi}{\sqrt{g}}\)</span><br />
D. <span class="math notranslate nohighlight">\(a = g\)</span></p></li>
<li><p>מה תפקיד וקטור <code class="docutils literal notranslate"><span class="pre">sigma</span></code> ב־<code class="docutils literal notranslate"><span class="pre">curve_fit</span></code>?<br />
A. לקבוע צבעים בגרף<br />
B. להגדיר משקלות להתאמה בהתאם לאי־ודאות<br />
C. להאיץ את החישוב<br />
D. להחליף את הפונקציה למודל</p></li>
</ol>
</section>
<section id="id46">
<h2>איור (סקיצה)<a class="headerlink" href="#id46" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>סכמת ניסוי מטוטלת: נקודת תלייה, חוט באורך <span class="math notranslate nohighlight">\(L\)</span>, סטייה קטנה, מדידת תקופה.</p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id47">
<h1>%% [markdown]<a class="headerlink" href="#id47" title="Link to this heading">#</a></h1>
<section id="id48">
<h2>דוגמה 2 — קליע עם גרר ריבועי: זווית שיגור מיטבית<a class="headerlink" href="#id48" title="Link to this heading">#</a></h2>
<p><strong>רקע:</strong> כוח גרר ריבועי: <span class="math notranslate nohighlight">\( \mathbf{F}_d = -\tfrac{1}{2}\rho C_d A v \mathbf{v} \)</span>.<br />
שקול ל־ODE דו־ממדי עבור <span class="math notranslate nohighlight">\((x,y)\)</span> עם מהירויות <span class="math notranslate nohighlight">\((v_x,v_y)\)</span>:<br />
[
\begin{aligned}
\dot{x}&amp;=v_x,\quad \dot{y}=v_y,\
\dot{v}_x&amp;=-\frac{\rho C_d A}{2m},v,v_x,\quad
\dot{v}_y=-g-\frac{\rho C_d A}{2m},v,v_y,
\end{aligned}
]
כאשר <span class="math notranslate nohighlight">\(v=\sqrt{v_x^2+v_y^2}\)</span>.</p>
<p><strong>מטרה:</strong> לפתור את ה־ODE עד פגיעה בקרקע (אירוע אפס ב־<span class="math notranslate nohighlight">\(y\)</span>), ולמצוא ע”י <code class="docutils literal notranslate"><span class="pre">minimize_scalar</span></code> את הזווית <span class="math notranslate nohighlight">\(\theta\)</span> שממקסמת את הטווח האופקי.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %%</span>
<span class="c1"># Projectile with quadratic drag: optimal launch angle</span>
<span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span>
<span class="n">rho</span> <span class="o">=</span> <span class="mf">1.225</span>     <span class="c1"># air density (kg/m^3)</span>
<span class="n">CdA</span> <span class="o">=</span> <span class="mf">0.05</span>      <span class="c1"># drag coefficient * area (m^2)</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">0.145</span>       <span class="c1"># mass (kg) ~ baseball</span>
<span class="n">v0</span> <span class="o">=</span> <span class="mf">40.0</span>       <span class="c1"># m/s</span>

<span class="k">def</span><span class="w"> </span><span class="nf">flight</span><span class="p">(</span><span class="n">theta_deg</span><span class="p">):</span>
    <span class="c1"># ODE system with quadratic drag</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">theta_deg</span><span class="p">)</span>
    <span class="n">vx0</span> <span class="o">=</span> <span class="n">v0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">vy0</span> <span class="o">=</span> <span class="n">v0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">ode</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="c1"># y=[x, y, vx, vy]</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y_</span><span class="p">,</span> <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="n">y</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">rho</span><span class="o">*</span><span class="n">CdA</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">))</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">vx</span>
        <span class="n">ay</span> <span class="o">=</span> <span class="o">-</span><span class="n">g</span> <span class="o">-</span><span class="p">(</span><span class="n">rho</span><span class="o">*</span><span class="n">CdA</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">))</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">vy</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ay</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">hit_ground</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># event when y=0</span>
    <span class="n">hit_ground</span><span class="o">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">hit_ground</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="n">sol</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">solve_ivp</span><span class="p">(</span><span class="n">ode</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">vx0</span><span class="p">,</span> <span class="n">vy0</span><span class="p">],</span>
                              <span class="n">events</span><span class="o">=</span><span class="n">hit_ground</span><span class="p">,</span> <span class="n">max_step</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-9</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">t</span>
    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>

<span class="k">def</span><span class="w"> </span><span class="nf">range_for_angle</span><span class="p">(</span><span class="n">theta_deg</span><span class="p">):</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">flight</span><span class="p">(</span><span class="n">theta_deg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Optimize angle to maximize range (negative for minimize_scalar)</span>
<span class="n">obj</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">th</span><span class="p">:</span> <span class="o">-</span><span class="n">range_for_angle</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">minimize_scalar</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">85</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;bounded&quot;</span><span class="p">)</span>
<span class="n">theta_opt</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span>
<span class="n">R_opt</span> <span class="o">=</span> <span class="n">range_for_angle</span><span class="p">(</span><span class="n">theta_opt</span><span class="p">)</span>

<span class="c1"># Plot a few trajectories around optimum</span>
<span class="n">angles</span> <span class="o">=</span> <span class="p">[</span><span class="n">theta_opt</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">theta_opt</span><span class="p">,</span> <span class="n">theta_opt</span><span class="o">+</span><span class="mi">10</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">for</span> <span class="n">th</span> <span class="ow">in</span> <span class="n">angles</span><span class="p">:</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">flight</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s2">&quot;$\theta=</span><span class="si">{</span><span class="n">th</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">^\circ$&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x (m)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y (m)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;Trajectories with quadratic drag (optimal θ ≈ </span><span class="si">{</span><span class="n">theta_opt</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">°, range ≈ </span><span class="si">{</span><span class="n">R_opt</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> m)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Range vs angle curve</span>
<span class="n">ths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">ranges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">range_for_angle</span><span class="p">(</span><span class="n">th</span><span class="p">)</span> <span class="k">for</span> <span class="n">th</span> <span class="ow">in</span> <span class="n">ths</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ths</span><span class="p">,</span> <span class="n">ranges</span><span class="p">,</span> <span class="s2">&quot;-o&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">theta_opt</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\theta$ (deg)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Range (m)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Range vs launch angle (with drag)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b4a9429e9d5b61ba3cc8b290703bd7f8b3c452fc2eb3d6ab3a9425cce77d0f0b.png" src="_images/b4a9429e9d5b61ba3cc8b290703bd7f8b3c452fc2eb3d6ab3a9425cce77d0f0b.png" />
<img alt="_images/6b4ef5355e42de329b820c113d39b257d1f3be31d675d7605a699878109c87b7.png" src="_images/6b4ef5355e42de329b820c113d39b257d1f3be31d675d7605a699878109c87b7.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id49">
<h1>%% [markdown]<a class="headerlink" href="#id49" title="Link to this heading">#</a></h1>
<section id="id50">
<h2>שאלות רב־ברירה (דוגמה 2)<a class="headerlink" href="#id50" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>לשם עצירת ה־ODE בעת פגיעה בקרקע (<span class="math notranslate nohighlight">\(y=0\)</span>), השתמשנו ב־<br />
A. <code class="docutils literal notranslate"><span class="pre">events</span></code> עם פונקציה שמחזירה <span class="math notranslate nohighlight">\(y\)</span><br />
B. <code class="docutils literal notranslate"><span class="pre">curve_fit</span></code><br />
C. <code class="docutils literal notranslate"><span class="pre">root_scalar</span></code><br />
D. <code class="docutils literal notranslate"><span class="pre">stats.norm</span></code></p></li>
<li><p>ללא גרר, הזווית המיטבית היא:<br />
A. <span class="math notranslate nohighlight">\(90^\circ\)</span><br />
B. <span class="math notranslate nohighlight">\(0^\circ\)</span><br />
C. <span class="math notranslate nohighlight">\(45^\circ\)</span><br />
D. תלוי ב־<span class="math notranslate nohighlight">\(v_0\)</span> בלבד</p></li>
</ol>
</section>
<section id="id51">
<h2>איור (סקיצה)<a class="headerlink" href="#id51" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>שרטטו כוחות על הקליע: משקל כלפי מטה וגרר ביחס ישר למהירות ובכיוון מנוגד.</p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id52">
<h1>%% [markdown]<a class="headerlink" href="#id52" title="Link to this heading">#</a></h1>
<section id="omega-n-zeta">
<h2>דוגמה 3 — מתנד מרוסן: זיהוי <span class="math notranslate nohighlight">\(\omega_n\)</span> ו־<span class="math notranslate nohighlight">\(\zeta\)</span><a class="headerlink" href="#omega-n-zeta" title="Link to this heading">#</a></h2>
<p><strong>רקע:</strong> משוואה: <span class="math notranslate nohighlight">\(x'' + 2\zeta\omega_n x' + \omega_n^2 x = 0\)</span><br />
במקרה מרוסן קל (<span class="math notranslate nohighlight">\(0&lt;\zeta&lt;1\)</span>): <span class="math notranslate nohighlight">\(x(t) = A e^{-\zeta\omega_n t}\cos(\omega_d t+\phi)\)</span>, עם <span class="math notranslate nohighlight">\( \omega_d = \omega_n\sqrt{1-\zeta^2} \)</span> ו־<span class="math notranslate nohighlight">\( Q=\dfrac{1}{2\zeta} \)</span>.</p>
<p><strong>מטרה:</strong></p>
<ol class="arabic simple">
<li><p>ליצור סיגנל מרוסן עם רעש.</p></li>
<li><p>לזהות <span class="math notranslate nohighlight">\(\omega_d\)</span> מבדיקת FFT/פסגה.</p></li>
<li><p>להתאים את המודל המלא עם <code class="docutils literal notranslate"><span class="pre">curve_fit</span></code> כדי לאמוד <span class="math notranslate nohighlight">\(A,\zeta,\omega_n,\phi\)</span>.</p></li>
<li><p>להציג שיוריים ולהעריך <span class="math notranslate nohighlight">\(Q\)</span>.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %%</span>
<span class="c1"># Damped oscillator: identify ωn and ζ</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="n">zeta_true</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">wn_true</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">5.0</span>  <span class="c1"># natural rad/s ~ 5 Hz</span>
<span class="n">A_true</span><span class="p">,</span> <span class="n">phi_true</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.2</span>

<span class="n">fs</span> <span class="o">=</span> <span class="mf">200.0</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">6.0</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>

<span class="c1"># Generate damped signal with noise</span>
<span class="n">wd_true</span> <span class="o">=</span> <span class="n">wn_true</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">zeta_true</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x_clean</span> <span class="o">=</span> <span class="n">A_true</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">zeta_true</span><span class="o">*</span><span class="n">wn_true</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">wd_true</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phi_true</span><span class="p">)</span>
<span class="n">x_noisy</span> <span class="o">=</span> <span class="n">x_clean</span> <span class="o">+</span> <span class="mf">0.05</span><span class="o">*</span><span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

<span class="c1"># FFT to estimate wd (peak)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">x_noisy</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
<span class="n">amp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="o">/</span><span class="n">t</span><span class="o">.</span><span class="n">size</span>
<span class="n">pk</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">(</span><span class="n">amp</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">amp</span><span class="p">)</span><span class="o">*</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">f_peak</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">pk</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">amp</span><span class="p">[</span><span class="n">pk</span><span class="p">])]]</span> <span class="k">if</span> <span class="n">pk</span><span class="o">.</span><span class="n">size</span> <span class="k">else</span> <span class="n">f</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">amp</span><span class="p">)]</span>
<span class="n">wd_est</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f_peak</span>

<span class="c1"># Nonlinear fit: x(t)=A*exp(-ζ*wn*t)*cos(wd*t+φ) with wd = wn*sqrt(1-ζ^2)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">damped_model</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">zeta</span><span class="p">,</span> <span class="n">wn</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
    <span class="n">wd</span> <span class="o">=</span> <span class="n">wn</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mf">1e-12</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">zeta</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">A</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">zeta</span><span class="o">*</span><span class="n">wn</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">wd</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phi</span><span class="p">)</span>

<span class="n">p0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">wd_est</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>  <span class="c1"># rough initial guesses</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">])</span>

<span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">curve_fit</span><span class="p">(</span><span class="n">damped_model</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">x_noisy</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">p0</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="n">maxfev</span><span class="o">=</span><span class="mi">20000</span><span class="p">)</span>
<span class="n">A_hat</span><span class="p">,</span> <span class="n">zeta_hat</span><span class="p">,</span> <span class="n">wn_hat</span><span class="p">,</span> <span class="n">phi_hat</span> <span class="o">=</span> <span class="n">popt</span>
<span class="n">perr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">pcov</span><span class="p">))</span>
<span class="n">Q_hat</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">zeta_hat</span><span class="p">)</span> <span class="k">if</span> <span class="n">zeta_hat</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

<span class="c1"># Plot results</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x_noisy</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;noisy&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">damped_model</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">),</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;fit&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;Damped oscillator fit: $\zeta=</span><span class="si">{</span><span class="n">zeta_hat</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">\pm</span><span class="si">{</span><span class="n">perr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">,\ \omega_n=</span><span class="si">{</span><span class="n">wn_hat</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">\pm</span><span class="si">{</span><span class="n">perr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;t (s)&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;x(t)&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">res</span> <span class="o">=</span> <span class="n">x_noisy</span> <span class="o">-</span> <span class="n">damped_model</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Residuals&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;t (s)&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;residual&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Spectrum view with detected peak</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;spectrum&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">f_peak</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s2">&quot;peak ~ </span><span class="si">{</span><span class="n">f_peak</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;f (Hz)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Amplitude&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Amplitude spectrum and dominant peak&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimated parameters:</span><span class="se">\n</span><span class="s2"> A=</span><span class="si">{</span><span class="n">A_hat</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">±</span><span class="si">{</span><span class="n">perr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, zeta=</span><span class="si">{</span><span class="n">zeta_hat</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">±</span><span class="si">{</span><span class="n">perr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, wn=</span><span class="si">{</span><span class="n">wn_hat</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">±</span><span class="si">{</span><span class="n">perr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, phi=</span><span class="si">{</span><span class="n">phi_hat</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">±</span><span class="si">{</span><span class="n">perr</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimated Q ~ </span><span class="si">{</span><span class="n">Q_hat</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fa4ff7147f9c94514ab88d500cf10686814692c64e0f884a9320c465e262d5c5.png" src="_images/fa4ff7147f9c94514ab88d500cf10686814692c64e0f884a9320c465e262d5c5.png" />
<img alt="_images/a26b7a8b8f1b9fa6fbbcbc4d03d48b692d3b88ffcee6032ba3cad9eb1a413e2c.png" src="_images/a26b7a8b8f1b9fa6fbbcbc4d03d48b692d3b88ffcee6032ba3cad9eb1a413e2c.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Estimated parameters:
 A=1.011±0.012, zeta=0.0502±0.0008, wn=31.445±0.026, phi=0.185±0.012
Estimated Q ~ 9.96
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id53">
<h1>%% [markdown]<a class="headerlink" href="#id53" title="Link to this heading">#</a></h1>
<section id="id54">
<h2>שאלות רב־ברירה (דוגמה 3)<a class="headerlink" href="#id54" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>הקשר בין <span class="math notranslate nohighlight">\(\omega_d\)</span> ו־<span class="math notranslate nohighlight">\(\omega_n\)</span> הוא:<br />
A. <span class="math notranslate nohighlight">\(\omega_d = \omega_n\)</span><br />
B. <span class="math notranslate nohighlight">\(\omega_d = \omega_n\sqrt{1-\zeta^2}\)</span><br />
C. <span class="math notranslate nohighlight">\(\omega_d = \zeta\omega_n\)</span><br />
D. <span class="math notranslate nohighlight">\(\omega_d = \dfrac{\omega_n}{\zeta}\)</span></p></li>
<li><p>גורם האיכות <span class="math notranslate nohighlight">\(Q\)</span> למרוסן קל:<br />
A. <span class="math notranslate nohighlight">\(Q=2\zeta\)</span><br />
B. <span class="math notranslate nohighlight">\(Q=\zeta^2\)</span><br />
C. <span class="math notranslate nohighlight">\(Q=\dfrac{1}{2\zeta}\)</span><br />
D. <span class="math notranslate nohighlight">\(Q=\dfrac{1}{\zeta}\)</span></p></li>
</ol>
</section>
<section id="id55">
<h2>איור (סקיצה)<a class="headerlink" href="#id55" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>סכמת מעטפת דעיכה <span class="math notranslate nohighlight">\(A e^{-\zeta\omega_n t}\)</span> והאוסילציה הפנימית בקצב <span class="math notranslate nohighlight">\(\omega_d\)</span>.</p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id56">
<h1>%% [markdown]<a class="headerlink" href="#id56" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id57">
<h1>נספח קצר — טיפים לשמירת תרשימים<a class="headerlink" href="#id57" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>לשימוש במאמרים/דוחות: עדיף <strong>SVG/PDF</strong> (וקטורי) עבור תרשימי קו/טקסט.</p></li>
<li><p>לגדלים מדויקים: <code class="docutils literal notranslate"><span class="pre">fig.set_size_inches(width_inches,</span> <span class="pre">height_inches)</span></code> או <code class="docutils literal notranslate"><span class="pre">fig,</span> <span class="pre">ax</span> <span class="pre">=</span> <span class="pre">plt.subplots(figsize=(w,h))</span></code>.</p></li>
<li><p>לשילוב ב-Word/Google Docs: PNG ב־300–600 DPI.</p></li>
<li><p>הוסיפו יחידות ותיאור ברור לצירים, מקרא, וכותרת עניינית.</p></li>
</ul>
<blockquote>
<div><p>כאן המקום לצרף רשימת תשובות לשאלות, אם תרצו, או להשאירן ללמידה עצמית.</p>
</div></blockquote>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "TauInnov/computers-for-physics",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="8_week.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">שבוע 8 - Numpy מתקדם</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">שבוע 9 - Matplotlib &amp; SciPy</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matplotlib">חלק א’ — Matplotlib</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">1. אנטומיית תרשימים</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">שימוש במודל האובייקטי של matplotlib</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sin-x">דוגמה: גרף פשוט של הפונקציה <span class="math notranslate nohighlight">\(\sin(x)\)</span>:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dpi">גודל תרשים, DPI, פריסה ושמירה</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#axs">שימוש ב־<code class="docutils literal notranslate"><span class="pre">axs</span></code> לציורים מרובים</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">סוגי גרפים ב־Matplotlib</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#line-plot">Line plot</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#scatter-plot">Scatter plot</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#histogram">Histogram</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#imshow">Imshow</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#errorbar">Errorbar</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">התאמות מתקדמות</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">דוגמה מסכמת</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">1) יצירת נתונים</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#colormap">2) הכנה ל־Colormap</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#x">3) ציור הלוח העליון + סולם לוגריתמי בציר <span class="math notranslate nohighlight">\(x\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#annotation">4) הוספת Annotation לנקודת חצי־זמן</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-c">5) ציר תאום ליחידות חלופיות (K ↔ °C)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#colorbar">6) הוספת Colorbar</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#y">7) לוח תחתון עם <span class="math notranslate nohighlight">\(y\)</span> לוגריתמי</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">8) הרכבה, הצגה ושמירה</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">9) קריאה להרצה</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scipy">חלק ב’ — SciPy</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numpy">תזכורת קצרה ל-NumPy + קבועים פיזיקליים</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">1) חישוב אנרגיית פוטון מאורך גל</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#k-b-t">2) סקאלת אנרגיה תרמית <span class="math notranslate nohighlight">\(k_B T\)</span> ומתיחות תרמית במתח</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#broadcasting">3) דוגמת Broadcasting: אנרגיה פוטנציאלית כבידתית</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">4) חוק וין: אורך גל שיא של גוף שחור</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-approx-dfrac-1-sqrt-varepsilon-0-mu-0">5) בדיקת־שפיות: <span class="math notranslate nohighlight">\(c \approx \dfrac{1}{\sqrt{\varepsilon_0 \mu_0}}\)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#markdown">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">שאלות רב־ברירה</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">איור (סקיצה)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#odes">2. אינטגרציה וגזירה נומרית + ODEs</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">שאלות רב־ברירה</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">איור (סקיצה)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">3. אופטימיזציה, שורשים, והתאמת עקומות</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">שאלות רב־ברירה</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">איור (סקיצה)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">4. אינטרפולציה והחלקה</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">שאלות רב־ברירה</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">איור (סקיצה)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fft">5. עיבוד אותות ו-FFT</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id29">5. עיבוד אותות ו-FFT</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id30">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id31">שאלות רב־ברירה</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id32">איור (סקיצה)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id33">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id34">6. אלגברה ליניארית מדעית</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id35">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id36">שאלות רב־ברירה</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id37">איור (סקיצה)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id38">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id39">7. סטטיסטיקה בסיסית למדידות</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id40">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id41">שאלות רב־ברירה</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id42">איור (סקיצה)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id43">%% [markdown]</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#capstone">דוגמאות מסכמות (Capstone)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#g-t-l">דוגמה 1 — מטוטלת: הערכת <span class="math notranslate nohighlight">\(g\)</span> מהתלות <span class="math notranslate nohighlight">\(T(L)\)</span></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id44">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id45">שאלות רב־ברירה (דוגמה 1)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id46">איור (סקיצה)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id47">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id48">דוגמה 2 — קליע עם גרר ריבועי: זווית שיגור מיטבית</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id49">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id50">שאלות רב־ברירה (דוגמה 2)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id51">איור (סקיצה)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id52">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#omega-n-zeta">דוגמה 3 — מתנד מרוסן: זיהוי <span class="math notranslate nohighlight">\(\omega_n\)</span> ו־<span class="math notranslate nohighlight">\(\zeta\)</span></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id53">%% [markdown]</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id54">שאלות רב־ברירה (דוגמה 3)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id55">איור (סקיצה)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id56">%% [markdown]</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id57">נספח קצר — טיפים לשמירת תרשימים</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>